[{"title":"Physical aware synthesisæ˜¯ä»€ä¹ˆ","url":"/2022/11/04/IC/Basic/Physical Synthesisæ˜¯ä»€ä¹ˆ/","content":"\n> æœ¬æ–‡è½¬è½½è‡ª[è®ºç»¼åˆï¼šä¸ºä»€ä¹ˆåšphysical aware synthesis](https://mp.weixin.qq.com/s/wX1rPgGrn4IwHfXc-f_e9Q)\n>\n> å¦‚æœ‰ä»»ä½•ç‰ˆæƒé—®é¢˜è¯·è”ç³»åšä¸»ã€‚\n\n## å‰è¨€\n\nå·¥è‰ºçš„æ›´æ–°ç»™æ•´ä¸ªåŠå¯¼ä½“è¡Œä¸šå¸¦æ¥äº†å·¨å¤§çš„æŒ‘æˆ˜ï¼Œä»ç”Ÿäº§è®¾å¤‡ã€EDAå†åˆ°èŠ¯ç‰‡è®¾è®¡å®ç°éƒ½éœ€è¦ç´§è·Ÿæ›´æ–°çš„å·¥è‰ºç‚¹äº®æ–°æŠ€èƒ½ã€‚ä¸‹å›¾ç›´è§‚åœ°å‘ˆç°äº†ä»65nmåˆ°16/14nmç”±å·¥è‰ºè¿›æ­¥å¼•å…¥çš„éœ€è¦é¢å¤–è€ƒè™‘çš„å› ç´ ã€‚\n\n![phsy](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202211032356068.jpg)\n\nåœ¨èŠ¯ç‰‡è®¾è®¡å®ç°æµç¨‹ä¸­ï¼ŒP&Rå·¥ç¨‹å¸ˆå¯¹å·¥è‰ºå¸¦æ¥çš„æŒ‘æˆ˜æ„Ÿå—ä¼šæ›´ç›´æ¥ï¼Œç»¼åˆã€STAã€DFT ä¹Ÿéƒ½æœ‰æ–°çš„æ–¹æ³•å­¦çš„æ›´æ–°ï¼Œä½†å¤§éƒ½è¢« EDA å·¥å…·ä¸¥å®åœ°åŒ…äº†èµ·æ¥ï¼Œå°±æ‹¿ç»¼åˆæ¥è¯´ï¼Œç›¸å¯¹äºä¼ ç»Ÿç»¼åˆè€Œè¨€æœ€å¤§çš„æ›´æ–°è«è¿‡äºphysical aware synthesisã€‚\n\n## ä¸ºä»€ä¹ˆï¼Ÿ\n\næœ€æ ¹æœ¬çš„ç›®çš„å°±æ˜¯å‡å°‘å‰åç«¯çš„è¿­ä»£æ¬¡æ•°ï¼Œå‰åç«¯è¿­ä»£æ¬¡æ•°å¤šçš„æ ¹æœ¬åŸå› æ˜¯å‰åç«¯çš„å…³è”åº¦(correlation)å·®ï¼Œè€Œcorrelationéœ€è¦ä»timing å’Œ congestion ä¸¤ä¸ªæ–¹é¢æ¥çœ‹ï¼š\n\n### Timing\n\nç»¼åˆä¼˜åŒ–çš„å¯¹è±¡æ˜¯ timing pathï¼Œè€Œ Timing path delay = net delay + cell delayï¼Œ90nmä¹‹å‰ timing path delay ç”±cell delay ä¸»å¯¼ï¼Œè€Œè¿›å…¥65nmï¼Œnet delayæ‰€å æ¯”ä¾‹æ—¥æ¸å¢åŠ ï¼Œè¿›å…¥40nmä¹‹åå‡ ä¹è·Ÿcell delayå¹³åˆ†ç§‹è‰²ã€‚æ‰€ä»¥ä»40nmå¼€å§‹physical synthesis è¢«ç¡…å†œç†ŸçŸ¥ï¼Œå› ä¸ºphysical aware synthesisåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°æ›´ç²¾ç¡®çš„net delayã€‚\n\n![preview](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210092022883.jpeg)\n\n**é‚£ä¹ˆä¸ºä»€ä¹ˆlogical synthesisä¸èƒ½ç²¾ç¡®è®¡ç®—net delayå‘¢ï¼Ÿ**è¿™å°±è¦å›çœ‹ä¸€ä¸‹ä¼ ç»Ÿç»¼åˆæ˜¯å¦‚ä½•ä¼°ç®— net delay çš„ã€‚ä¼ ç»Ÿç»¼åˆä¿—ç§°logic synthesisï¼Œå®ƒæ ¹æ®WLM æ¥ä¼°ç®—net delayã€‚WLM (wire load model) ç”±foundry æä¾›ï¼ŒWLMé€šå¸¸åŒ…æ‹¬é¢ç§¯ç³»æ•°ã€ç”µå®¹ç³»æ•°å’Œå•ä½é•¿åº¦çš„ç”µé˜»ç³»æ•°ï¼Œä»¥åŠä¸€ä¸ªç”¨äºä¼°è®¡neté•¿åº¦çš„è¡¨æ ¼ï¼Œè¡¨çš„indexæ˜¯ fanoutï¼Œç›´ç™½åœ°è¯´å°±æ˜¯å°†netçš„é•¿åº¦æ‹Ÿåˆæˆfanout çš„å‡½æ•°ã€‚\n\næŒ‰ç…§WLMæ¥è®¡ç®—ï¼Œä¸‹å›¾ä¸­çš„blueå™¨ä»¶åˆ°redå™¨ä»¶çš„æ‰€æœ‰neté•¿åº¦éƒ½ä¸€æ ·ï¼Œnet delayä¹Ÿä¸€æ ·ï¼Œè€Œå®é™…ä¸Š net è¡Œèµ°çš„å§¿åŠ¿äº”èŠ±å…«é—¨ï¼Œæ ¹æœ¬å°±ä¸å¯èƒ½ä¸€æ ·ï¼Œç¼ºç‚¹æ˜¾è€Œæ˜“è§ã€‚å¦ä¸€ä¸ªç¼ºé™·æ˜¯WLM çš„å•ä½ç”µå®¹ç”µé˜»æ˜¯ä¸€ä¸ªå¸¸å€¼ï¼Œæ— æ³•æ¨¡æ‹Ÿä¸åŒlayer RC å€¼çš„å·®å¼‚ï¼Œè€Œå·¥è‰ºè¿›å…¥16nm ä¹‹åï¼Œå¿…é¡»è¦è€ƒè™‘ layer aware çš„ net delayã€‚\n\n![preview](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210092025068.jpeg)\n\nåœ¨40nmç”šè‡³28nmï¼Œä¾ç„¶æœ‰äººåœ¨ç”¨ä¼ ç»Ÿçš„æ–¹å¼æ¥åšç»¼åˆï¼Œåšæ³•ç®€å•ç²—æš´åŠ æ—¶é’Ÿå‘¨æœŸ30%ç”šè‡³æ›´å¤šçš„è¿‡çº¦ï¼Œè¿™æ ·åšæ˜¯å¯ä»¥cover net delayï¼Œä½†æ˜¯å®åœ¨æ˜¯è¿‡çŠ¹ä¸åŠã€‚æ®ç»Ÿè®¡åœ¨ä¸€é¢—èŠ¯ç‰‡é‡Œ80%ä»¥ä¸Šçš„çº¿éƒ½æ˜¯çŸ­çº¿ï¼Œä¸ºäº†coveré‚£ä¸åˆ°20%çš„çº¿ï¼Œä»˜å‡ºçš„ä»£ä»·å°±æ˜¯æ›´å¤§çš„é¢ç§¯åŠæ›´å¤šçš„åŠŸè€—ã€‚\n\n**é‚£Physical synthesisæ˜¯å¦‚ä½•æ›´ç²¾ç¡®çš„è®¡ç®—net delayï¼Ÿ**è¦ç²¾ç¡®è®¡ç®—net delayå¿…é¡»è¦çŸ¥é“netçš„è¡Œèµ°å§¿åŠ¿ï¼Œè€Œè¦çŸ¥é“net çš„è¡Œèµ°å§¿åŠ¿å¿…éœ€è¦çŸ¥é“ï¼šå®ƒæ¥è‡ªå“ªé‡Œï¼Ÿè¦å»å‘ä½•æ–¹ï¼Ÿè¿™å°±éœ€è¦çŸ¥é“cell çš„ä½ç½®ï¼Œcell ä½ç½®ç¡®å®šäº†ä¹‹åï¼Œç»¼åˆå·¥å…·ä¼šåšglobal ç»•çº¿ï¼Œæ ¹æ®global ç»•çº¿çš„ç»“æœæ¥ä¼°ç®—net delayã€‚cell ä½ç½®ç”±placement ç¡®å®šï¼Œæ‰€ä»¥å¦‚ä»Šç»¼åˆå·¥å…·éƒ½é›†æˆäº† placement å¼•æ“ï¼Œè¿™ä¹Ÿæ˜¯åš physical synthesis çš„å…³é”®æ‰€åœ¨ã€‚ç›®å‰å¤§æ¦‚æœ‰ä¸¤ç§åšplaceçš„æ–¹å¼ï¼š\n\n- åšå®Œä¼˜åŒ–è·Ÿmappingä¹‹åï¼Œå†åšplaceï¼Œæ“ä½œå¯¹è±¡æ˜¯std cellï¼›\n- åœ¨elaborate ä¹‹åä¼˜åŒ–ä¹‹åˆå°±åšplace, å³æ‰€è°“çš„ early physical, æ—©æœŸé˜¶æ®µé’ˆå¯¹module åšpalceï¼Œmappingä¹‹åå†ä»¥std cellä¸ºå¯¹è±¡åšplaceï¼›\n\nä¸‹å›¾æ˜¯è°·æ­Œä¸Šéšä¾¿æ‰¾çš„ä¸€å¼ å›¾ï¼Œåªä¸ºæ˜¾ç¤ºä»€ä¹ˆæ˜¯module place,  ä»Layout ä¸Šçœ‹æ¯ä¸€ä¸ªé¢œè‰²å¯¹åº”ä¸€ä¸ª moduleã€‚ç»¼åˆå·¥å…·åŸºæœ¬éƒ½æŒ‰ translation + optimization + mapping ä¸‰å¤§æ­¥æ¥èµ°ï¼Œ æ‰€æœ‰ç»“æ„çš„é€‰æ‹©è·Ÿå¤§éƒ¨åˆ†ä¼˜åŒ–çš„åŠ¨ä½œéƒ½åœ¨ optimization è¿™ä¸€æ­¥å®Œæˆï¼Œå¦‚æœå¯ä»¥åœ¨ optimization æ—¶å°±çŸ¥é“ module çš„ä½ç½®ä¿¡æ¯ï¼Œä¼˜åŒ–ä¼šæ›´æœ‰çš„æ”¾çŸ¢ä¼šæ›´èƒ½ã€ç²¾å‡†æ‰“å‡»ã€ï¼Œæ‰€ä»¥ Early physical ååˆ†å¿…è¦ã€‚ç°åœ¨çœ‹åˆ°çš„è¶‹åŠ¿æ˜¯æŠŠæ›´å¤šçš„ç‰©ç†ä¿¡æ¯æ‹¿åˆ°å‰ç«¯æ¥ï¼Œè¶Šæ—©è€ƒè™‘ç‰©ç†ä¿¡æ¯å¾—åˆ°çš„ç»“æœä¼šè¶Šå¥½ã€‚\n\n![preview](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210092031003.jpeg)\n\nç»“è®ºï¼šphysial synthesisæ ¹æ®çœŸå®çš„ç‰©ç†ä¿¡æ¯ï¼Œç”¨è·ŸP&Rä¸€è‡´çš„ place å¼•æ“è·Ÿ global route å¼•æ“ï¼Œå¯ä»¥ç²¾ç¡®ä¼°ç®— net delayï¼Œå¹¶ä¸”æ˜¯layer awareçš„ã€‚é€šå¸¸physical synthesis åªéœ€è¿‡çº¦æ—¶é’Ÿå‘¨æœŸ5%\\~10%å³å¯ï¼Œç”¨äºcover legalizationè·Ÿdetail route çš„å½±å“ã€‚\n\n### Congestion\n\nåŒæ ·ç”±äºå·¥è‰ºè¿›æ­¥ï¼Œé›†æˆåº¦æé«˜ï¼Œå•ä½é¢ç§¯ä¸Šè¦èµ°çš„çº¿éª¤å¢ï¼Œæ‰€ä»¥ congestion æˆäº†ä¸€ä¸ªä»RTL è®¾è®¡å°±è¦å¼€å§‹å…³æ³¨çš„é—®é¢˜ï¼Œå¦åˆ™åˆ°äº†ç»•çº¿çš„æ—¶å€™ç»•ä¸é€šï¼Œå‰é¢æ‰€åšçš„ä¸€åˆ‡éƒ½æˆäº†æ— ç”¨åŠŸã€‚å¾ˆæ˜¾ç„¶ï¼Œlogical ç»¼åˆæ˜¯æ— æ³•è€ƒè™‘ congestion çš„ï¼Œè¦åœ¨ç»¼åˆé˜¶æ®µåšcongestionä¼˜åŒ–å¿…é¡»è¦ physical synthesis.\n\n![preview](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210092033144.jpeg)\n\nå…¶å®ä¸è®ºPPAè¿˜æ˜¯congestionä¸»å¯¼å†³å®šæƒéƒ½åœ¨è¿›å®ç°ä¹‹å‰ï¼Œ**æ¶æ„ç®—æ³•è®¾è®¡**ï¼Œæ‰æ˜¯çœŸæ­£å†³å®šä¸€åˆ‡çš„ã€æƒè´µã€ï¼Œæ‰€ä»¥æ‰è¯´å®ç°æ˜¯ä¸ªæ²¡æœ‰çµé­‚çš„å·¥ç§ï¼Œåªè¦æŒ‰ç€ è®¾è®¡/EDA/foundry å®šçš„è§„åˆ™å¾€ä¸‹èµ°å°±å¯ä»¥ï¼Œåˆ‡å¿Œçš„å°±æ˜¯ã€å‘æŒ¥ã€ã€‚\n\nå¯¹äºcongestionï¼Œç»¼åˆå·¥å…·èƒ½åšçš„åŸºæœ¬åªæœ‰ä¸¤ä»¶äº‹ï¼šé€‰ç»“æ„è·Ÿæ¨cellã€‚è‡³äºé€‰ç»“æ„ï¼Œä¸€ä¸ªä¾‹å­å°±æ˜¯æŠŠä¸€ä¸ªå¤§MUX æ‹†æˆå¤šçº§MUXç”¨äºè§£congestionã€‚æ¨cellè¿™ä¸€ç‚¹å®Œå…¨ä¾èµ–äºEDA å·¥å…·ï¼Œå¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•åšï¼Œé‚£å°±æ‰¾AEè¦å˜é‡æˆ– option è®©å·¥å…·åœ¨ç»¼åˆåšplaceæ—¶å°† congestion ä¸¥é‡åŒºåŸŸçš„cellæ¨æ•£ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç‚¹å¯ä»¥äººä¸ºå¹²é¢„ï¼Œç¦ç”¨æˆ–è®©å·¥å…·å°‘ç”¨size å°çš„å¤æ‚cellã€‚\n\nè¦ç‰¹åˆ«è¯´æ˜ä¸€ç‚¹ï¼Œåœ¨16nmä¹‹åï¼Œlayerçš„å½±å“ç‰¹åˆ«å¤§ï¼Œæ‰€ä»¥ç»¼åˆç”¨çš„DEFä¸€å®šè¦æœ‰special net éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯ä½ çš„power planï¼Œè®©å·¥å…·åœ¨ç»¼åˆæ—¶æ¸…æ¥šåœ°çŸ¥é“å“ªäº›layerçš„ç»•çº¿èµ„æºå·²ç»è¢«å ç”¨ã€‚\n\n## Reference\n\n[What is Physical Synthesis_IBM](https://cse.unl.edu/~seth/990/Pubs/What%20is%20physical%20synthesis.pdf)\n\n[What is Physical Synthesis?_synopsys](https://www.synopsys.com/glossary/what-is-physical-synthesis.html)\n","tags":["Basics"],"categories":["IC","Basics"]},{"title":"RTL Coding Style","url":"/2022/10/10/IC/Basic/RTL Coding Style/","content":"\n# RTL Coding Style\n\n## æ ‡å‡†çš„æ–‡ä»¶å¤´\n\nåœ¨æ¯ä¸€ä¸ªç‰ˆå—çš„å¼€å¤´ä¸€å®šè¦ä½¿ç”¨ç»Ÿä¸€çš„æ–‡ä»¶å¤´ï¼Œå…¶ä¸­åŒ…æ‹¬ä½œè€…åï¼Œæ¨¡å—åï¼Œåˆ›å»ºæ—¥æœŸï¼Œæ¦‚è¦ï¼Œæ›´æ”¹è®°å½•ï¼Œç‰ˆæƒç­‰å¿…è¦ä¿¡æ¯ã€‚\n\nå»ºè®®ä½¿ç”¨ä»¥ä¸‹çš„æ–‡ä»¶å¤´\n\n```verilog\n// **************************************************************\n// COPYRIGHT(c) XDU ImgLab\n// All rights reserved.\n//\n// Module name  :  Module_name of this file just as â€œtx_fifoâ€\n// Full name    :  Full English name of this abbreviation\n//\n// Author       :  Athor/ID \n// Email        :  Authorâ€™s email\n// Abstract     :  Describe the function of the module briefly \n//Â CharacterÂ Set:Â  GB-2312\n//\n// Modification history\n// ------------------------------------------------------------------------------------------------------\n//Â DateÂ Â Â Â Â Â Â ByÂ Â Â Â Â Â Â Â VersionÂ Â Â Â Â Â Â ChangeÂ DescriptionÂ Â Â Â Â Â Â Â Â Â Â Â \n//Â -----------------------------------------------------------------Â \n//Â 22/10/10Â Â Â DavidÂ Â Â Â  v0.1Â Â Â Â Â Â Â Â Â Â firstÂ tryÂ \n// *********************************************************************\n\n```\n\n## æ ‡å‡†çš„moduleæ ¼å¼\n\nå¯¹äºæ¨¡å—çš„ä¹¦å†™é‡‡ç”¨ç»Ÿä¸€çš„æ ¼å¼ä¾¿äºé¡¹ç›®å†…éƒ¨æˆå‘˜çš„ç†è§£å’Œç»´æŠ¤ï¼Œå…¶å†…å®¹è§£é‡Šå¦‚ä¸‹ï¼š\n\n- ç«¯å£å®šä¹‰æŒ‰ç…§è¾“å…¥ï¼Œè¾“å‡ºï¼ŒåŒå‘çš„é¡ºåºï¼›\n- æ¨¡å—åã€æ¨¡å—ä¾‹åŒ–åç»Ÿä¸€ï¼Œä¾‹åŒ–åå‰åŠ å°å†™u_ä»¥åŒºåˆ† ï¼ˆ å¤šæ¬¡ä¾‹åŒ–å¦åŠ æ ‡è¯† ï¼‰ï¼Œä¸‰è€…å…³ç³»ï¼š\n  - æ–‡ä»¶å ï¼šxxx .v  (å°å†™)\n  - æ¨¡å—å ï¼šxxx      (å°å†™)\n  - ä¾‹åŒ–å ï¼šu_xxx\n\n## ä¸€è‡´çš„æ’ç‰ˆ\n\n### ä¸€è‡´çš„ç¼©æ’\n\n- ç»Ÿä¸€çš„ç¼©æ’å–4ä¸ªç©ºæ ¼å®½åº¦ï¼ˆæ³¨æ„å°½é‡åˆ«ä½¿ç”¨TABé”®ç¼©è¿›ï¼Œä¸åŒçš„IDEå¯¹TABç¼©è¿›çš„è§£é‡Šå¯èƒ½ä¸åŒï¼‰\n\n- è¾“å…¥è¾“å‡ºä¿¡å·çš„å®½åº¦å®šä¹‰ä¸å…³é”®å­—ä¹‹é—´ï¼Œä¿¡å·åä¸å®½åº¦ä¹‹é—´è¦ç”¨ç©ºæ ¼åˆ†å¼€ï¼›æ‰€æœ‰å®½åº¦å®šä¹‰å¯¹æ‰€æœ‰ä¿¡å·åå¯¹é½ï¼Œä»£ç é£æ ¼ç»Ÿä¸€å¦‚ä¸‹ï¼š\n\n  ```verilog\n  input   [3:0]    input_a   ;    // *****\n  input            input_b   ;    // *****\n         â€¦\n  output  [127:0]  output_a ;\n  output  [15:0]   output_b ;\n  output           output_c ;\n  ```\n\n### ä¸€è‡´çš„begin  endä¹¦å†™æ–¹å¼\n\nalwaysä¸­ï¼Œä¸€å®šè¦ç”¨begin endåŒºåˆ†ï¼Œæ ¼å¼å’Œä»£ç é£æ ¼ç»Ÿä¸€å¦‚ä¸‹ï¼š\n\n```verilog\nalways @ (postedge clk or negedge rst_n) begin\n    if (rst_n == 1'b0)\n        syn_rst<= 1'b0;\n    else begin\n        if (a == b)\n            syn_rst<= 1'b1;\n        else\n            syn_rst<= 1'b0;\n    end\nend\n```\n\nif elseä¸­ä»…æœ‰ä¸€ä¸ªè¯­å¥è¡Œæ—¶ï¼Œä¸è¦ä½¿ç”¨begin endï¼›å¦‚æœæœ‰å¤šä¸ªè¯­å¥è¡Œæ—¶ï¼Œæ³¨æ„ç¼©è¿›å››ä¸ªç©ºæ ¼ã€‚\n\n## ä¸€è‡´çš„ä¿¡å·å‘½åé£æ ¼\n\n|    å…¨ç§°     |   ç¼©å†™   |      ä¸­æ–‡å«ä¹‰      |\n| :---------: | :------: | :----------------: |\n| acknowledge |   ack    |        åº”ç­”        |\n|   address   | addr(ad) |        åœ°å€        |\n|   arbiter   |   arb    |        ä»²è£        |\n|    check    |   chk    |  æ ¡éªŒï¼Œå¦‚CRCæ ¡éªŒ   |\n|    clock    |   clk    |        æ—¶é’Ÿ        |\n|   config    |   cfg    |      é…ç½®ä¿¡æ¯      |\n|   control   |   ctrl   |        æ§åˆ¶        |\n|    count    |   cnt    |        è®¡æ•°        |\n|  data  in   | din(di)  |      æ•°æ®è¾“å…¥      |\n|  data  out  | dout(do) |      æ•°æ®è¾“å‡º      |\n|   decode    |    de    |        è¯‘ç         |\n|  decrease   |   dec    |        å‡ä¸€        |\n|    delay    |   dly    |        å»¶è¿Ÿ        |\n|   disable   |   dis    |       ä¸ä½¿èƒ½       |\n|    error    |   err    |    é”™è¯¯ï¼ˆæŒ‡ç¤ºï¼‰    |\n|   enable    |    en    |        ä½¿èƒ½        |\n|    frame    |   frm    |         å¸§         |\n|  generate   |   gen    |  ç”Ÿæˆï¼Œå¦‚CRCç”Ÿæˆ   |\n|    grant    |   gnt    |      ç”³è¯·é€šè¿‡      |\n|  increase   |   inc    |        åŠ ä¸€        |\n|    input    |  in(i)   |      è¾“å…¥ä¿¡å·      |\n|   length    |   len    |    ï¼ˆå¸§ã€åŒ…ï¼‰é•¿    |\n|   output    |  out(o)  |      è¾“å‡ºä¿¡å·      |\n|  priority   |   pri    |       ä¼˜å…ˆçº§       |\n|   pointer   |   ptr    |        æŒ‡é’ˆ        |\n| rd  enable  |   ren    |       è¯»ä½¿èƒ½       |\n|    read     |    rd    |     è¯»ï¼ˆæ“ä½œï¼‰     |\n|    ready    |   rdy    |  åº”ç­”ä¿¡å·æˆ–å‡†å¤‡å¥½  |\n|   receive   |    rx    |   ï¼ˆå¸§æ•°æ®ï¼‰æ¥æ”¶   |\n|   request   |   req    | ï¼ˆæœåŠ¡ã€ä»²è£ï¼‰è¯·æ±‚ |\n|    reset    |   rst    |      å¤ä½ä¿¡å·      |\n|    souce    |   scr    |     æºï¼ˆç«¯å£ï¼‰     |\n| ststistics  |   stat   |        ç»Ÿè®¡        |\n|    timer    |   tmr    |       å®šæ—¶å™¨       |\n|  temporary  |   tmp    |        ä¸´æ—¶        |\n|  transmit   |    tx    | å‘é€ï¼ˆå¸§æ•°æ®ï¼‰ç›¸å…³ |\n|    valid    |  vld(v)  |   æœ‰æ•ˆã€æ ¡éªŒæ­£ç¡®   |\n|  wr enable  |   wen    |       å†™ä½¿èƒ½       |\n|    write    |    wr    |       å†™æ“ä½œ       |\n\n1. ç«¯å£ã€ä¿¡å·ã€å˜é‡åçš„æ‰€æœ‰å­—æ¯å°å†™ï¼›å‡½æ•°åã€å®å®šä¹‰ã€å‚æ•°å®šä¹‰ç”¨å¤§å†™ï¼›\n2. ä½¿ç”¨ç®€ç§°ã€ç¼©ç•¥è¯ï¼ˆåŠ ä¸Šåˆ—è¡¨ï¼‰ï¼›\n3. åŸºäºå«ä¹‰å‘½åï¼ˆé¿å…ä»¥æ•°å­—å‘½åçš„ç®€å•åšæ³•ï¼‰ï¼Œå«ä¹‰å¯åˆ†æ®µï¼ˆæœ€å¤šåˆ†ä¸‰æ®µï¼‰ï¼Œæ¯ä¸€å°æ®µä¹‹é—´åŠ ä¸‹åˆ’çº¿â€_â€ï¼Œå¦‚tx_data_valï¼›å‘½åé•¿åº¦ä¸€èˆ¬é™åˆ¶åœ¨20ä¸ªå­—ç¬¦ä»¥å†…ï¼›\n4. ä½ç”µå¹³æœ‰æ•ˆä¿¡å·ï¼ŒåŠ åç¼€â€_nâ€ï¼Œå¦‚ rst_nï¼›\n5. æ— æ¡ä»¶å¯„å­˜çš„å¯„å­˜ä¿¡å·åœ¨åŸä¿¡å·ä¸ŠåŠ d1ã€d2â€¦ å¦‚åŸä¿¡å· data_inï¼Œå¯„å­˜ä¸€æ‹data_in_d1ï¼Œå¯„å­˜ä¸¤æ‹data_in_d2ï¼›\n6. **ä¸èƒ½ç”¨ â€regâ€ä½œä¸ºæœ€åçš„åç¼€å**ï¼Œå› ä¸ºç»¼åˆå·¥å…·ä¼šç»™å¯„å­˜å™¨è‡ªåŠ¨åŠ ä¸Šregåç¼€, å¦‚æœå‘½åé‡Œå°±ç”¨regä½œä¸ºåç¼€ååˆ™æ‰°ä¹±äº†ç½‘è¡¨çš„å¯è¯»æ€§ã€‚\n\n## ç»Ÿä¸€çš„è¡¨è¾¾å¼ä¹¦å†™\n\n### æ‹¬å·çš„ä½¿ç”¨\n\nå¦‚æœä¸€ä¸ªè¡¨è¾¾å¼çš„åˆ†ç»„æƒ…å†µä¸æ˜¯å¾ˆæ˜æ˜¾æ—¶ï¼ŒåŠ ä¸Šæ‹¬å·æœ‰åŠ©äºç†è§£ã€‚\n\nä¾‹å¦‚ä¸‹é¢çš„ä»£ç åŠ ä¸Šæ‹¬å·å°±æ¸…æ™°å¾ˆå¤šã€‚\n\n`if (&a==1â€™b1&&!flag==1â€™b1||b==1â€™b1)`\n\næ”¹ä¸ºï¼š\n\n`if ((&a==1â€™b1)&&(!flag==1â€™b1)||(b==1â€™b1))`\n\n### é€‚å½“çš„ä½¿ç”¨ç©ºæ ¼\n\nä¸€èˆ¬è¡¨è¾¾å¼åœ¨è¿ç®—ç¬¦çš„ä¸¤ä¾§è¦å„ç•™å‡ºä¸€ä¸ªç©ºæ ¼ï¼Œä½†å®šä¹‰æ¯”è¾ƒé•¿çš„è¡¨è¾¾å¼ï¼Œå»æ‰ä¼˜å…ˆçº§é«˜çš„è¿ç®—ç¬¦å‰çš„ç©ºæ ¼ï¼Œä½¿å…¶ä¸è¿ç®—å¯¹è±¡ç´§è¿åœ¨ä¸€èµ·ï¼Œå¯ä»¥æ›´æ¸…æ™°çš„æ˜¾ç¤ºè¡¨è¾¾å¼ç»“æ„ã€‚\n\nè¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­\n\n`if ((&a==1â€™b1)&&(!flag==1â€™b1)||(b==1â€™b1))`\n\næ”¹ä¸º\n\n`if ( (&a==1â€™b1) && (!flag==1â€™b1) || (b==1â€™b1) )`\n\n**â€<=â€, â€=â€,è¿ç®—ç¬¦å‰åéƒ½è¦åŠ ç©ºæ ¼ã€‚**\n\n### èµ‹å€¼è¦æŒ‡æ˜æ¯”ç‰¹å®½åº¦\n\n**èµ‹å€¼æˆ–è€…æ¡ä»¶åˆ¤æ–­æ—¶è¦æ³¨æ˜æ¯”ç‰¹å®½åº¦ï¼Œæ³¨æ„è¡¨è¾¾å¼çš„ä½å®½åŒ¹é…ã€‚**å¦‚ï¼š\n\nreg [4:0] signal_a;\n\né”™è¯¯æƒ…å†µï¼š  \n\n```verilog\nsignal_a <= 5;\n\nif(signal_a == 5)\n\nsignal_a <= signal_b[3:0]+4;\n```\n\næ­£ç¡®æƒ…å†µï¼š\n\n```verilog\nsignal_a <= 5'd5;\n\nif(signal_a == 5'd5)\n\nsignal_a <= {1'b0, signal_b[3:0]+5'd4;\n```\n\nå› ä¸ºå·¥å…·é»˜è®¤æ˜¯32ä½å®½ï¼Œå¦‚æœä¸æ³¨æ˜ä½å®½ï¼Œå·¥å…·æ£€æŸ¥ä¼šæŠ¥warningï¼Œè€Œä¸”è¿™æ ·å¢åŠ äº†è®¾è®¡çš„ä¸¥è°¨æ€§ã€‚\n\n## ç»Ÿä¸€çš„è¯­å¥ä¹¦å†™â€•æ¡ä»¶åˆ¤æ–­ç»“æ„ä¹¦å†™æ–¹å¼\n\n### æ¡ä»¶çš„å®Œæ•´æ€§\n\nif elseæ­é…ä½¿ç”¨ï¼Œå¯¹äºç¼ºçœçš„æ¡ä»¶è¦å†™â€elseï¼›â€ï¼›\n\nif elseçš„æ¡ä»¶åˆ¤åˆ«å¼è¦å…¨é¢ï¼Œæ¯”å¦‚\"if(a == 1â€™b0)\";\n\ncaseä¸­çš„ç¼ºçœæ¡ä»¶è¦å†™â€defaultâ€ï¼›\n\n### â€if elseâ€ç»“æ„ï¼šé€‚ç”¨äºå¤æ‚æ¡ä»¶åˆ¤æ–­çš„è¯­å¥\n\nå¯¹äºå¤æ‚çš„æ¡ä»¶åˆ¤æ–­ï¼Œä½¿ç”¨\" ? : \"å¦‚æœä¸ä»”ç»†åˆ†ææ¡ä»¶çš„æ¯ä¸€æ¡è·¯å¾„ï¼Œå°±è®©è¯»ä»£ç çš„äººæä¸æ¸…å®ƒæ˜¯åˆ°åº•è¦åšä»€ä¹ˆã€‚ä¾‹å¦‚ï¼š\n\n`C = (!Ic&&!rc)?1'b0:(Ic?rc:Ic);`\n\næ”¹ä¸ºï¼š\n\n```verilog\nalways @(Ic or rc) begin    //if else\n    if ( (Ic==0) && (rc==0) )\n        c = 1'b0;\n    else if (Ic==1)\n        c = rc;\n    else\n        c = Ic;\nend\n```\n\nç®€å•çš„æ¡ä»¶åˆ¤æ–­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‰ç›®ç¬¦ï¼›å½“æ¶‰åŠå¤æ‚çš„æ¡ä»¶åˆ¤æ–­ï¼Œä½¿ç”¨IF-ELSEç»“æ„ä»¥è·å¾—æ¸…æ™°çš„ç»“æ„ä¾¿äºç†è§£å’Œç»´æŠ¤ã€‚\n\n### IF-ELSEç»“æ„ VS CASEç»“æ„\n\nIF-ELSEç»¼åˆçš„ç»“æœå¯èƒ½æ˜¯ä¸æˆ–éé—¨ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ç»„å¤šè·¯é€‰æ‹©å™¨ï¼›è€ŒCASEç»¼åˆç»“æœä¸€èˆ¬ä¼šæ˜¯å¤šè·¯é€‰æ‹©å™¨ï¼Œä½†å¯¹äºå¯ä»¥ä¼˜åŒ–çš„CASEç»¼åˆå·¥å…·ä¼šç»¼åˆå‡ºæ›´ç®€å•çš„ç»“æ„ã€‚\n\næ‰€æœ‰å¯¹äºå¯ä»¥å†™å‡ºå¹³è¡Œç»“æ„çš„æ¡ä»¶ï¼Œä¼˜å…ˆå†™æˆcaseç»“æ„ï¼Œä¾‹å¦‚åœ°å€è¯‘ç ç­‰ã€‚æ¡ä»¶ä¹‹é—´æœ‰é‡å¤å’ŒåµŒå¥—çš„æƒ…å†µåˆ™æ˜¯å†™æˆIF-ELSEç»“æ„ã€‚\n\n### Finite State Machine\n\nä¸å…è®¸æœ‰æ¨¡ç³Šä¸æ¸…çš„çŠ¶æ€æœºæ¨¡å¼ï¼Œæ‰€æœ‰çš„çŠ¶æ€æœºå¿…é¡»æ¸…æ™°æ˜äº†ã€‚\n\næˆ‘ä»¬è¦æ±‚å°†çŠ¶æ€æœºçš„æ—¶åºéƒ¨åˆ†å’Œç»„åˆé€»è¾‘éƒ¨åˆ†åˆ†å¼€ï¼Œå»ºè®®é‡‡ç”¨ä¸‰æ®µå¼ç»“æ„ã€‚\n\n## ç»Ÿä¸€æ ¼å¼çš„alwaysç¨‹åºå—çš„ä¹¦å†™\n\n### always ä¸­çš„å˜é‡çš„èµ‹å€¼æ–¹å¼â€•é˜»å¡ä¸éé˜»å¡èµ‹å€¼\n\nå½“è¿›è¡Œæ—¶åºé€»è¾‘å»ºæ¨¡æ—¶ï¼Œalwayså—ä¸­ä½¿ç”¨éé˜»å¡èµ‹å€¼ï¼Œâ€œ<=â€ï¼›\n\nå‚è€ƒå¦‚ä¸‹ä»£ç ï¼š\n\n```verilog\nalways @(posedge clk or negedge rst_n) begin \n    if (rst_n == 1'b0)\n        myreg <= 1'b0;\n    else\n        myreg <= 1'b1;\nend\n```\n\nå½“è¿›è¡Œç»„åˆé€»è¾‘å»ºæ¨¡æ—¶ï¼Œalwayså—ä¸­ä½¿ç”¨é˜»å¡èµ‹å€¼ï¼Œâ€œ=â€ï¼›\n\n```verilog\nalways @(addr) begin\n    case (addr)\n        2'b00 : cs0_n = 1'b0;\n        2'b01 : cs0_n = 1'b1;\n        2'b10 : cs0_n = 1'b0;\n        2'b11 : cs0_n = 1'b1;\n        default: cs0_n = 1'b1;\n    endcase\nend\n```\n\n### alwaysä¸­å˜é‡èµ‹å€¼çš„å”¯ä¸€æ€§\n\nç»„åˆalwayså—ä¸€å®šè¦æ³¨æ„æ•æ„Ÿé‡åˆ—è¡¨ä¸­çš„è§¦å‘é¡¹å®Œæ•´ä¸”ä¸å†—ä½™ï¼›å¦‚æœä¸æ˜¯è¿™æ ·ï¼Œç»¼åˆçš„ç”µè·¯ä¼šä¸å®é™…è®¾è®¡ä¸ç¬¦åˆï¼Œä¼šæŠ¥warningï¼›è¿™è¾¹å»ºè®®ä½¿ç”¨`always @(*)`çš„å†™æ³•æè¿°ç»„åˆalwayså—ã€‚\n\nä¸è¦å†å¤šä¸ªalwaysæ¨¡å—ä¸­å¯¹åŒä¸€ä¸ªregå‹å˜é‡è¿›è¡Œèµ‹å€¼ï¼›\n\nå»ºè®®ä¸è¦åœ¨ä¸€ä¸ªalwayså—é‡Œç»™å¤šä¸ªå˜é‡èµ‹å€¼ã€‚å¦‚æœå°†ä¸€ç»„æ¡ä»¶ç›¸åŒçš„å˜é‡å†™åœ¨ä¸€ä¸ªalwayså—ä¸­æ›´æœ‰åˆ©äºå¯è¯»æ€§çš„æé«˜å’ŒåŠŸèƒ½çš„å®ç°æ—¶å€™ï¼Œå¯æœ‰ä¾‹å¤–æƒ…å†µï¼Œä½†è¯·å°½é‡å¤šåŠ æ³¨é‡Šï¼Œä»¥å¢åŠ å¯è¯»æ€§ï¼Œå¹¶æ³¨æ„åœ¨ç»„åˆalwayså—ä¸­ä¸è¦å‡ºç°LATCHï¼›\n\n### alwayså¤ä½çš„ä¹¦å†™\n\nå¼‚æ­¥å¤ä½å’ŒåŒæ­¥å¤ä½æ¨¡å—å†…è¦ç»Ÿä¸€ï¼Œå¼‚æ­¥å¤ä½çš„æ¡ä»¶è¡¨è¾¾å¼åŠå‘½åè¦å’Œalwaysæ•æ„Ÿåˆ—è¡¨ä¸­çš„æè¿°ç›¸ç»Ÿä¸€ï¼Œæ‰€æœ‰çš„å¤ä½æœ‰æ•ˆç”µå¹³å¿…é¡»ç»Ÿä¸€ã€‚\n\n## åˆç†çš„æ³¨é‡Š\n\n- ä»£ç ä¸­å»ºè®®é‡‡ç”¨è‹±æ–‡ä½œè¯¦ç»†çš„æ³¨é‡Šï¼›\n- æ³¨é‡Šåº”è¯¥ä¸ä»£ç ä¸€è‡´ï¼Œä¿®æ”¹ç¨‹åºçš„æ—¶å€™ä¸€å®šè¦ä¿®æ”¹ç›¸åº”çš„æ³¨é‡Šï¼›\n- æ³¨é‡Šä¸åº”é‡å¤ä»£ç å·²ç»è¡¨æ˜çš„å†…å®¹ï¼Œè€Œæ˜¯ç®€æ˜åœ°ç‚¹æ˜ç¨‹åºçš„çªå‡ºç‰¹å¾ï¼›\n- æ³¨é‡Šåº”è¯¥æå–ç¨‹åºçš„çº¿ç´¢å’Œå…³é”®è¯ï¼Œå®ƒæ•´åˆç¨‹åºä¸­åˆ†æ•£çš„ä¿¡æ¯å¹¶å®ƒå¸®åŠ©ç†è§£ç¨‹åºä¸­ä¸èƒ½è¡¨æ˜çš„éƒ¨åˆ†ã€‚\n- æ³¨é‡Šä¸­å¯ä»¥åŠ å…¥TODOã€FIXMEç­‰æ ‡ç­¾æ¥æç¤ºä»£ç ä¸­çš„å¾…åŠäº‹é¡¹ï¼›\n\n## é‡ç”¨åŒ–è®¾è®¡\n\n### å±‚æ¬¡ç»“æ„ä¸æ¨¡å—åˆ’åˆ†\n\n- å±‚æ¬¡è®¾è®¡çš„åŸç†ä»¥ç®€å•ä¸ºä¸»â€•å°½é‡é¿å…ä¸å¿…è¦çš„å±‚æ¬¡ï¼›å±‚æ¬¡ç»“æ„è®¾è®¡å¾—å¥½ï¼Œåœ¨ç»¼åˆä¸­å°±ä¸éœ€è¦å¤ªå¤šçš„ä¼˜åŒ–è¿‡ç¨‹ï¼›\n- æ¨¡å—çš„åˆ’åˆ†æ ¹æ®å±‚æ¬¡è®¾è®¡æ¥å†³å®šâ€•æ¨¡å—åŒ–å¯¹äºå¸ƒçº¿æœ‰å¾ˆå¤§å¸®åŠ©ï¼Œæ¨¡å—åŒ–çš„è®¾è®¡ä¸­è¦å°½é‡å‡å°‘å…¨å±€ä¿¡å·çš„ä½¿ç”¨ï¼›\n- é€šç”¨çš„éƒ¨åˆ†å°½é‡æå–å‡ºæ¥ä½œä¸ºä¸€ä¸ªå…±ç”¨æ¨¡å—ï¼›\n\n### å‚æ•°ä¼ é€’\n\n- éœ€è¦ä¼ é€’å‚æ•°çš„æ¨¡å—ï¼Œåœ¨å¤šæ¬¡ä¾‹åŒ–çš„æ—¶å€™ç»Ÿä¸€éƒ½ä¼ é€’å‚æ•°ï¼Œä¸è¦ä¾‹åŒ–åŒä¸€ä¸ªæ¨¡å—ï¼Œæœ‰çš„ä¼ å‚æ•°ï¼Œæœ‰çš„ä¸ä¼ ã€‚\n\n### æ¨¡å—åˆ’åˆ†çš„æŠ€å·§\n\n- å°†ä¸åŒçš„æ—¶é’ŸåŸŸåˆ†ç¦»å¼€æ¥ï¼›\n- æŒ‰ç…§ä¸åŒçš„è®¾è®¡ç›®æ ‡åˆ’åˆ†æˆå—ï¼Œåˆ†å—æ—¶åº”åœ¨æ•°æ®æµæ–¹å‘ä¸Šè¿›è¡Œåˆ‡åˆ†ï¼›\n- åœ¨åŒä¸€æ¨¡å—ä¸­å®ç°é€»è¾‘èµ„æºå’Œç®—æœ¯èµ„æºçš„å…±äº«ï¼›","tags":["Basics"],"categories":["IC","Basics"]},{"title":"FPGAè¾“å…¥è¾“å‡ºä¿¡å·çš„IOBçº¦æŸæ–¹å¼","url":"/2022/10/09/FPGA/FPGAè¾“å…¥è¾“å‡ºä¿¡å·çš„IOBçº¦æŸæ–¹å¼/","content":"\n## å‰è¨€\n\nç¬”è€…åœ¨åšå®éªŒå®¤FPGAé¡¹ç›®æ—¶ï¼Œé‡åˆ°è¾“å…¥è¾“å‡ºä¿¡å·ç›¸å…³çš„çº¦æŸé—®é¢˜ã€‚åœ¨è¯·æ•™è€å¸ˆåï¼Œæ€»ç»“ä»¥ä¸‹å†…å®¹ï¼Œä¾›ä»¥åé‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ç¿»é˜…ã€‚\n\nå¯¹äºFPGAçš„è¾“å…¥ä¿¡å·ï¼Œæˆ‘ä»¬è¦ä»¥å¼‚æ­¥ä¿¡å·æ¥çœ‹å¾…ï¼Œè¾“å…¥ä¿¡å·è¿›æ¥å…ˆæ‰“æ‹ï¼Œä½¿ç”¨æ‰“æ‹åçš„æ•°æ®ã€‚ç¬¬ä¸€æ¬¡æ‰“æ‹çš„FFè¦çº¦æŸåˆ°IOBä¸­çš„IFFä¸­ï¼Œç¬¬äºŒä¸ªFFå°±å¯ä»¥æ”¾åˆ°Sliceä¸­ï¼Œè¿™æ ·æ¯æ¬¡å¸ƒå±€å¸ƒçº¿ä¸ä¼šå› ä¸ºFFçš„ä½ç½®ä¸åŒå¯¼è‡´æ—¶åºå‡ºé—®é¢˜ï¼Œä¸”è§£å†³äº†è¾“å…¥ä¿¡å·çš„å¼‚æ­¥é—®é¢˜ï¼›\n\nå¯¹äºFPGAçš„è¾“å‡ºä¿¡å·ï¼Œæˆ‘ä»¬ä¹Ÿè¦æ‰“æ‹è¾“å‡ºï¼Œç¡®ä¿æ‰‡å‡ºä¸º1ï¼Œå°†å…¶æ”¾åˆ°IOBä¸­çš„OFFä¸­ã€‚è¿™æ ·OFFåˆ°PADçš„è·¯å¾„å»¶è¿Ÿå›ºå®šï¼Œæ¯æ¬¡å¸ƒå±€å¸ƒçº¿ä¸ä¼šå› ä¸ºFFä½ç½®ä¸åŒå¯¼è‡´æ—¶åºå‡ºé—®é¢˜ã€‚\n\nå¯¹äºinoutä¿¡å·ï¼Œå½“è¯¥ä¿¡å·ä½œä¸ºè¾“å…¥ä¿¡å·æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶æ‰“ä¸¤æ‹è¿›è¡Œä½¿ç”¨ï¼›å½“éœ€è¦å‘æ€»çº¿ä¸Šæ”¾æ•°æ®æ—¶ï¼Œéœ€æ³¨æ„è¦ç”¨ä¸‰æ€çš„æ–¹å¼æ”¾ç½®æ•°æ®`assign inout_data = sel ? dout : 'bz;`ï¼Œä¸”è¦ä¿è¯selä¿¡å·æ˜¯regç±»å‹ã€‚\n\n## é—®é¢˜æè¿°\n\nè¾“å…¥ä¿¡å·æ²¡æœ‰ä½¿ç”¨IOBçº¦æŸï¼Œåœ¨ISEçš„IOB Propertiesä¸­æœªè§è¾“å…¥ä¿¡å·éƒ¨ç½²åˆ°IFFä¸­ã€‚\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091732502.png)\n\n\n\n## å°è¯•æ­¥éª¤\n\nåœ¨ISEå·¥å…·çš„Implementçš„propertyé€‰é¡¹ä¸­ï¼Œå¯¹-pré€‰é¡¹è¦é€‰æ‹©For Inputs and Outputsé€‰é¡¹ï¼›\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091735357.png)\n\nä¿®å¤è·Ÿè¾“å…¥ç›¸å…³çš„æ¨¡å—ï¼Œå¯¹è¾“å…¥ä¿¡å·è¦åšæ‰“æ‹å¤„ç†ï¼Œä½¿ç”¨æ‰“æ‹åçš„æ•°æ®è¿›è¡Œå†…éƒ¨çš„é€»è¾‘è¿ç®—ï¼›\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091736236.png)\n\n### ä¿®æ”¹Implementçš„é€‰é¡¹æŠ¥é”™\n\nä¿®å¤ååœ¨Mapé˜¶æ®µæŠ¥é”™ï¼ŒæŠ¥é”™å…·ä½“ä½ç½®åœ¨8b10bè§£ç IPï¼š\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091737591.png)\n\næ‰“å¼€8b10bçš„IPç½‘è¡¨è¿›è¡Œåˆ†æï¼š\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091737650.png)\n\nå…¶ä¸­rxä¸ºè¾“å…¥çš„å¤šå…‰è°±æ•°æ®çº¿ï¼Œ**çŒœæµ‹ä¸º8b10bçš„IPç½‘è¡¨ä¸­å¯¹ff_c0å’Œff_d1æœ‰å¸ƒå±€ä¸Šçš„çº¦æŸï¼Œff_c0å’Œff_d1éœ€è¦packåœ¨ä¸€èµ·ï¼Œè€Œå¦‚æœä½¿ç”¨è¾“å…¥IOBçš„è¯ï¼Œff_c0éœ€è¦å¸ƒå±€åœ¨IOBä¸­ï¼Œè€Œff_d1æ— æ³•å¸ƒå±€åœ¨IOBä¸­ï¼Œå¯¼è‡´æŠ¥é”™ã€‚**\n\næ‰€ä»¥è§£å†³æ–¹æ¡ˆä¸­ä¸èƒ½ä½¿ç”¨Implementçš„propertyã€‚\n\n### Inoutä¿¡å·çš„å¤„ç†æ–¹å¼\n\nè¦æ”¹å˜æ€»çº¿ä¸Šçš„æ•°æ®æ—¶ï¼Œä½¿ç”¨ä¸‰æ€æ§åˆ¶ï¼›\n\n`assign   cpu_data       = (rd_latchn == 1'b0) ? cpu_rdata_mux : 16'bz;`\n\nè¦ä½¿ç”¨æ€»çº¿ä¸Šçš„æ•°æ®æ—¶ï¼Œç›´æ¥æ‰“æ‹æ€»çº¿ä¸Šçš„æ•°æ®ï¼ˆcpu_dataï¼‰ä½¿ç”¨ï¼›\n\nå¢åŠ ä¸Šè¿°çº¦æŸåï¼ŒæŸ¥çœ‹ISEæŠ¥å‘Šï¼Œcpu_dataä»ç„¶æ˜¯OFFï¼Œè¾“å…¥ä¿¡å·æ²¡æœ‰çº¦æŸåˆ°IFFä¸Šã€‚\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091738262.png)\n\n## è§£å†³æ–¹æ¡ˆ\n\n### å¯¹äºè¾“å…¥ä¿¡å·\n\nå¯¹äºè¾“å…¥ä¿¡å·è€Œè¨€ï¼Œè¿›æ¥å…ˆæ‰“ä¸¤æ‹ï¼Œç¬¬ä¸€æ‹çš„æ•°æ®åˆ«ç”¨ï¼Œç”¨ç¬¬äºŒæ‹çš„æ•°æ®ã€‚\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091738401.png)\n\nå¦‚æœåœ¨ISEçš„Implementé€‰é¡¹é‡Œå¯ä»¥é€‰æ‹©`For Input and Outputs`çš„é€‰é¡¹çš„è¯ï¼Œé‚£åç»­å¯ä»¥ä¸ç”¨ç®¡äº†ï¼Œæ³¨æ„è¯¥é€‰é¡¹æ˜¯é’ˆå¯¹å…¨å±€çš„è®¾è®¡çš„ã€‚å¦‚æœåƒä¸Šæ–‡è¿™ç§æœ‰ä¸ªlvdsæ¥å£æ— æ³•æ”¾ç½®åˆ°IOBä¸­çš„è¯ï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹çš„åšæ³•ã€‚\n\n1ã€ä½¿ç”¨Verilogçš„attributeè¯­æ³•\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091739313.png)\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091739332.png)\n\n```verilog\n(* IOB = \"TRUE\" *) reg [8:0] cpu_data_d1;\n```\n\n2ã€åœ¨UCFæ–‡ä»¶é‡Œæ·»åŠ çº¦æŸ\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091741530.png)\n\nISEå·¥å…·é»˜è®¤ä¼šæŠŠæ¥å£ä¸Šçš„æ•°æ®æ”¾ç½®åˆ°IOBå†…ã€‚å¦‚æœé»˜è®¤çš„æ”¾ç½®æ–¹å¼æ²¡æœ‰èµ·ä½œç”¨çš„è¯ï¼Œæˆ‘ä»¬è¿™é‡Œé‡‡ç”¨çš„æ˜¯ç¬¬äºŒç§åšæ³•ã€‚\n\n### å¯¹äºè¾“å‡ºä¿¡å·\n\n**ä¿è¯æ‰‡å‡ºä¸º1**ï¼Œåœ¨ISEçš„Implementé€‰é¡¹ä¸­è®¾ç½®-pré€‰é¡¹ï¼Œä½¿ç”¨I/O Registerï¼›æˆ–è€…ä½¿ç”¨verilogä¸­attributeçš„æ–¹å¼æˆ–æ˜¯UCFæ–‡ä»¶ä¸­æ·»åŠ çº¦æŸçš„æ–¹å¼ï¼›\n\n### å¯¹äºinoutä¿¡å·\n\næŠŠinoutä¿¡å·å½“è¾“å…¥ä½¿ç”¨æ—¶ï¼Œæ³¨æ„æ‰“ä¸¤æ‹å†ä½¿ç”¨ï¼›\n\næŠŠinoutä¿¡å·å½“è¾“å‡ºæ—¶ï¼Œæ³¨æ„é‡‡ç”¨ä¸‰æ€å†™æ³•ï¼Œä¸”selä¿¡å·éœ€è¦æ˜¯regç±»å‹ï¼›\n\n`assign   cpu_data       = (rd_latchn == 1'b0) ? cpu_rdata_mux : 16'bz;`\n\nå¯¹äºinoutä¿¡å·ï¼Œæœ€å¥½åœ¨UCFæ–‡ä»¶ä¸­æ˜¾å¼çš„å¯¹ioä¿¡å·åšIOBçš„çº¦æŸï¼›\n\n```tcl\nINST \"u_cpu_top/cpu_data_d1*\" IOB=FORCE;\n```\n\npsï¼šPRä¹‹åçš„ä¿¡å·åå¯ä»¥åˆ°ISEä¸­çš„FPGA Editorå»æŸ¥è¯¢ã€‚ \n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091743114.png)\n\n## ç»“æœ\n\ninputã€outputã€inoutä¿¡å·å‡æ­£ç¡®çº¦æŸåˆ°IOBä¸­ã€‚\n\n![img](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210091743675.png)\n\n## Reference\n\n[UG625](https://www.xilinx.com/content/dam/xilinx/support/documents/sw_manuals/xilinx14_7/cgd.pdf)\n","tags":["FPGA_Tools"],"categories":["FPGA","FPGA_Tools"]},{"title":"ä¸ºä»€ä¹ˆéœ€è¦é—¨çº§ä»¿çœŸ","url":"/2022/10/07/IC/Basic/ä¸ºä»€ä¹ˆéœ€è¦é—¨çº§ä»¿çœŸ/","content":"\n## èƒŒæ™¯\n\nå½“æ—¶é¢è¯•ç™¾åº¦æ˜†ä»‘èŠ¯çš„æ—¶å€™ï¼Œé¢è¯•å®˜é—®æˆ‘è¿™æ ·ä¸€ä¸ªåœºæ™¯ã€‚å„Cornerä¸‹çš„Timingå·²ç»Cleanäº†ï¼ŒFormalityå·²ç»ä¿è¯RTLå’Œé—¨ç”µè·¯ä¿æŒä¸€è‡´äº†ï¼Œä¸ºä»€ä¹ˆè¦éœ€è¦å»åšGLSï¼ˆGate Level Simulationï¼‰å‘¢ï¼Ÿ\n\nå½“æ—¶é—®çš„ä¸€ä¸‹æ„£ä½ï¼Œæ²¡æƒ³æ˜ç™½ï¼Œä¸‹æ¥æœé›†èµ„æ–™å‘ç°ä»¥ä¸‹å‡ ç‚¹åŸå› ã€‚å…¶ä¸­éƒ¨åˆ†åŸå› è‡ªå·±ä¹Ÿè¿˜ä¸èƒ½ç†è§£åˆ°ä½ï¼ŒæœŸå¾…åç»­å®é™…å·¥ä½œä¸­åŠ æ·±ç†è§£ã€‚\n\n## åŸå› \n\n![GLS](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210071537119.jpg)\n\n1. è§£å†³STAå·¥å…·çš„å±€é™æ€§ï¼Œå¦‚STAå·¥å…·æ— æ³•åˆ†æå¼‚æ­¥æ¥å£ä¿¡å·ï¼ŒSTAå·¥å…·ä¹Ÿä¼šæ”¾å®½å¯¹False Pathå’ŒMulti-cycle Pathçš„æ£€æŸ¥ï¼Œç”¨GLSæ¥å¤æŸ¥ä¸€ä¸‹ï¼›\n2. æ ¸å®ä¸€ä¸‹ç³»ç»Ÿåˆå§‹åŒ–æ˜¯å¦æ­£å¸¸è¿›è¡Œï¼Œå¤ä½é“¾æ˜¯å¦æ­£ç¡®ï¼›\n3. éªŒè¯æ‰€æœ‰ç”µæºåŸŸçš„ä¸Šç”µå’Œå¤ä½æ“ä½œæ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œå¹¶ä¸”æ£€æŸ¥è®¾è®¡ä¸ä¾èµ–äºè®¾è®¡çš„åˆå§‹æ¡ä»¶ï¼›\n4. åˆ©ç”¨æœ€åå’Œæœ€ä½³çš„æ—¶åºä¿¡æ¯çš„ç»„åˆæ¥æ­ç¤ºè¾¹ç¼˜æ•æ„Ÿä¿¡å·ä¸Šçš„Glitchæƒ…å†µï¼›\n5. æ‰§è¡ŒDFTéªŒè¯ï¼Œå› ä¸ºæ‰«æé“¾æ˜¯åœ¨RTLç»¼åˆåæ’å…¥çš„ï¼›\n6. éªŒè¯æ—¶é’Ÿæ ‘ç»¼åˆï¼ˆCTSï¼‰æ˜¯å¦æ»¡è¶³è¦æ±‚ï¼›ï¼ˆSkewã€Jitterç­‰ï¼‰\n7. è·å–ç¿»è½¬ç‡å‚æ•°æ¥æ›´å‡†ç¡®åœ°ä¼°è®¡åŠŸè€—ï¼›\n8. åœ¨RTLæˆ–è€…GLSä¸­ä»¥æ‚²è§‚/ä¹è§‚æ¥åˆ†æXæ€ï¼›ï¼ˆä¸å¤ªç†è§£ï¼‰\n9. æ£€æŸ¥æœ€ç»ˆçš„æ€§èƒ½ä»¥ç¡®ä¿è®¾è®¡å·¥ä½œåœ¨æ‰€éœ€çš„é¢‘ç‡ï¼Œè·¯å¾„ä¸Šå®é™…çš„å»¶è¿Ÿéœ€è€ƒè™‘åœ¨å†…ï¼ŒåŒ…æ‹¬éƒ¨åˆ†ç»“æ„å…ƒç´ ä¸è¢«STAæˆ–è€…Formalityæ£€æŸ¥ï¼Œæˆ–è€…åœ¨PRé˜¶æ®µåœ¨è·¯å¾„ä¸Šæ’å…¥çš„Bufferæˆ–è€…å…¶ä»–çš„ç”µè·¯å…ƒç´ ã€‚","tags":["Basics"],"categories":["IC","Basics"]},{"title":"Blogå›¾åƒåŠ è½½å¤±è´¥è§£å†³æ–¹æ³•","url":"/2022/10/07/Misc/Blogå›¾åƒåŠ è½½å¤±è´¥è§£å†³æ–¹æ³•/","content":"\n## èƒŒæ™¯\n\nå¦‚æœä½ æ²¡æœ‰ç”¨ç§‘å­¦ä¸Šç½‘æ–¹å¼çš„è¯ï¼Œå¯èƒ½æœ¬åšå®¢ä¸­éƒ¨åˆ†å†…å®¹çš„å›¾åƒæ˜¯çœ‹ä¸äº†çš„ï¼Œå› ä¸ºåæœŸæˆ‘æ–‡ç« ä¸­çš„å›¾åƒæ‰˜ç®¡åˆ°äº†Githubä»“åº“é‡Œã€‚æ­¤æ—¶éœ€è¦æ ¹æ®ç³»ç»Ÿé…ç½®ä¸€ä¸‹DNSæ¥è¿›è¡Œå›¾åƒçš„æŸ¥çœ‹ï¼Œæ‰¾äº†éƒ¨åˆ†èµ„æ–™é“¾æ¥æ”¾åœ¨ä¸‹é¢ï¼Œä¸ªäººæ¯”è¾ƒæ¨èä¿®æ”¹DNSçš„æ–¹å¼ï¼Œå¿«æ·ç®€å•ã€‚ä»¥åè®¿é—®Githubæ—¶ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚\n\n## å‚è€ƒèµ„æ–™\n\n[Githubè®¿é—®é€Ÿåº¦æ…¢,å›¾ç‰‡æ— æ³•åŠ è½½çš„è§£å†³æ–¹æ³•](https://zhuanlan.zhihu.com/p/368689473)\n\n[ä¿®æ”¹Hostsè§£å†³Githubè®¿é—®å¤±è´¥](https://zhuanlan.zhihu.com/p/107334179)","tags":["Git"],"categories":["Misc","Git"]},{"title":"æ‘„å½±å…¥é—¨çŸ¥è¯†","url":"/2022/10/07/Misc/æ‘„å½±å…¥é—¨çŸ¥è¯†/","content":"\n# æ‘„å½±å…¥é—¨çŸ¥è¯†\n\n## æ›å…‰ä¸‰è¦ç´ \n\n### ä¸‰ä¸ªå‚æ•°\n\nå…‰åœˆå¤§å°ã€å¿«é—¨é€Ÿåº¦ã€ISOå¤§å°\n\n- å…‰åœˆå¤§å°ï¼šåŒæ—¶èƒ½è¿›å¤šå°‘å…‰\n- å¿«é—¨é€Ÿåº¦ï¼šé®å…‰æ¿**æ‰“å¼€å’Œå…³é—­**ä¸€æ¬¡çš„æ—¶é•¿ï¼Œé€Ÿåº¦è¶Šæ…¢é®å…‰æ¿æ‰“å¼€æ—¶é—´è¶Šä¹…ï¼Œè¿›å…‰è¶Šå¤š\n- ISOï¼šç†è§£ä¸ºé¢å¤–å¢åŠ çš„å°æ‰‹ç”µï¼Œå¼ºè¡Œæ·»åŠ é¢å¤–äº®åº¦ï¼ˆç”µå­ä¿¡å·ï¼‰ï¼Œä¼šå¢åŠ é¢—ç²’æ„Ÿ\n\n### å‚æ•°å¯¹åº”çš„æ•°å€¼è¯´æ˜\n\n- å…‰åœˆæ•°å€¼ï¼Œä¸å¤§å°ç›¸åï¼ŒF1.8ä¸ºå¤§å…‰åœˆï¼ŒF22ä¸ºå°å…‰åœˆï¼Œä»¥æ­¤ç±»æ¨...\n- å¿«é—¨é€Ÿåº¦ï¼Œå•ä½ä¸ºç§’ï¼ˆ16ï¼Œ1/2ï¼Œ1/8000 ç§’ç­‰ï¼‰ï¼Œæ•°å€¼è¶Šå°ï¼Œé®å…‰æ¿æ‰“å¼€æ—¶é—´è¶ŠçŸ­ï¼Œè¿›å…‰è¶Šå°‘ï¼›\n- iso æ•°å€¼  ï¼ˆ100ï¼Œ800ï¼Œ1600ç­‰ï¼‰ï¼Œæ•°å€¼è¶Šå¤§ï¼Œé¢å¤–å¼ºè¡Œè¡¥å…‰è¶Šå¤šï¼Œé¢—ç²’æ„Ÿè¶Šé‡\n\n### äº®æš—ç¯å¢ƒä¸‹çš„è°ƒæ•´æ­¥éª¤\n\n- æš—ç¯å¢ƒä¸‹ï¼š1ã€é¦–å…ˆè°ƒå¤§å…‰åœˆï¼›2ã€å…¶æ¬¡å‡æ…¢å¿«é—¨ï¼›3ã€æœ€åè¿˜ä¸è¡Œå†è°ƒå¤§isoï¼›ä¼˜å…ˆçº§é€æ¸é™ä½ï¼›\n- äº®ç¯å¢ƒä¸‹ï¼š1ã€è°ƒä½ISOï¼›2ã€åŠ å¿«å¿«é—¨ï¼›3ã€æœ€åè¿˜ä¸è¡Œå†è°ƒå°å…‰åœˆï¼›\n\n## å…‰åœˆå’Œå¿«é—¨å¯¹ç…§ç‰‡çš„å…¶ä»–å½±å“\n\n### å…‰åœˆå¤§å°å½±å“äº®åº¦ã€æ™¯æ·±ã€è™šåŒ–\n\n- æ™¯æ·±ï¼šä»é•œå¤´å‘æ•£å‡ºå»ï¼Œåªæœ‰ä¸€éƒ¨åˆ†åŒºåŸŸçš„æ™¯è±¡æ˜¯æ¸…æ™°çš„ï¼Œå…¶ä»–çš„ä¼šæ¨¡ç³Šã€‚**æ¸…æ™°çš„åŒºåŸŸï¼Œå°±å«åšæ™¯æ·±ã€‚**å¤§å…‰åœˆï¼Œæµ…æ™¯æ·±ï¼Œæ¸…æ™°çš„åŒºåŸŸå°ï¼ŒèƒŒæ™¯ä¼šæ¨¡ç³Šï¼›å°å…‰åœˆï¼Œæ·±æ™¯æ·±ï¼Œæ¸…æ™°çš„åŒºåŸŸå¤§ï¼ŒèƒŒæ™¯ä¹Ÿæ¸…æ™°ï¼›\n- è™šåŒ–ï¼šå…‰åœˆè¶Šå¤§ï¼ŒèƒŒæ™¯è™šåŒ–è¶Šå¼ºï¼ˆä¸æ™¯æ·±è”ç³»èµ·æ¥ï¼Œå¤§å…‰åœˆï¼Œæµ…æ™¯æ·±ï¼ŒèƒŒæ™¯æ¨¡ç³Šâ†’èƒŒæ™¯è™šåŒ–ï¼‰ï¼›å…‰åœˆè¶Šå°ï¼ŒèƒŒæ™¯è™šåŒ–è¶Šå¼±ï¼›\n  - è™šåŒ–å¼ºå¼±çš„ç†è§£ï¼šä¸€ç›å°ç¯åœ¨å¤§å…‰åœˆä¸‹ï¼Œç¯ä¼šè™šåŒ–æˆå¤§å…‰æ–‘ï¼›å°å…‰åœˆï¼Œç¯è™šåŒ–æˆçš„å…‰æ–‘ä¹Ÿå°ï¼›ï¼ˆå…‰æ–‘çš„å½¢çŠ¶æ¥æºäºå…‰åœˆæ‰‡å¶å½¢æˆçš„åœ†æ´ï¼Œ**å‡å¦‚ç”¨å¡çº¸å‰ªå‡ºå¿ƒå½¢ç½®äºé•œå¤´å‰ï¼Œå…‰æ–‘ä¹Ÿæˆå¿ƒå½¢**ï¼‰ï¼›\n  - è™šåŒ–çš„ä¸æ­¢èƒŒæ™¯ï¼Œè¿˜æœ‰å‰æ™¯ï¼›å¯åº”ç”¨å‰æ™¯è™šåŒ–ï¼Œæ‹æ‘„æ¢¦å¹»æ„Ÿçš„ç…§ç‰‡ã€‚\n  - æ™¯æ·±ä¸å¯¹ç„¦çš„ç†è§£ï¼šå¯¹ç„¦ï¼Œå°±æ˜¯è®©æ¸…æ™°çš„åŒºåŸŸï¼ˆæ™¯æ·±ï¼‰ä¸æ‹æ‘„ä¸»ä½“æœ‰é‡åˆã€‚å› æ­¤ï¼Œ**å°å…‰åœˆæ˜“äºå¯¹ç„¦è¿åŠ¨ä¸­çš„ä¸»ä½“**ã€‚\n\n### å¿«é—¨é€Ÿåº¦å½±å“äº®åº¦ï¼ŒåŠ¨æ€æ¨¡ç³Š\n\n- æ…¢å¿«é—¨æ—¶ï¼Œå‡å¦‚ç›¸æœºæŠ–åŠ¨ï¼Œå°†å¯¼è‡´å…‰åœ¨CMOSä¸Šæœ‰è¿åŠ¨è½¨è¿¹ï¼Œè¿›è€Œå¯¼è‡´ç…§ç‰‡ç³Šæ‰ï¼›\n- è‡ªåŠ¨æŒ¡æ—¶ï¼Œä½¿ç”¨å¤§å…‰åœˆï¼Œå¢å¤§ISOï¼Œæˆ–è€…ç”¨é—ªå…‰ç¯æˆ–è¡¥å…‰ç¯ç…§äº®ä¸»ä½“ï¼Œå¯ä»¥å°½å¯èƒ½é¿å…ç›¸æœºä½¿ç”¨æ…¢å¿«é—¨ï¼Œè¿›è€Œé¿å…æ‹æ‘„æ—¶ï¼Œç›¸æœºæŠ–åŠ¨å¯¼è‡´ç…§ç‰‡ç³Šæ‰ï¼›\n- æ…¢é€Ÿå¿«é—¨æ‹æ‘„æŠ€å·§ï¼Œå¯ç”¨äºæ‹æ‘„å…‰ç»˜ï¼Œæ˜Ÿè½¨ï¼Œè½¦æµï¼Œç«èŠ±ï¼›å¯ä½¿ç”¨ä¸‰è„šæ¶ä¿æŒç›¸æœºç¨³å®šï¼Œé˜²æ­¢ç³Šæ‰\n\n### åœ¨å¼ºå…‰ä¸‹å¦‚ä½•è™šåŒ–+åŠ¨æ€æ¨¡ç³Šï¼Ÿ\n\nè™šåŒ–å°±éœ€è¦å…‰åœˆè°ƒå¤§->æµ…æ™¯æ·±->èƒŒæ™¯æ¨¡ç³Šï¼ŒåŠ¨æ€æ¨¡ç³Šéœ€è¦æ…¢å¿«é—¨->è®©å…‰åœ¨CMOSä¸Šè¿åŠ¨ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´è¿›å…‰é‡å¤ªå¤šçš„é—®é¢˜ï¼Œæœ¬è´¨ä¸Šæ˜¯çŸ›ç›¾çš„ã€‚\n\nè¿™æ—¶æˆ‘ä»¬å¼•å…¥NDæ»¤é•œï¼ˆæ§å…‰å·¥å…·ï¼‰ï¼Œå¯ç†è§£ä¸ºç›¸æœºç”¨å¢¨é•œğŸ•¶å¯ä»¥é™ä½ç”»é¢äº®åº¦ï¼Œæœ‰å¯å˜å’Œå›ºå®šå‚æ•°ä¸¤ç§ã€‚\n\n## ç›¸æœºæ¡£ä½\n\n### å®šä¹‰\n\nç›¸æœºæ¡£ä½æœ¬è´¨ä¸Šæ˜¯ç”¨æ¥æ§åˆ¶å…‰åœˆã€ISOå’Œå¿«é—¨é€Ÿåº¦çš„ï¼Œåªä¸è¿‡ä¸åŒçš„æ¡£ä½ä¸‹ä½ èƒ½æŠŠæ¡çš„å˜é‡ä¸åŒï¼›\n\n- Mï¼šè‡ªç”±æ§åˆ¶æ‰€æœ‰å‚æ•°ï¼›\n- A/AVï¼šåªèƒ½æ§åˆ¶å…‰åœˆå‚æ•°ï¼Œå…¶å®ƒå‚æ•°ç›¸æœºè‡ªé€‚åº”ï¼ˆç”¨é€”ï¼šï¼ˆç”»é¢æœ‰å¤§å…‰åœˆè™šåŒ–ï¼‰äººã€å¾®è·ã€ç‰¹å†™ã€‚æ¡ä»¶ï¼šå…‰çº¿ã€äº®åº¦è¶³å¤Ÿå¥½ã€‚ï¼‰\n- S/TVï¼šåªèƒ½æ§åˆ¶å¿«é—¨é€Ÿåº¦ï¼Œå…¶ä»–å‚æ•°ç›¸æœºè‡ªé€‚åº”ã€‚ï¼ˆç”¨é€”ï¼š1ã€æ…¢é€Ÿå¿«é—¨ï¼›2ã€å¿«é€ŸæŠ“æ‹ï¼šæ‰“é¸Ÿã€å°å­©ã€é€Ÿåº¦å¿«çš„ç‰©ä½“/äº‹ä»¶ï¼›ï¼‰\n- Pï¼šå®šå‘è‡ªé€‚åº”æ¨¡å¼ï¼Œç›¸æœºé€šè¿‡ä½ çš„ä¿®æ”¹å‚æ•°æ¥è‡ªåŠ¨è°ƒæ•´å…¶å®ƒå‚æ•°ã€‚ä¾‹å¦‚ï¼šå…‰åœˆï¼ˆä½ ï¼‰ï¼ŒISOï¼Œå¿«é—¨é€Ÿåº¦ï¼ˆç›¸æœºï¼‰ï¼›ç›¸æœºä¼šé€šè¿‡ä½ çš„è‡ªå˜é‡ï¼ˆx=å…‰åœˆ/å¿«é—¨é€Ÿåº¦ï¼‰ï¼Œæ¥è°ƒæ•´å¦ä¸€ä¸ªå‚æ•°ï¼ˆå¿«é—¨é€Ÿåº¦/å…‰åœˆï¼‰ï¼Œå‰æï¼šISOä¸ºauto ã€‚\n\n### æ›å…‰è¡¥å¿\n\nç¨‹åºç®—æ³•ï¼Œæ ¹æ®ä½ çš„é€‰æ‹©ï¼Œè°ƒæ•´ä¸‰è¦ç´ æ•°å€¼ï¼Œæ”¹å˜ç”»é¢äº®åº¦ï¼›\n\nåœ¨ä¸åŒçš„æ¡£ä½æ¨¡å¼ä¸‹ï¼Œæ›å…‰è¡¥å¿èƒ½æ”¹å˜çš„å‚æ•°ä¸åŒï¼›\n\n![æ›å…‰è¡¥å¿è¯´æ˜](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210031850425.png)\n\n### å›¾åƒç›´æ–¹å›¾\n\n|     ç”»é¢     |   æ–¹å‘   |\n| :----------: | :------: |\n|      æš—      |   åå·¦   |\n|      äº®      |   åå³   |\n|   æ­£å¸¸æ›å…‰   | å‡åŒ€å¹³é“º |\n| æ²¡æœ‰è¿‡æ¸¡éƒ¨åˆ† | åˆ†æ•£ä¸¤è¾¹ |\n\nå¦‚æœåœºæ™¯æ•æ„Ÿæ¯”ä¾‹ä¸å¹³è¡¡çš„è¯ï¼Œç›´æ–¹å›¾ä¸èƒ½ç›´è§‚çš„æ˜¾ç¤ºï¼Œå°±è¦åšå–èˆï¼Œæ³¨æ„æ‹æ‘„ä¸»é¢˜çš„è´¨é‡ï¼›\n\n## ç™½å¹³è¡¡\n\nå½“æˆ‘ä»¬æ‹æ‘„ä½è‰²æ¸©ç¯å¢ƒå¦‚3500kï¼ˆåè“ï¼‰ï¼Œç™½å¹³è¡¡kå€¼è®¾ç½®è¦é«˜å¦‚7000kï¼ˆåé»„ï¼‰ï¼Œä¸¤è€…ç»¼åˆæ‰èƒ½è¿˜åŸç‰©ä½“åŸæ¥é¢œè‰²ï¼Œè¿™å°±æ˜¯ç™½å¹³è¡¡çš„ç”¨å¤„ã€‚\n\nç®€å•æ¥è¯´å°±æ˜¯ï¼šç™½å¹³è¡¡è®¾ç½®ä½kå€¼ï¼Œç›¸æœºä¼šè®¤ä¸ºå¤–éƒ¨ç¯å¢ƒåé»„ï¼Œæ‰€ä»¥åŠ è“ï¼›è®¾ç½®é«˜kå€¼ï¼Œç›¸æœºä¼šè®¤ä¸ºå¤–éƒ¨ç¯å¢ƒåè“ï¼Œæ‰€ä»¥åŠ çº¢ã€‚å‚æ™šæ‹æ‘„ç…§ç‰‡æ—¶ç”¨3500kï¼Œæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œå¦‚æœæƒ³è¦æ‹æ‘„ç»šä¸½é»„æ˜ï¼Œé«˜kå€¼ä¹Ÿæ˜¯ä¸é”™çš„é€‰æ‹©ï¼Œè¿™å–å†³äºæœ€ç»ˆæƒ³æ€ä¹ˆè¡¨ç°ä¸€å¼ å›¾æƒ³è¡¨è¾¾çš„æƒ…ç»ªã€‚\n\n## æµ‹å…‰\n\nä¸»è¦è°ƒæ•´å¯¹è±¡ï¼šå…‰åœˆå¿«é—¨ISOã€æ›å…‰è¡¥å¿ã€æµ‹å…‰æ¨¡å¼\n\näº®åº¦å¤ªé«˜/äº®åº¦ä¸è¶³ï¼šçœ‹ç›´æ–¹å›¾åˆ¤æ–­ã€æ›å…‰è¡¥å¿å°ç®¡å®¶ï¼ˆåœ¨Mæ¡£ä½ä¸‹ï¼‰ï¼ˆçœ‹+/-æ•°å€¼ï¼‰ï¼›\n\næµ‹å…‰æ¨¡å¼ï¼šè¯„ä»·/å¤šé‡æµ‹å…‰ï¼ˆæ‹äººåƒï¼‰ã€ä¸­å¤®æµ‹å…‰ï¼ˆå¯¹è±¡åœ¨ç”»é¢ä¸­å¤®ï¼Œè·Ÿæ‹vlogï¼‰ã€ç‚¹æµ‹å…‰ï¼ˆå¯¹è±¡ä¸€ç›´åœ¨ç”»é¢æŸä¸ªä½ç½®ï¼Œå¦‚ä¼šè®®è®°å½•ï¼‰ï¼›\n\nå›ºå®šæµ‹å…‰çš„äº®åº¦ï¼šäº®åº¦é”ï¼ˆ*ï¼‰ã€Sonyï¼ˆaelï¼‰ï¼›\n\n## æ™¯æ·±\n\n- æ™¯æ·±é€šä¿—çš„æ¥è¯´å°±æ˜¯ç”»é¢ä¸­å‰åæ¸…æ™°çš„èŒƒå›´ï¼Œä½†å¯¹ç„¦å¹¶ä¸ç­‰äºç§»åŠ¨æ™¯æ·±ï¼Œè€Œæ˜¯ç§»åŠ¨ç„¦ç‚¹ã€‚\n\n- åŒæ—¶æ™¯æ·±ä¹Ÿå¹¶ä¸åªæ˜¯ä¸€ä¸ªç®€å•çš„èŒƒå›´ï¼Œè€Œæ˜¯ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šå¤§æ¦‚ç¤ºæ„å›¾ï¼š\n\n  ğŸ¥  <         (   å‰æ™¯æ·±ï½œç„¦ç‚¹|       åæ™¯æ·± )\n\n- ä¸ºä»€ä¹ˆè¦æŠŠæ™¯æ·±åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Ÿ\n\n  æ™¯æ·±èŒƒå›´å†…å¹¶ä¸æ˜¯æ‰€æœ‰ä¸œè¥¿éƒ½åŒæ ·æ¸…æ™°ï¼\n\n  ä»ç‰©ç†ç†è®ºä¸Šæ¥è¯´ï¼Œåªæœ‰ç„¦ç‚¹ä¸Šçš„ç‰©ä½“æ‰æ˜¯â€œç»å¯¹â€æ¸…æ™°çš„ è€Œå‰æ™¯æ·±ä¸åæ™¯æ·±åªæ˜¯â€œç›¸å¯¹æ¸…æ™°â€ï¼ˆè½»å¾®æ¨¡ç³Šï¼Œä½†äººçœ¼åˆ†è¾¨ä¸å‡ºï¼‰ è¿™ä¼¼ä¹éƒ½æ˜¯æ¸…æ™° ä½†å‡å¦‚åœ¨ä¸€äº›éœ€è¦æ”¾å¤§å‡ å€çš„ç‰¹æ®Šæƒ…å†µä¸‹ è¿™ä¸ªé—®é¢˜å°±ä¼šæ˜¾ç°ï¼šæ¯”å¦‚åœ¨æ‹æ‘„äººåƒçš„æ—¶å€™ï¼Œå¯¹ç„¦åˆ°é¼»å°– ã€‚å¥½åƒçœ¼ç›å’Œé¼»å°–éƒ½åœ¨æ™¯æ·±å†…ï¼Œä½†æ”¾å¤§åçœ¼ç›æ˜¯å¯èƒ½ä¼šæ„Ÿè§‰åˆ°è½»å¾®æ¨¡ç³Šçš„ã€‚\n\n  æ‰€ä»¥ç›²ç›®æŠŠå¯¹ç„¦ç†è§£ä¸ºâ€œåªè¦è½åœ¨è¿™ä¸ªèŒƒå›´é‡Œâ€æ˜¯éå¸¸å±é™©çš„ï¼ï¼ï¼æ­£ç¡®æ–¹æ³•åº”è¯¥æ˜¯å°†æœ€ä¸»è¦çš„ç‰©ä½“ï¼ˆä¾‹å¦‚äººåƒçš„çœ¼ç›ï¼‰æ”¾åœ¨ç„¦ç‚¹ä¸Šï¼Œè€Œè‡³äºå…¶ä»–åŒºåŸŸï¼ˆä¾‹å¦‚è€³æœµã€é¼»å­ç­‰ï¼‰å¦‚æœæƒ³è¦æ¸…æ™°çš„è¯ï¼Œå†é€šè¿‡è°ƒæ•´å…‰åœˆæˆ–ç„¦è·çš„æ–¹æ³•æ”¹å˜æ™¯æ·±å¤§å°æ¥å®ç°æ¸…æ™°ï¼\n\n- æ‹ç…§æ—¶å…ˆå®šç„¦ç‚¹ï¼Œå†å»æ„å›¾ï¼›\n","tags":["photography"],"categories":["Misc","photography"]},{"title":"æˆ‘çš„ç§‹æ‹›å°ç»“","url":"/2022/09/30/Interview/ç§‹æ‹›å°ç»“/","content":"\n# èƒŒæ™¯ä»‹ç»\n\n2022å¹´ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æœªæ¥åå¹´æœ€å¥½çš„ä¸€å¹´ï¼Œä¸è¿‡åº”è¯¥æ˜¯è¿‡å»åå¹´æœ€å·®çš„ä¸€å¹´ã€‚å¬å®Œä»»æ€»çš„â€œå¯’æ°”è®ºâ€å’Œå­—èŠ‚æ¢æ€»çš„â€œå»è‚¥å¢ç˜¦â€ç†è®ºåï¼Œæ¯ä¸ª2023çš„åº”å±Šç”Ÿåº”è¯¥éƒ½èƒ½æ„Ÿå—åˆ°è¿™åˆºéª¨çš„å¯’æ„ã€‚\n\næˆ‘çš„ç§‹æ‹›ç»å†å¼€å§‹è¾ƒæ—©ï¼Œ6æœˆé™†ç»­å¼€å§‹æŠ•é€’å„å…¬å¸çš„æå‰æ‰¹ï¼Œ7-8æœˆä»½ä¸ºé¢è¯•é«˜å³°æœŸï¼Œ9æœˆé™†ç»­æ”¶åˆ°å„å®¶çš„offerã€‚æ–‡ç« çš„åé¢æˆ‘ä¼šå¤§æ¦‚å›å¿†å„é¢è¯•çš„é—®é¢˜ï¼Œæ¢³ç†æ ¡æ‹›æ—¶é¢è¯•å®˜å…³å¿ƒçš„å…±æ€§é—®é¢˜ï¼Œä»…ä¾›å¤§å®¶å‚è€ƒï¼Œå‡†å¤‡åç»­çš„ç§‹æ‹›ç¬”è¯•é¢è¯•ã€‚\n\næœ¬æ–‡æ•´ç†çš„ä¸€äº›çŸ¥è¯†ç‚¹åç»­ä¼šæ…¢æ…¢åœ¨è‡ªå·±çš„åšå®¢æ›´æ–°ï¼ˆç»™è‡ªå·±æŒ–äº†ä¸€æ³¢å¤§å‘ï¼‰ï¼Œå¸Œæœ›åé¢æ…¢æ…¢å¡«ä¸Šï¼›\n\n# é¡¹ç›®ç›¸å…³\n\n- å‡†å¤‡é¡¹ç›®çš„ç®€è¦ç³»ç»Ÿæ¶æ„ä»‹ç»ã€‚å¯ä»¥åŒ…æ‹¬ä»¥ä¸‹è¦ç´ ï¼šé¡¹ç›®æ¡†å›¾ã€å„æ¨¡å—åŠŸèƒ½ä»‹ç»ã€ç³»ç»Ÿæ¥å£ã€æ—¶é’Ÿå¤ä½ç½‘ç»œï¼›å¯ä»¥ç”¨Xmindæˆ–è€…MarkDownå·¥å…·å»æ¢³ç†é¡¹ç›®æ¶æ„ã€‚\n- æå–é¡¹ç›®çš„äº®ç‚¹ã€éš¾ç‚¹ã€‚éƒ¨åˆ†é¢è¯•æ—¶é—´ä¸å¤Ÿçš„è¯é¢è¯•å®˜ä¸ä¼šç»™å……è¶³çš„æ—¶é—´è¯¦å°½ä»‹ç»é¡¹ç›®ï¼Œå¯ä»¥ä»æ—¶åºçº¦æŸã€ç®—æ³•è®¾è®¡ã€ä¼˜åŒ–æ–¹å¼ã€è®¡ç®—æ€§èƒ½ç­‰æ–¹å‘å»æ•´ç†ï¼›\n- é¡¹ç›®ä¸­æ¶‰åŠåˆ°çš„ç‚¹è¦æ‹“å±•å»¶ä¼¸ï¼Œäº†è§£ç›¸å…³çš„åŸºç¡€çŸ¥è¯†ã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œæˆ‘çš„é¡¹ç›®æ¥å£ä¿¡å·ä½¿ç”¨äº†8b10bç¼–ç æ–¹å¼ï¼Œè‡ªå·±å¯ä»¥è€ƒè™‘å¦‚ä¸‹å‡ ç‚¹ï¼š1ã€8b10bç¼–ç æ˜¯ä»€ä¹ˆï¼Ÿ2ã€ä¸ºä»€ä¹ˆéœ€è¦8b10bç¼–ç ï¼Œè¯¥ç¼–ç æ˜¯ç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ3ã€æœ‰å…¶ä»–æ–¹å¼å¯ä»¥è§£å†³è¯¥é—®é¢˜å—ï¼Ÿè¦å¸¦å…¥é¢è¯•å®˜çš„è§’åº¦å»æ€è€ƒè‡ªå·±çš„é¡¹ç›®ï¼›\n- æ€»ç»“åœ¨åšé¡¹ç›®è¿‡ç¨‹ä¸­é‡åˆ°çš„æ£˜æ‰‹é—®é¢˜ï¼Œåœ¨ç»™é¢è¯•å®˜å™è¿°è‡ªå·±è§£å†³é—®é¢˜çš„æ€è·¯å’Œæ–¹å¼çš„è¿‡ç¨‹ä¸­å±•ç°è‡ªå·±çš„èƒ½åŠ›ã€‚\n- é¡¹ç›®çš„éªŒè¯æ–¹å¼ï¼›äº†è§£é¡¹ç›®æ¶‰åŠçš„IC/FPGAçš„å·¥è‰ºï¼Œé¢ç§¯ï¼›\n- ç»Ÿè®¡é¡¹ç›®ä¸­è‡ªå·±è´Ÿè´£éƒ¨åˆ†çš„ä»£ç é‡ï¼›\n\n# åŸºç¡€çŸ¥è¯†\n\n## è·¨æ—¶é’ŸåŸŸ\n\n- åŸºæœ¬çš„CMOSã€PMOSç»“æ„ï¼›\n- è·¨æ—¶é’ŸåŸŸçš„åŸå› ï¼Œäºšç¨³æ€çš„å®šä¹‰ï¼›\n- å»ºç«‹æ—¶é—´ã€ä¿æŒæ—¶é—´ï¼›\n- å•bitä¿¡å·è·¨æ—¶é’ŸåŸŸï¼Œè€ƒè™‘å¿«æ…¢æ—¶é’ŸåŸŸï¼›\n- å¤šbitä¿¡å·è·¨æ—¶é’ŸåŸŸï¼›\n  - å¼‚æ­¥FIFOçš„å‡ç©ºå‡æ»¡ï¼›\n  - æ ¼é›·ç è·¨æ—¶é’ŸåŸŸé—®é¢˜ï¼›\n  - å¦‚ä½•è€ƒè™‘FIFOæ·±åº¦ï¼›\n  - FIFOå’ŒDMUXçš„ç›¸å…³æ—¶åºçº¦æŸï¼›\n- ä½•æ—¶éœ€è¦è·¨æ—¶é’Ÿï¼Œè·¨æ—¶é’Ÿæ–¹å¼å¦‚ä½•é€‰æ‹©ï¼›\n- å…³äºå¤ä½ä¿¡å·çš„è·¨æ—¶é’ŸåŸŸï¼›\n- Time Borrow/Stealï¼ˆè¿›é˜¶ï¼‰\n\n## ä½åŠŸè€—è®¾è®¡\n\n- åŠŸè€—çš„åˆ†ç±»ã€å½±å“å› ç´ ã€è®¡ç®—å…¬å¼\n- é™æ€ä½åŠŸè€—æŠ€æœ¯ï¼Œé™é™æ€åŠŸè€—çš„æ–¹æ³•ï¼›\n- åŠ¨æ€ä½åŠŸè€—æŠ€æœ¯ï¼Œé™åŠ¨æ€åŠŸè€—çš„æ–¹æ³•ï¼›\n- RTLè®¾è®¡ä¸­é™åŠŸè€—çš„æ–¹å¼ï¼›\n- ä»¥åç›¸å™¨ä¸ºä¾‹è§£é‡Šé™æ€åŠŸè€—å’ŒåŠ¨æ€åŠŸè€—ï¼›\n\n## æ—¶åºçº¦æŸ\n\n- æ—¶é’Ÿç›¸å…³\n  - å‘¨æœŸã€å ç©ºæ¯”ã€ç®¡è„šï¼›\n  - Primary Clockã€Virtual Clockã€Generated Clockã€Clock Groupsï¼›\n  - Clock Latencyã€Jitterã€Uncertaintyï¼›\n- IO Delay\n  - Input Delayï¼›\n  - Output Delayï¼›\n- Time Exceptions\n  - Multicycleï¼›\n  - False Pathï¼›\n  - Max/Min Delayï¼›\n\n## ICç›¸å…³\n\n- ç®€è¿°ICè®¾è®¡æµç¨‹ï¼Œäº†è§£å„æ­¥éª¤çš„ç›®çš„ï¼›\n- ICå’ŒFPGAçš„åŒºåˆ«ï¼›\n- ä¿®Time Violationçš„æ–¹å¼ï¼›\n\n## AMBAåè®®\n\n- è¯»å†™æ¶æ„ï¼Œä¿¡å·åˆ—è¡¨åŠå«ä¹‰ï¼›\n- è·¨4Ké—®é¢˜ï¼›\n- æ¡æ‰‹é—´çš„ä¾èµ–å…³ç³»ï¼›\n- èƒ½å¦æå‰ç»“æŸçªå‘ä¼ è¾“ï¼›\n- çª„ä½å®½æ•°æ®ä¼ è¾“ã€éå¯¹é½ä¼ è¾“ã€æ··åˆå¤§å°ç«¯ä¼ è¾“ï¼›\n- Outstandingçš„å«ä¹‰ï¼Œå¦‚ä½•è€ƒè™‘Outstandingæ·±åº¦ï¼›\n\n- Out of Orderçš„å«ä¹‰ï¼Œè·ŸIDä¿¡å·æ˜¯å¦æœ‰è”ç³»ï¼›\n- Interconnectçš„ç»“æ„ï¼›\n- AXI3ã€AXI4çš„åŒºåˆ«ï¼›\n- AXI Fullã€AXI Liteçš„åŒºåˆ«ï¼›\n- AXIçš„æ­»é”åœºæ™¯ï¼›\n\n# ç¬”è¯•\n\n- çŠ¶æ€æœºç›¸å…³ï¼šçº¢ç»¿ç¯ã€è‡ªåŠ¨å”®è´§æœºã€åºåˆ—æ£€æµ‹ï¼›\n- åˆ†é¢‘ç›¸å…³ï¼šå¥‡å¶åˆ†é¢‘ã€åŠæ•´æ•°åˆ†é¢‘ã€å°æ•°åˆ†é¢‘ï¼›\n- ä»²è£ç›¸å…³ï¼šä¼˜å…ˆçº§ä»²è£ã€å›ºå®šä¼˜å…ˆçº§ä»²è£ã€å˜ä¼˜å…ˆçº§ä»²è£ã€è½®è¯¢ä»²è£ã€åŠ æƒè½®è¯¢ï¼›\n- å­˜å‚¨ï¼šå•å£RAMã€ç®€å•åŒå£RAMã€çœŸåŒå£RAMï¼›\n- CDC\n  - åŒæ­¥FIFOï¼šåŸºäºå•å£RAMã€åŸºäºåŒå£RAMï¼›\n  - å¼‚æ­¥FIFOï¼šBin2Grayã€Gray2Binï¼›\n  - è„‰å†²åŒæ­¥å™¨ã€å¸¦åé¦ˆçš„è„‰å†²åŒæ­¥å™¨ï¼›\n  - å‰å‘/åå‘Pipeï¼›\n- é—¨çº§ç”µè·¯ï¼šè®¡æ•°å™¨ã€å…¨åŠ å™¨ã€äºŒ/ä¸‰åˆ†é¢‘ã€å ç©ºæ¯”1:3çš„äºŒåˆ†é¢‘ï¼›\n- å…¶å®ƒï¼šGenerateã€Forè¯­æ³•ç›¸å…³ï¼›","tags":["interview"],"categories":["interview"]},{"title":"è·¨å¤ä½åŸŸå°ç»“","url":"/2022/09/29/Interview/è·¨å¤ä½åŸŸå°ç»“/","content":"\n# è·¨å¤ä½åŸŸå°ç»“\n\nè·¨æ—¶é’ŸåŸŸæˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰ï¼Œä½†è·¨å¤ä½åŸŸå¯èƒ½å°±æ¯”è¾ƒé™Œç”Ÿäº†ã€‚åœ¨å¹³å¤´å“¥å®ä¹ çš„ä¸€é¢ä¸­ï¼Œé¢è¯•å®˜é—®äº†æˆ‘è¾ƒå¤šè·¨å¤ä½åŸŸçš„é—®é¢˜ï¼Œä¸»è¦è¿˜æ˜¯è‡ªå·±åœ¨ç®€å†é‡ŒæŒ–äº†ä¸ªå‘ï¼ˆå°±ä¸è¯¥å†™è®¾è®¡å¤ä½ç½‘ç»œçš„TATï¼‰ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« å°±æ¥ç®€è¦ä»‹ç»ä¸€ä¸‹è·¨å¤ä½åŸŸä¸­å­˜åœ¨çš„ä¸€äº›é—®é¢˜åŠè§£å†³æ–¹æ³•ã€‚\n\n## å¼‚æ­¥å¤ä½å¯¼è‡´çš„äºšç¨³æ€\n\n### å¼‚æ­¥å¤ä½çš„é‡Šæ”¾\n\nå¤ä½å¦‚æœåœ¨æ—¶é’Ÿé‡‡æ ·æ²¿çš„å‰åçš„ä¸€ä¸ªæ—¶é—´çª—å£å†…é‡Šæ”¾çš„è¯ä¼šå¯¼è‡´è¾“å‡ºçš„Qç«¯å­˜åœ¨äºšç¨³æ€é—®é¢˜ï¼Œ**æœ¬è´¨ä¸Šä¹Ÿæ˜¯è§¦å‘å™¨å»ºç«‹æ—¶é—´å’Œä¿æŒæ—¶é—´çš„è¦æ±‚**ï¼Œå¯¹å¤ä½è€Œè¨€å°±æ˜¯Recovery Timeå’ŒRemoval Timeçš„è¦æ±‚ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232121969.png)\n\nä¸ºè§£å†³å¼‚æ­¥å¤ä½é‡Šæ”¾çš„äºšç¨³æ€é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¼‚æ­¥å¤ä½ï¼ŒåŒæ­¥é‡Šæ”¾çš„æ–¹å¼æ¥è§£å†³ã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232121355.png)\n\n### å¼‚æ­¥å¤ä½çš„ç½®ä½\n\nå¤ä½çš„ç½®ä½ä¹Ÿå¯èƒ½å¯¼è‡´äºšç¨³æ€é—®é¢˜ï¼Œä¸»è¦åœºæ™¯æ˜¯ç”µè·¯ä¸­æœ‰å¤šå¤ä½åŸŸï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹ä¸‹å›¾æ‰€ç¤ºåœºæ™¯ã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232121206.png)\n\ndff1å’Œdff2åˆ†åˆ«ä½¿ç”¨ä¸åŒçš„æ—¶é’Ÿå’Œå¤ä½ä¿¡å·ï¼Œdff1å…ˆå¤ä½ï¼Œä¹‹ådff2å†å¤ä½ã€‚å¯èƒ½å­˜åœ¨çš„é—®é¢˜æ˜¯arst1ç½®ä½æ—¶ï¼Œ**dff1çš„Qç«¯æ•°æ®ä»dataå‘Reset-valueè·³å˜æ—¶å¯èƒ½ä¸æ»¡è¶³dff2çš„å»ºç«‹/ä¿æŒæ—¶é—´è¦æ±‚**ï¼Œä»è€Œä½¿dff2çš„Qç«¯å‡ºç°äºšç¨³æ€ã€‚\n\nä»¥ä¸‹å…³äºæ—¶é’Ÿå¤ä½çš„5ç§æƒ…å½¢**éƒ½å¯èƒ½å¯¼è‡´äºšç¨³æ€**ï¼š\n\n1ã€clk1å’Œclk2æ˜¯ä¸€æ ·çš„/åŒæ­¥çš„ï¼›\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232121776.png)\n\n2ã€clk1å’Œclk2æ˜¯å¼‚æ­¥çš„ï¼›\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232122669.png)\n\n3/4ã€å¯¹arst1å’Œarst2å‡åšå¼‚æ­¥å¤ä½ï¼ŒåŒæ­¥é‡Šæ”¾æ“ä½œï¼›\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232122118.png)\n\n5ã€rst2åšåŒæ­¥å¤ä½ï¼›\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232122155.png)\n\n## å¦‚ä½•å®‰å…¨åœ°å¤„ç†è·¨å¤ä½åŸŸ\n\n### 1ã€å¯¹å¤ä½çš„é¡ºåºæå‡ºè¦æ±‚\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232122904.png)\n\narst2åœ¨arst1ä¹‹å‰ç½®ä½çš„è¯ï¼Œå°±ä¸å­˜åœ¨dff2çš„äºšç¨³æ€é—®é¢˜ï¼Œ**è¿™ç§å…ˆå¤ä½åçº§æ¨¡å—çš„ç­–ç•¥å¯ä»¥æœ‰æ•ˆé¿å…äºšç¨³æ€ã€‚**\n\n### 2ã€å¢åŠ æ•°æ®éš”ç¦»å•å…ƒ\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232122542.png)\n\nåœ¨dff1çš„arst1ç½®ä½å‰éš”ç¦»dff1çš„è¾“å‡ºï¼Œå°†è¾“å‡ºé’³ä½åˆ°0ï¼Œé¿å…arst1ç½®ä½æ—¶å¯¼è‡´dff2å‡ºç°äºšç¨³æ€ï¼›\n\n### 3ã€é€šè¿‡æ—¶é’Ÿé—¨æ§è¿›è¡Œæ•°æ®éš”ç¦»\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232122095.png)\n\nä¸æ•°æ®éš”ç¦»å•å…ƒçš„æ€æƒ³ç±»ä¼¼ï¼Œåªä¸è¿‡é€šè¿‡é—¨æ§dff2çš„æ–¹å¼æ¥å®Œæˆæ•°æ®éš”ç¦»ã€‚ï¼ˆ**é—¨æ§æ—¶é’Ÿä¹Ÿå¯ä»¥æœ‰æ•ˆè§£å†³å¼‚æ­¥å¤ä½çš„recoveryå’Œremoval timeçš„é—®é¢˜ï¼Œå¼‚æ­¥å¤ä½åå†å¼€æ—¶é’Ÿå°±ä¸ç”¨è€ƒè™‘ä¸Šè¿°timeçš„æ£€æŸ¥ã€‚**ï¼‰\n\n### 4ã€é€šè¿‡æ‰“æ‹é™ä½äºšç¨³æ€æ¦‚ç‡\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232122793.png)\n\né€šè¿‡å¢åŠ ä¸€ä¸ªdff3æ¥å‡å°‘äºšç¨³æ€å‘ç”Ÿçš„æ¦‚ç‡ã€‚\n\n## å°ç»“\n\nå®‰å…¨å¤„ç†è·¨å¤ä½åŸŸçš„åšæ³•ï¼š\n\n- **ä¾åº**å¯¹æ¨¡å—è¿›è¡Œå¤ä½ï¼Œ**åçº§æ¨¡å—å…ˆå¤ä½**ï¼›\n- é€šè¿‡**æ•°æ®éš”ç¦»å•å…ƒæˆ–é—¨æ§æ—¶é’Ÿ**è¿›è¡Œæ•°æ®éš”ç¦»ï¼Œé¿å…å‡ºç°äºšç¨³æ€ï¼›\n- åçº§æ¨¡å—é€šè¿‡**ä¸¤çº§åŒæ­¥å¯„å­˜å™¨**é™ä½äºšç¨³æ€å‘ç”Ÿçš„æ¦‚ç‡ï¼›\n\nå¹³å¤´å“¥ä¸€é¢ä¸­ï¼Œé¢è¯•å®˜æé—®æˆ‘ï¼ŒASICä¸­å¤ä½ç½‘ç»œçš„æ‰‡å‡ºå¾ˆå¤§ï¼Œå¾ˆéš¾ä¿è¯æ‰€æœ‰å¯„å­˜å™¨éƒ½æ»¡è¶³recoveryå’Œremoval timeçš„è¦æ±‚ï¼Œå¼‚æ­¥å¤ä½/åŒæ­¥é‡Šæ”¾çš„æ–¹å¼ä¹Ÿè§£å†³ä¸äº†è¯¥é—®é¢˜ï¼Œå› ä¸ºæœ‰Skewå­˜åœ¨ï¼Œé—®æ­¤æ—¶**å¦‚ä½•ä¿è¯æ­£å¸¸çš„å¼‚æ­¥å¤ä½åŠŸèƒ½ï¼Œä¸”ä¸ç”¨è€ƒè™‘recoveryå’Œremoval timeï¼Ÿ**\n\nå½“æ—¶é¢è¯•è¿‡ç¨‹ä¸­æ²¡ç­”å‡ºæ¥ï¼Œäºæ˜¯é—®äº†é¢è¯•å®˜ï¼Œé¢è¯•å®˜è¯´**å¼‚æ­¥å¤ä½å‰å…ˆæŠŠclockå…³äº†ï¼Œå¤ä½åå†å¼€clock**ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…è€ƒè™‘recoveryå’Œremoval timeï¼Œè¿™ä¸ªç­”æ¡ˆéœ‡æƒŠåˆ°æˆ‘äº†ï¼Œä½œä¸‹è®°å½•ï¼Œæ„Ÿè°¢å¹³å¤´å“¥çš„é¢è¯•å®˜ï¼\n\n## Reference\n\n[Reset Domain Crossing](https://www.youtube.com/watch?v=G_37fwOVnik)\n\n","tags":["interview"],"categories":["interview"]},{"title":"Questasimå®‰è£…ä¸ç ´è§£æ•™ç¨‹","url":"/2022/09/29/FPGA/Questasimå®‰è£…æ•™ç¨‹/","content":"\n# Questasimå®‰è£…ä¸ç ´è§£æ•™ç¨‹\n\n## å®‰è£…å‰æï¼š\n\nç³»ç»Ÿè¦æ±‚ï¼šWin10 64ä½\n\næ³¨æ„ï¼šå®‰è£…è·¯å¾„åŠä»¥åçš„é¡¹ç›®è·¯å¾„ã€æ–‡ä»¶è·¯å¾„ç­‰éƒ½ä¸è¦æœ‰ä¸­æ–‡å’Œç©ºæ ¼ã€‚\n\n## å®‰è£…ç ´è§£æ­¥éª¤ï¼š\n\n1. å…³é—­ç”µè„‘çš„æ€æ¯’è½¯ä»¶å’Œé˜²ç«å¢™ï¼ŒåŒå‡»å®‰è£…åŒ…ä¸­çš„`questasim-win64-10.6c.exe`è¿›è¡Œå®‰è£…ï¼Œæ¨èå®‰è£…ç›®å½•ï¼š`D:/questasim64_10.6c`ã€‚å®‰è£…å®Œæˆåä¸è¦æ‰“å¼€è½¯ä»¶å…ˆè¿›è¡Œç ´è§£ã€‚\n\n   ![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232055355.png)\n\n   ![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232055257.png)\n\n   ![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232055020.png)\n\n2. å¤åˆ¶å’Œæ­¤æ–‡æ¡£åŒä¸€å‹ç¼©åŒ…å†…çš„'patch_dll.bat' å’Œ'MentorKG.exe'å’Œ'license.dat'å’Œ'MakeLic.bat'ï¼ˆæ‰€æœ‰æ–‡ä»¶ï¼‰åˆ° <path_to_questasim_win64>æ–‡ä»¶å¤¹(å³å®‰è£…ç›®å½•é‡Œçš„win64æ–‡ä»¶å¤¹ï¼Œï¼ˆä¸¾ä¾‹ï¼šæœ¬äººå®‰è£…åœ¨`D:\\Program Files\\Questasim`ï¼Œæ‰€ä»¥å¤åˆ¶åˆ°æ–‡ä»¶å¤¹`D:\\Program Files\\Questasim\\win64`ï¼‰\n\n   ![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232055285.png)\n\n3. æ‰¾åˆ°å®‰è£…è·¯å¾„ä¸‹`win64/mgls64.dll` å»æ‰å…¶åªè¯»å±æ€§\n\n   ![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232055378.png)\n\n4. åŒå‡»è¿è¡Œå®‰è£…è·¯å¾„ä¸‹`win64/patch_dll.bat`ï¼ˆè¿™ä¸ªæ–‡ä»¶æ˜¯åˆšåˆšç”±å‹ç¼©åŒ…ä¸­å¤åˆ¶è¿‡æ¥çš„ï¼‰ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´ä¼šäº§ç”ŸLICENSE.TXTï¼Œä¿å­˜åˆ°å®‰è£…ç›®å½•é‡Œçš„win64æ–‡ä»¶å¤¹ï¼ˆæœ¬äººæ˜¯`D:\\Program Files\\Questasim\\win64`ï¼‰\n\n   ![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232055937.png)\n\n5. æ¥ä¸‹æ¥æ˜¯ä¿®æ”¹ç”¨æˆ·å˜é‡å’Œç³»ç»Ÿå˜é‡ï¼Œä¸åŒç³»ç»Ÿå¯èƒ½æ­¥éª¤ä¸ä¸€æ ·ï¼Œä½†ä¿®æ”¹çš„å†…å®¹éƒ½ä¸€æ ·\n\n   **ç”¨æˆ·å˜é‡**\n\n|      å˜é‡å       |                    å˜é‡å€¼                    |\n| :---------------: | :------------------------------------------: |\n|  LM_LICENSE_FILE  | D:\\Program Files\\Questasim\\win64\\license.dat |\n| MGLS_LICENSE_FILE | D:\\Program Files\\Questasim\\win64\\LICENSE.TXT |\n\nâ€‹\t**Pathä¸­æ–°å»ºä¸¤é¡¹**\n\n`D:\\Program Files\\Questasim\\win64`\n\n`D:\\Program Files\\Questasim\\win64\\LICENSE.TXT`\n\nâ€‹\t**ç³»ç»Ÿå˜é‡**\n\n|      å˜é‡å       |                    å˜é‡å€¼                    |\n| :---------------: | :------------------------------------------: |\n| MGLS_LICENSE_FILE | D:\\Program Files\\Questasim\\win64\\LICENSE.TXT |\n|  lm_license_file  | D:\\Program Files\\Questasim\\win64\\LICENSE.TXT |\n\næ­¥éª¤å›¾å¦‚ä¸‹æ‰€ç¤º\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232056666.png)\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232056831.png)\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232056685.png)\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232056957.png)\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232056079.png)\n\n![12](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232056514.png)\n\n![13](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232056480.png)\n\n![14](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232056522.png)\n\n6. å®Œæˆåæ‰“å¼€è½¯ä»¶ï¼Œå¦‚æœå®Œæˆæ­£ç¡®çš„é…ç½®åä¾æ—§æ— æ³•æ‰“å¼€å¯ä»¥é‡å¯è®¡ç®—æœºåæ‰“å¼€ã€‚","tags":["FPGA_Tools"],"categories":["FPGA","FPGA_Tools"]},{"title":"Vivadoä¸Modelsimè”åˆä»¿çœŸ","url":"/2022/09/29/FPGA/Vivadoä¸Modelsimè”åˆä»¿çœŸ/","content":"\n# Vivadoä¸Modelsimè”åˆä»¿çœŸ\n\nç¬”è€…åœ¨å­¦ä¹ FPGAè¿‡ç¨‹ä¸­é‡åˆ°äº†å¦‚ä½•ä½¿ç”¨Vivadoå’ŒModelsimè¿›è¡Œè”åˆä»¿çœŸçš„é—®é¢˜ï¼Œç‰¹æ­¤è®°å½•ã€‚\n\n## ç¡®å®šç‰ˆæœ¬\n\nç¬”è€…Vivadoç”¨çš„æ˜¯2018.3ç‰ˆæœ¬ï¼Œå…ˆæ˜¯éšä¾¿ä¸‹äº†ä¸ªModelsim10.1cçš„ç‰ˆæœ¬ï¼Œåˆ°ç¼–è¯‘åº“æ–‡ä»¶æ—¶æŠ¥é”™äº†ï¼Œåæ¥å‘ç°æ˜¯ä¿©æ¬¾è½¯ä»¶çš„ç‰ˆæœ¬ä¸åŒ¹é…ã€‚æ‰€ä»¥å¤§å®¶åœ¨è¿›è¡Œè”åˆä»¿çœŸä¹‹å‰å…ˆæ ¸å¯¹ä¸¤ä¸ªè½¯ä»¶çš„ç‰ˆæœ¬æ˜¯å¦å¯¹åº”ï¼Œä¸ç”¨åˆ°æœ€åå†å¸è½½é‡è£…ã€‚\n\n**Vivado Design Suite 2018.3**\n\nMentor Graphics ModelSim SE/DE/PE (10.6c)\nMentor Graphics Questa Advanced Simulator (10.6c)\nCadence Incisive Enterprise Simulator (IES) (15.20.053)\nCadence Xcelium Parallel Simulator (18.03.005)\nSynopsys VCS and VCS MX (N-2017.12-SP2)\nAldec Active-HDL (10.5) Aldec Riviera-PRO (2018.02)\n\n**Vivado Design Suite 2018.2**\n\nMentor Graphics ModelSim SE/DE/PE (10.6c)\nMentor Graphics Questa Advanced Simulator (10.6c)\nCadence Incisive Enterprise Simulator (IES) (15.20.042)\nCadence Xcelium Parallel Simulator (17.10.005)\nSynopsys VCS and VCS MX (N-2017.12)\nAldec Active-HDL (10.4a) Aldec Riviera-PRO (2017.10)\n\n**Vivado Design Suite 2018.1**\n\nMentor Graphics ModelSim SE/DE/PE (10.6c)\nMentor Graphics Questa Advanced Simulator (10.6c)\nCadence Incisive Enterprise Simulator (IES) (15.20.042)\nCadence Xcelium Parallel Simulator (17.10.005)\nSynopsys VCS and VCS MX (N-2017.12)\nAldec Active-HDL (10.4a) Aldec Riviera-PRO (2017.10)\n\n**Vivado Design Suite 2017.4**\n\nMentor Graphics ModelSim SE/DE/PE (10.6b)\nMentor Graphics Questa Advanced Simulator (10.6b)\nCadence Incisive Enterprise Simulator (IES) (15.20.028)\nSynopsys VCS and VCS MX (M-2017.03-SP1)\nAldec Active-HDL (10.4a) Aldec Riviera-PRO (2017.02)\n\n**Vivado Design Suite 2017.3**\n\nMentor Graphics ModelSim SE/DE/PE (10.6b)\nMentor Graphics Questa Advanced Simulator (10.6b)\nCadence Incisive Enterprise Simulator (IES) (15.20.028)\nSynopsys VCS and VCS MX (M-2017.03-SP1)\nAldec Active-HDL (10.4a) Aldec Riviera-PRO (2017.02)\n\n**Vivado Design Suite 2017.2**\n\nMentor Graphics ModelSim SE/DE/PE (10.5c)\nMentor Graphics Questa Advanced Simulator (10.5c)\nCadence Incisive Enterprise Simulator (IES) (15.20.014)\nSynopsys VCS and VCS MX (L-2016.06-SP1)\nAldec Active-HDL (10.4) Aldec Riviera-PRO (2016.10)\n\n**Vivado Design Suite 2017.1**\n\nMentor Graphics ModelSim SE/DE/PE (10.5c)\nMentor Graphics Questa Advanced Simulator (10.5c)\nCadence Incisive Enterprise Simulator (IES) (15.20.014)\nSynopsys VCS and VCS MX (L-2016.06-SP1)\nAldec Active-HDL (10.4) Aldec Riviera-PRO (2016.10)\n\n**Vivado Design Suite 2016.4**\n\nMentor Graphics ModelSim SE/DE/PE (10.5c)\nMentor Graphics Questa Advanced Simulator (10.5c)\nCadence Incisive Enterprise Simulator (IES) (15.20.005)\nSynopsys VCS and VCS MX (L-2016.06)\nAldec Active-HDL (10.3) Aldec Riviera-PRO (2016.06)\n\n**Vivado Design Suite 2016.3**\n\nMentor Graphics ModelSim SE/DE/PE (10.5c)\nMentor Graphics Questa Advanced Simulator (10.5c)\nCadence Incisive Enterprise Simulator (IES) (15.20.005)\nSynopsys VCS and VCS MX (L-2016.06)\nAldec Active-HDL (10.3) Aldec Riviera-PRO (2016.06)\n\nVivado Design Suite 2016.2, 2016.1\n\nMentor Graphics ModelSim SE/DE/PE (10.4d)\nMentor Graphics Questa Advanced Simulator (10.4d)\nCadence Incisive Enterprise Simulator (IES) (15.10.013)\nSynopsys VCS and VCS MX (K-2015.09)\nAldec Active-HDL (10.3) Aldec Riviera-PRO (2015.10)\n\n**Vivado Design Suite 2015.4, 2015.3**\n\nMentor Graphics ModelSim SE/DE/PE (10.4b)\nMentor Graphics Questa Advanced Simulator (10.4b)\nCadence Incisive Enterprise Simulator (IES) (14.20.006)\nSynopsys VCS and VCS MX (J-2014.12-SP2)\nAldec Active-HDL (10.2 SP2) Aldec Riviera-PRO (2015.06)\n\n**Vivado Design Suite 2015.2, 2015.1**\n\nMentor Graphics ModelSim SE/DE/PE (10.3d)\nMentor Graphics Questa Advanced Simulator (10.3d)\nCadence Incisive Enterprise Simulator (IES) (14.10.011)\nSynopsys VCS and VCS MX (I-2014.03-SP1)\nAldec Active-HDL (10.1 SP1) Aldec Riviera-PRO (2015.02)\n\n**Vivado Design Suite 2014.4**\n\nMentor Graphics ModelSim SE/DE/PE (10.3b)\nMentor Graphics Questa Advanced Simulator (10.3b)\nCadence Incisive Enterprise Simulator (IES) (13.20.005)\nSynopsys VCS and VCS MX (I-2014.03)\nAldec Active-HDL (9.3 SP1) Aldec Riviera-PRO (2014.02)\n\n**Vivado Design Suite 2014.3**\n\nMentor Graphics ModelSim SE/DE/PE (10.3b)\nMentor Graphics Questa Advanced Simulator (10.3b)\nCadence Incisive Enterprise Simulator (IES) (13.20.005)\nSynopsys VCS and VCS MX (I-2014.03)\nAldec Active-HDL (9.2 SP1) Aldec Riviera-PRO (2014.02)\n\n**Vivado Design Suite 2014.2, 2014.1**\n\nMentor Graphics ModelSim SE/DE/PE (10.2a)\nMentor Graphics Questa Advanced Simulator (10.2a)\nCadence Incisive Enterprise Simulator (IES) (12.2-016)\nSynopsys VCS and VCS MX (H-2013.06-SP1)\nAldec Active-HDL (9.3 SP1) Aldec Riviera-PRO (2014.02)\n\n**Vivado Design Suite 2013.4**\n\nMentor Graphics ModelSim SE/DE/PE (10.2a)\nMentor Graphics Questa Advanced Simulator (10.2a)\nCadence Incisive Enterprise Simulator (IES) (12.2-016)\nSynopsys VCS and VCS MX (H-2013.06)\nAldec Active-HDL (9.2 SP1) Aldec Riviera-PRO (2013.06)\n\n**Vivado Design Suite 2013.3**\n\nMentor Graphics ModelSim SE/DE/PE (10.2a)\nMentor Graphics Questa Advanced Simulator (10.2a)\nCadence Incisive Enterprise Simulator (IES) (12.2-016)\nSynopsys VCS and VCS MX (H-2013.06-3)\nAldec Active-HDL (9.2) Aldec Riviera-PRO (2013.02)\n\n**Vivado Design Suite 2013.1, 2013.2**\n\nMentor Graphics ModelSim SE/DE/PE (10.1b)\nMentor Graphics Questa Advanced Simulator (10.1b)\nCadence Incisive Enterprise Simulator (IES) (12.2)\nSynopsys VCS and VCS MX (G-2012.09)\nAldec Active-HDL (9.2) Aldec Riviera-PRO (2012.10)\n\n[reference](https://www.xilinx.com/support/answers/68324.html)\n\nç¬”è€…ç”¨çš„æ˜¯Vivado2018.3ï¼ŒæŸ¥è¯¢çš„å¯¹åº”çš„Modelsimç‰ˆæœ¬ä¸º10.6cã€‚\n\n------\n\n## Modelsimç ´è§£\n\nå‡†å¤‡Modelsim10.6cçš„å®‰è£…åŒ…\n\n[ä¸‹è½½é“¾æ¥](https://download.csdn.net/download/qq_42334072/13087931)\n\næ­¥éª¤å¦‚ä¸‹ï¼š\n\n(1)ã€å®‰è£…è½¯ä»¶ï¼Œ**æ³¨æ„å®‰è£…è·¯å¾„ä¸­ä¸è¦å‡ºç°ä¸­æ–‡æˆ–ç©ºæ ¼**ï¼Œå®‰è£…è¿‡ç¨‹ä¸­ä¸€ç›´ç‚¹å‡»YESå³å¯ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232102490.png)\n\n(2)ã€æŠŠ`crack.bat`ã€`MentorKG.exe`ä¸€èµ·æ‹·è´åˆ°modelsimå®‰è£…ç›®å½•çš„win64æ–‡ä»¶å¤¹ä¸‹ï¼Œä¾‹å¦‚`D:\\modelsim_dlx64_10.6c\\win64pe`\n\n(3)ã€åŒå‡»`crack.bat`ï¼Œè‹¥å‡ºç°ä¸‹å›¾æ‰€ç¤ºé—®é¢˜ï¼Œåˆ™å°†`mgls64.dll`é‡å‘½åä¸º`mgls.dll`å†æ¬¡é‡æ–°è¿è¡Œ`crack.bat`å³å¯ã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232102020.png)\n\n(4)ã€å°†ç”Ÿæˆçš„`LICENSE.TXT`æ”¾åœ¨modelsimçš„å®‰è£…è·¯å¾„ä¸‹ï¼Œå¦‚`D:\\modelsim_dlx64_10.6c`ï¼Œè‹¥å‰é¢ä¿®æ”¹äº†mgls64.dllæ–‡ä»¶çš„åç§°ï¼Œåˆ™ç”Ÿæˆå®ŒLICENSEæ–‡ä»¶ååº”å½“æŠŠåå­—æ”¹å›å»ã€‚\n\n(5)ã€æ–°å»ºç¯å¢ƒå˜é‡`MGLS_LICENSE_FILE`ï¼Œå˜é‡å€¼ä¸ºLICENSEæ”¾ç½®çš„è·¯å¾„ï¼Œå¦‚`D:\\modelsim_dlx64_10.6c\\LICENSE.TXT`ã€‚åœ¨win10ä¸­ï¼Œå³é”®æ­¤ç”µè„‘->å±æ€§->é«˜çº§ç³»ç»Ÿè®¾ç½®->ç¯å¢ƒå˜é‡ï¼Œè¿›è¡Œç¯å¢ƒå˜é‡çš„æ·»åŠ ã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232102492.png)\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232102352.png)\n\n(6)ã€æ‰“å¼€Modelsimè½¯ä»¶ï¼Œå®‰è£…ç ´è§£ç»“æŸã€‚\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232102973.png)\n\n------\n\n## è”åˆä»¿çœŸ\n\n(1)ã€æ‰“å¼€ä»»æ„ä¸€ä¸ªvivadoå·¥ç¨‹ï¼Œå†æŒ‰ä¸‹å›¾æ‰€ç¤ºç‚¹å‡»ç¼–è¯‘Xilinxçš„ä»¿çœŸåº“ã€‚\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232103139.png)\n\næ³¨æ„ï¼šSimulatoré€‰Modelsim Simulatorï¼Œç¼–è¯‘åº“Compiled library locationæ”¾å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹`D:\\Xilinx\\Xlib`ä¸­(å¯è‡ªå·±æŒ‡å®š)ï¼ŒSimulator executable pathé€‰æ‹©modelsimå®‰è£…è·¯å¾„ä¸‹çš„win64peã€‚æ³¨æ„Compile Xilinx IPé€‰é¡¹ä¸å‹¾é€‰ã€‚\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232103436.png)\n\nç¼–è¯‘ç»“æœä»Vivadoä¸­çš„Tcl Consoleä¸­å¯çŸ¥ï¼Œæ— Errorsï¼ŒèŠœæ¹–èµ·é£ï¼\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232103881.png)\n\n(2)æŸ¥çœ‹ç¼–è¯‘åº“Compiled library locationè·¯å¾„ä¸‹ï¼Œåº”è¯¥å‡ºç°`modelsim.ini`æ–‡ä»¶ã€‚\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232103243.png)\n\næˆ‘ä»¬å°†å…¶è®¾ç½®ä¸ºç”¨æˆ·çš„å…¨å±€å˜é‡ï¼Œè¿™æ ·ä¸‹æ¬¡å°±ä¸éœ€è¦å†ç¼–è¯‘åº“æ–‡ä»¶äº†ï¼Œæ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232103520.png)\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232103420.png)\n\n(3)ã€è®¾ç½®ç¬¬ä¸‰æ–¹ä»¿çœŸè½¯ä»¶çš„å®‰è£…è·¯å¾„ä¸ç¼–è¯‘åº“çš„è·¯å¾„ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤º\n\n![12](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232103143.png)\n\n![13](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232104566.png)\n\n![14](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232104304.png)\n\n(4)ã€å…¨éƒ¨å‡†å¤‡å°±ç»ªåï¼Œç‚¹å‡»Run Simulationä¸­çš„Run Behavioral Simulationã€‚\n\n![15](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232104184.png)\n\nè‡ªåŠ¨å¼¹å‡ºModelsimï¼Œå¹¶æ˜¾ç¤ºæ³¢å½¢ï¼Œæ¸¸æˆç»“æŸã€‚\n\n![16](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232104385.png)\n\n","tags":["FPGA_Tools"],"categories":["FPGA","FPGA_Tools"]},{"title":"Vivadoä¸­RTLå°è£…IPæµç¨‹","url":"/2022/09/29/FPGA/Vivadoä¸­RTLå°è£…IPæµç¨‹/","content":"\n# Vivadoä¸­RTLå°è£…IPæµç¨‹\n\n## å‰è¨€\n\næœ¬æ–‡è®°å½•è‡ªå·±å°†RTLä»£ç å°è£…æˆIPçš„æµç¨‹ï¼Œä»¥ä¾›ä¹‹åæŸ¥é˜…ä½¿ç”¨ã€‚æœ€è¿‘ä¸€ä¸ªæœˆåœ¨åšä¸€ä¸ªæ•°æ®ä»²è£ä¸è½¬å‘çš„é¡¹ç›®ï¼Œå·²ç»å®ŒæˆåŠŸèƒ½ä»¿çœŸï¼Œå‡†å¤‡å°†å…¶å°è£…æˆIPåœ¨Block Designä¸­è¿›è¡Œè°ƒç”¨ã€‚å®éªŒå¹³å°ä¸ºVivado 2018.3ï¼Œç¼–ç¨‹è¯­è¨€ä¸ºVerilogï¼ŒIPçš„æ¥å£ä¸»è¦æ˜¯ä¸€ä¸ªAXI-Liteæ¥å£å’Œä¸€ä¸ªAXI-Fullæ¥å£ã€‚é—²è¨€å°‘å™ï¼Œæˆ‘ä»¬ç›´æ¥å¼€å§‹ã€‚\n\n## è¯¦ç»†æµç¨‹\n\n### å‡†å¤‡å·¥ä½œ\n\næ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹`ip_test`ï¼Œåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹æ–°å»ºæ–‡ä»¶å¤¹`rtl`ï¼Œå°†æ‰€æœ‰RTLæºç æ”¾å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå®Œæˆå‡†å¤‡å·¥ä½œï¼›\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232113260.png)\n\næ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹`top_module`ï¼Œé‡Œé¢ä»…å­˜æ”¾RTLæºç çš„æœ€é¡¶å±‚çš„.væ–‡ä»¶ï¼Œä¾¿äºIPç”Ÿæˆæ­£ç¡®çš„æ¥å£ã€‚(**ä¹‹å‰å°è¯•å°†æ‰€æœ‰çš„RTLæºç ä¸€æ¬¡å¯¼å…¥ï¼Œå‘ç°vivadoä¸èƒ½æ­£ç¡®è¯†åˆ«é¡¶å±‚æ¨¡å—ï¼Œä»è€Œå¯¼è‡´IPæ¥å£ä¸€ç›´ä¸å¯¹**)\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232113923.png)\n\n### åˆ›å»ºå·¥ç¨‹\n\nåŒå‡»æ‰“å¼€vivado 2018.3ï¼Œé€‰æ‹©`Tasks->Manage IP->New IP Location`,æŒ‰ä¸‹å›¾æ‰€ç¤ºé¡ºåºè¿›è¡Œæ“ä½œï¼›\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232114706.png)\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232114156.png)\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232114661.png)\n\nä¸Šå›¾ä¸­çš„`IP location`é€‰æ‹©ä¹‹å‰å»ºç«‹çš„`ip_test`æ–‡ä»¶å¤¹è·¯å¾„ï¼Œé€‰å®Œåç‚¹å‡»`Finish`å®Œæˆå·¥ç¨‹çš„åˆ›å»ºï¼›\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232114039.png)\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232114564.png)\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232114217.png)\n\nå› ä¸ºæœ¬é¡¹ç›®å·²æœ‰RTLæºç ï¼Œæ‰€ä»¥ä¸Šå›¾ä¸­æˆ‘ä»¬é€‰`Package a specified directory`ï¼›å¦‚æœæ²¡æœ‰æºç æƒ³åˆ›å»ºä¸€ä¸ªå¸¦AXIæ¥å£çš„ç©ºIPå¾€é‡Œå†™åŠŸèƒ½çš„è¯å°±é€‰æ‹©`Create a new AXI4 Peripheral`ï¼›\n\næ­¤å¤„ä¸€å®šæ³¨æ„ä¸‹å›¾ä¸­çš„è·¯å¾„ï¼Œé€‰æ‹©**RTLé¡¶å±‚æ¨¡å—æºç **çš„è·¯å¾„\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232114671.png)\n\næŒ‡å®šé¡¹ç›®çš„åç§°ï¼Œæœ¬ç¤ºä¾‹å·¥ç¨‹åå­—ä¸º`ip_test`;\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232115430.png)\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232115659.png)\n\nç‚¹å‡»`Finish`åæˆ‘ä»¬çœ‹åˆ°å°è£…IPçš„ç•Œé¢ï¼Œæ­¤æ—¶çœ‹åˆ°IPçš„åç§°ä¸é¡¶å±‚æ¨¡å—ç›¸åŒï¼Œä¸”æ¥å£ä¹Ÿä¸é¡¶å±‚æ¨¡å—çš„ä¸€è‡´ï¼Œåªæ˜¯æ­¤æ—¶é™¤äº†é¡¶å±‚æ¨¡å—å¤–ï¼Œå…¶ä½™æ¨¡å—å‡æœªæ·»åŠ åˆ°`Design Sources`ä¸­ã€‚\n\n![12](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232115723.png)\n\n![13](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232115661.png)\n\nä¸‹é¢è¿›è¡Œå‰©ä½™æºç çš„æ·»åŠ ï¼Œå°†`rtl`æ–‡ä»¶å¤¹ä¸­çš„ä»£ç æ·»åŠ åˆ°`Design Sources`ä¸­ã€‚\n\n![14](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232115747.png)\n\n![15](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232115898.png)\n\n![16](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232116980.png)\n\n![17](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232116444.png)\n\né€‰æ‹©IPå°è£…æ¨¡å—çš„`File Groups`é€‰é¡¹ï¼Œç‚¹å‡»`Merge changes from File Groups Wizard`\n\n![18](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232116407.png)\n\nå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„IPå·²ç»åŒ…å«äº†æ‰€æœ‰çš„æºç ï¼›\n\n![19](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232116420.png)\n\n### å±æ€§é…ç½®\n\n![20](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232116796.png)\n\nåœ¨`Ports and Interfaces`ç•Œé¢ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œvivadoå·¥å…·è‡ªåŠ¨å°†æ—¶é’Ÿå¤ä½ä¿¡å·ã€AXI-Fullä¿¡å·å’ŒAXI-Liteä¿¡å·è¿›è¡Œæ‰“åŒ…å¤„ç†(*vivadoæ°¸è¿œçš„ç¥ï¼*)ï¼Œä½†è¿˜æœ‰ä¸€äº›å±æ€§éœ€è¦è®¾ç½®ï¼Œå¦åˆ™vivadoä¼šæŠ¥warningã€‚å¦‚å¤ä½ä¿¡å·çš„ä½ç”µå¹³å¤ä½å±æ€§ã€æ—¶é’Ÿä¸AXIåè®®çš„ç›¸å…³å±æ€§ç­‰ï¼›\n\næ·»åŠ å¤ä½ä¿¡å·çš„ä½ç”µå¹³å¤ä½å±æ€§æµç¨‹å¦‚ä¸‹ï¼š\n\n![21](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232116809.png)\n\n![22](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232116268.png)\n\n![23](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232117310.png)\n\nå°†`clk`æ—¶é’Ÿä¸`rst_clk_n`ç»‘å®šèµ·æ¥ï¼Œå¹¶æŒ‡å®šAXI-Liteæ¥å£ç”¨`clk`æ—¶é’Ÿ\n\n![24](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232117443.png)\n\n![25](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232117514.png)\n\nå…·ä½“å„å‚æ•°çš„å±æ€§é…ç½®æƒ…å†µå¤§å®¶å¯ä»¥å‚è€ƒ**vivadoå®˜æ–¹æ•™ç¨‹ug1118**ã€‚å®Œæˆä¸Šé¢æ—¶é’Ÿæˆ–è€…å¤ä½çš„ç»‘å®šé…ç½®åï¼Œæœ€åè¿›è¡ŒIPæ ¸çš„å¯¼å‡ºã€‚\n\n### å¯¼å‡ºIP\n\nåœ¨å°è£…IPç•Œé¢é€‰æ‹©`Review and Package`ï¼Œå…ˆè¿›è¡Œæ‰“åŒ…IPçš„é…ç½®ï¼Œç‚¹å‡»`Edit packaging settings`ï¼›\n\n![26](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232117071.png)\n\nè¿›è¡Œä¸Šå›¾æ‰€ç¤ºçš„é…ç½®ï¼Œå…¶ä¸­`Delete project after packaging`é€‰é¡¹å¯ä»¥ä¸é€‰ï¼Œå› ä¸ºå¯¼å‡ºIPå¯èƒ½ä¹‹åè¿˜è¦ç»§ç»­ï¼Œè¦å¯¹RTLä»£ç è¿›è¡Œä¿®æ”¹ä¸Šæ¿æµ‹è¯•æ¥è¿­ä»£æ›´æ–°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ä¿ç•™å¯¼å‡ºIPçš„é¡¹ç›®å·¥ç¨‹ã€‚\n\n![27](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232117492.png)\n\næœ€åå›åˆ°å°è£…IPçš„ç•Œé¢ï¼Œç‚¹å‡»`Package IP`é€‰é¡¹å³å¯ã€‚\n\n![28](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232117377.png)\n\nå·²ç»æˆåŠŸæ‰“åŒ…ï¼Œè¯¢é—®æ˜¯å¦å…³é—­é¡¹ç›®å·¥ç¨‹ï¼Œ`Yes`æˆ–è€…`No`å‡å¯ã€‚\n\n![29](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232118766.png)\n\nåˆ°æŒ‡å®šçš„è·¯å¾„ä¸‹æŸ¥çœ‹ï¼Œå‘ç°å·²ç»ç”Ÿæˆæˆ‘ä»¬æ‰€éœ€çš„IPã€‚è‡³æ­¤ï¼Œå°è£…IPåœ†æ»¡ç»“æŸã€‚\n\n![30](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232118967.png)\n\n## ç»“è¯­\n\næœ¬æ–‡ä¸ºç¬”è€…æ‰“åŒ…IPçš„ç»éªŒåˆ†äº«å¸–ï¼Œå…¶ä¸­ä¸å…é”™è¯¯ä¸è¶³ä¹‹å¤„ï¼Œå¦‚æœå…¶ä¸­æ­¥éª¤æœ‰è¯¯è¿˜æœ›å¤§å®¶æŒ‡æ­£å‡ºæ¥ï¼Œä¸€èµ·äº¤æµè¿›æ­¥ã€‚\n\n## å‚è€ƒèµ„æ–™\n\n[Vivado Design Suite User Guide: Creating and Packaging Custom IP (UG1118)](https://www.xilinx.com/support/documentation/sw_manuals/xilinx2017_2/ug1118-vivado-creating-packaging-custom-ip.pdf)","tags":["FPGA_Tools"],"categories":["FPGA","FPGA_Tools"]},{"title":"NVDLAé˜…è¯»ç¬”è®°","url":"/2022/09/29/Proj/NVDLAé˜…è¯»ç¬”è®°/","content":"\n# NVDLAé˜…è¯»ç¬”è®°\n\n## Unit Description\n\n### System Architecture\n\nNVDLAä½œä¸ºæ·±åº¦å­¦ä¹ åŠ é€Ÿå™¨å¯ä»¥é›†æˆåœ¨SoCä¸­ä½œä¸ºä¸€ä¸ªåå¤„ç†å™¨ï¼›\n\nNVDLAæœ‰è®¸å¤šæ•°æ®å¤„ç†Engineï¼Œå„Engineéƒ½æ˜¯ç‹¬ç«‹çš„ä¸”å¯ä»¥è‡ªç”±é…ç½®ï¼Œæ¯”å¦‚ä¸éœ€è¦æ± åŒ–çš„ç½‘ç»œå¯ä»¥ç§»é™¤Planar Data Processorï¼Œå„Engineçš„è°ƒåº¦æ“ä½œå¯ä»¥å§”æ‰˜ç»™Microcontrolleræˆ–è€…CPUï¼›å…¶ä¸­ç”¨Microcontrolleræ¥è°ƒåº¦çš„æ–¹å¼ç§°ä¸ºâ€œheadedâ€ implementationï¼Œç”¨CPUæ¥è°ƒåº¦çš„æ–¹å¼ç§°ä¸ºâ€œheadlessâ€ implementationï¼›\n\nå›¾ä¸­å·¦è¾¹çš„æ¡†å›¾å±•ç¤ºäº†â€œheadlessâ€ implementationçš„ç¤ºä¾‹ï¼Œæ˜¯ä¸€ä¸ªå°å‹çš„NVDLAç³»ç»Ÿï¼Œæˆæœ¬è¾ƒä½ï¼›å³è¾¹çš„æ¡†å›¾å±•ç¤ºäº†â€œheadedâ€ implementationçš„ç¤ºä¾‹ï¼Œæ˜¯ä¸€ä¸ªå¤§å‹çš„NVDLAç³»ç»Ÿï¼Œä¸»è¦æ˜¯æ·»åŠ äº†Microcontrollerå’Œé«˜å¸¦å®½çš„SRAMï¼Œé€‚åˆäºé«˜æ€§èƒ½çš„ç‰©è”ç½‘è®¾å¤‡ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232141331.png)\n\nNVDLAä¸»è¦æœ‰4ä¸ªæ¥å£ï¼Œå…¶ä¸­SRAMIFæ˜¯å¯é€‰é¡¹ï¼›\n\n- CSBï¼ˆConfiguration Space Busï¼‰ï¼šè¿™ä¸ªæ¥å£æ˜¯ä¸€ä¸ªåŒæ­¥ã€ä½å¸¦å®½ã€ä½åŠŸè€—çš„32ä½æ§åˆ¶æ€»çº¿ï¼Œä¸»è¦ç”¨æ¥è®¿é—®NVDLAçš„é…ç½®å¯„å­˜å™¨ï¼›\n- IRQï¼ˆInterrupt Requestï¼‰ï¼šå½“NVDLAä¸­çš„ä»»åŠ¡å®Œæˆæˆ–è€…å‘ç”Ÿé”™è¯¯æ—¶ä¼šå°†ä¸­æ–­çº¿è¿›è¡Œç½®ä½ï¼›\n- DBBï¼ˆData Backbone Interfaceï¼‰ï¼šDBBæ¥å£è¿æ¥NVDLAå’Œç‰‡å¤–çš„DRAMï¼Œä¸AXIæ¥å£ç±»ä¼¼ï¼Œæ˜¯é«˜é€Ÿã€é«˜åº¦å¯é…ç½®çš„æ•°æ®æ€»çº¿ï¼Œå¯ä»¥æ ¹æ®ç³»ç»Ÿçš„è¦æ±‚å‘å‡ºä¸åŒå¤§å°çš„è¯»å†™è¯·æ±‚ï¼›\n- SRAMIFï¼ˆSRAM Interfaceï¼‰ï¼šDBBæ¥å£è¿˜æœ‰ä¸€ä¸ªå¯é€‰çš„æ¥å£ï¼Œåœ¨è®¾è®¡ä¸Šä¸DBBæ¥å£ç›¸åŒï¼Œç›®çš„åœ¨äºç»“åˆç‰‡ä¸Šçš„SRAMæ¥æä¾›æ›´é«˜çš„æ•°æ®ååé‡ä»¥åŠæ›´ä½çš„è®¿é—®å»¶è¿Ÿï¼›\n\n### DLA Core Architecture\n\nDLAçš„ç»“æ„æ¡†å›¾å¦‚å›¾æ‰€ç¤ºï¼›å†…éƒ¨ä¸»è¦æœ‰ä¸¤ä¸ªæ¥å£æ¨¡å—ï¼Œå…¶ä¸­Configuration Interfaceç”¨äºè®¿é—®NVDLAçš„é…ç½®å¯„å­˜å™¨ï¼ŒMemory Interfaceç”¨äºè¯»å†™ç‰¹å¾æ•°æ®ã€æƒé‡ã€åƒç´ æ•°æ®ç­‰ï¼›\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232141690.png)\n\nConvolution bufferä¸»è¦ç”¨äºç¼“å­˜åƒç´ æ•°æ®ã€ç‰¹å¾æ•°æ®ã€æƒé‡æ•°æ®ç­‰ï¼Œä¾›å·ç§¯æ ¸ä¸­çš„å·ç§¯åºåˆ—æ§åˆ¶å™¨æ¨¡å—è¯»å–ï¼›Convolution coreä¸»è¦å®Œæˆå·ç§¯ä¸­çš„ä¹˜åŠ è¿ç®—ï¼›SDPä¸»è¦è´Ÿè´£å¯¹å•ä¸ªæ•°æ®æ‰§è¡Œåå¤„ç†æ“ä½œï¼ŒåŒ…æ‹¬biasåŠ æ³•ã€ReLUã€Sigmoidã€åŒæ›²æ­£åˆ‡ã€BNã€é€å…ƒç´ æ“ä½œç­‰ï¼›PDPæ˜¯å¹³é¢æ•°æ®å¤„ç†å™¨ï¼Œä¸»è¦å®Œæˆæ± åŒ–ç›¸å…³çš„æ“ä½œï¼›CDPä¸»è¦åœ¨é€šé“æ–¹å‘ä¸Šæ‰§è¡Œæ“ä½œï¼Œæ—¨åœ¨è§£å†³å±€éƒ¨å“åº”å½’ä¸€åŒ–å±‚ï¼›RUBIKæ¨¡å—çš„åŠŸèƒ½ä¸BDMAç±»ä¼¼ï¼Œå®ƒåœ¨ä¸è¿›è¡Œä»»ä½•æ•°æ®è®¡ç®—çš„æƒ…å†µä¸‹è½¬æ¢æ•°æ®çš„æ˜ å°„æ ¼å¼ï¼Œå› ä¸ºå®ƒçš„åŠŸèƒ½æ˜¯å˜æ¢ç‰¹å¾æ•°æ®ç«‹æ–¹ä½“çš„å°ºå¯¸ï¼Œæ‰€ä»¥åˆè¢«ç§°ä¸ºé­”æ–¹å•å…ƒï¼›BDMAæ¨¡å—åœ¨å¤–éƒ¨DRAMå’Œç‰‡ä¸ŠSRAMä¹‹é—´æä¾›äº†ä¸€æ¡ç§»åŠ¨æ•°æ®çš„é€šé“ï¼Œå®ƒæœ‰ä¸¤æ¡ç‹¬ç«‹çš„è·¯å¾„ï¼Œä¸€æ¡æ˜¯å°†æ•°æ®ä»å¤–éƒ¨DRAMå¤åˆ¶/ç§»åŠ¨åˆ°å†…éƒ¨SRAMï¼Œå¦ä¸€æ¡æ˜¯å°†æ•°æ®ä»å†…éƒ¨SRAMå¤åˆ¶/ç§»åŠ¨åˆ°å¤–éƒ¨DRAMï¼Œä¸¤æ¡è·¯å¾„ä¸èƒ½åŒæ—¶å·¥ä½œï¼›\n\nNVDLAæœ‰ä¸¤ç§å·¥ä½œæ¨¡å¼ï¼Œç‹¬ç«‹æ¨¡å¼ï¼ˆIndependent Modeï¼‰å’Œç»“åˆæ¨¡å¼ï¼ˆFused Modeï¼‰ã€‚ç‹¬ç«‹æ¨¡å¼ä¸‹ï¼Œå„Engineåˆ†åˆ«é€šè¿‡ä¸¤ç»„æ•°æ®æ¥å£å®Œæˆå„è‡ªåˆ†é…çš„ä»»åŠ¡ï¼›ç»“åˆæ¨¡å¼å¯ä»¥å°†Convolution Coreã€SDPå’ŒPDPè¿æ¥åœ¨ä¸€èµ·ä½œä¸ºä¸€ä¸ªæ•´ä½“æµæ°´çº¿å®Œæˆåˆ†é…çš„ä»»åŠ¡ï¼›\n\n### Convolution Pipeline\n\næµæ°´çº¿å·ç§¯æ¨¡å—æ˜¯NVDLAçš„æ ¸å¿ƒé€»è¾‘ï¼Œç”¨äºåŠ é€Ÿå·ç§¯ç®—æ³•ï¼ŒåŒæ—¶åœ¨å·ç§¯æµæ°´çº¿ä¸­å¼•å…¥äº†Winogradç®—æ³•å’ŒMulti-batchï¼Œæé«˜MACæ•ˆç‡ã€‚Convolution Pipelineæœ‰äº”ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯Convolution DMAã€Convolution Bufferã€Convolution Sequence Controllerã€Convolution MACå’ŒConvolution Accumulatorï¼Œå„é˜¶æ®µéƒ½æœ‰è‡ªå·±çš„CSBæ¥æ¥æ”¶æ¥è‡ªCPUçš„é…ç½®æ•°æ®ã€‚CDMAä»SRAM/DRAMä¸­è·å–æ•°æ®æ¥è¿›è¡Œå·ç§¯æ“ä½œï¼Œå¹¶æŒ‰å·ç§¯Engineæ‰€éœ€çš„æ•°æ®é¡ºåºå­˜å‚¨åˆ°CBUFä¸­ï¼›CBUFç¼“å­˜æ¥è‡ªCDMAæ¨¡å—çš„åƒç´ ã€ç‰¹å¾å’Œæƒé‡ç­‰æ•°æ®ï¼Œç”±CSCæ¨¡å—è¿›è¡Œè¯»å–ï¼›CSCæ¨¡å—è´Ÿè´£ä»CBUFåŠ è½½æ•°æ®å¹¶å‘é€åˆ°CMACå•å…ƒï¼Œå®ƒæ˜¯å·ç§¯åºåˆ—æ§åˆ¶çš„å…³é”®æ¨¡å—ï¼›CMACæ¨¡å—ä»CSCæ¥æ”¶è¾“å…¥æ•°æ®å’Œæƒé‡ï¼Œæ‰§è¡Œä¹˜æ³•å’ŒåŠ æ³•è¿ç®—ï¼Œå¹¶å°†ç»“æœè¾“å‡ºç»™CACCï¼›CACCæ¨¡å—ç”¨äºå¯¹CMACæ¨¡å—çš„éƒ¨åˆ†å’Œè¿›è¡Œç´¯åŠ ï¼Œå¹¶åœ¨å‘é€ç»™SDPæ¨¡å—å‰å¯¹æ•°æ®è¿›è¡Œèˆå…¥æ“ä½œã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232141311.png)\n\n### CDMA\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232141023.png)\n\nCDMAä¸»è¦è´Ÿè´£ä»SRAM/DRAMä¸­è·å–æ•°æ®æ¥è¿›è¡Œå·ç§¯æ“ä½œï¼Œè¯»å–çš„æ•°æ®ä¸»è¦æœ‰ä»¥ä¸‹æ•°æ®ç±»å‹ï¼š\n\n- åƒç´ æ•°æ®ï¼ˆPixel Dataï¼‰\n- ç‰¹å¾æ•°æ®ï¼ˆFeature Dataï¼‰\n- æœªå‹ç¼©/å‹ç¼©æƒé‡æ•°æ®ï¼ˆUncompressed/compressed weightï¼‰\n- WMBï¼ˆWeight Mask Bitï¼‰\n- WGSï¼ˆWeight Group Sizeï¼‰\n\nCDMAä¸»è¦æœ‰ä¸¤ä¸ªæ•°æ®é€šé“ï¼Œåˆ†åˆ«æ˜¯æƒé‡è¯»å–é€šé“å’Œæ•°æ®è¯»å–é€šé“ï¼ŒCDMAä»…å‘é€æ•°æ®è¯»å–çš„è¯·æ±‚ã€‚CDMAæœ‰ä¸‰ä¸ªå­æ¨¡å—æ¥è·å–åƒç´ æ•°æ®æˆ–è€…ç‰¹å¾æ•°æ®æ¥è¿›è¡Œå·ç§¯ï¼Œåˆ†åˆ«æ˜¯CDMA_IMGï¼ˆPixelï¼‰ã€CDMA_WGï¼ˆWinogradï¼‰ã€CDMA_DCï¼ˆDirect Convolutionï¼‰ã€‚ä¸Šè¿°ä¸‰ä¸ªå­æ¨¡å—çš„å·¥ä½œæ­¥éª¤ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºæ•°æ®å­˜æ”¾åœ¨CBUF RAMä¸­çš„æ ¼å¼ï¼Œä»»ä½•æ—¶å€™åªèƒ½æœ‰ä¸€ä¸ªå­æ¨¡å—è¢«æ¿€æ´»æ¥è·å–åƒç´ /ç‰¹å¾æ•°æ®ã€‚ä»¥CDMA_DCä¸ºä¾‹ä»‹ç»ä¸€ä¸‹CDMAçš„å·¥ä½œæµç¨‹ï¼š\n\n- æ£€æŸ¥CBUFçš„çŠ¶æ€ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰ç©ºé—´ï¼›\n- è¿›è¡Œä¸€ä¸ªè¯»å–äº‹åŠ¡ï¼›\n- åœ¨å…±äº«ç¼“å†²åŒºï¼ˆShared_bufferï¼‰ä¸­ç¼“å­˜ç‰¹å¾æ•°æ®ï¼›\n- å°†ç‰¹å¾æ•°æ®ç«‹æ–¹ä½“é‡å¡‘ä¸ºæ­£ç¡®çš„æ ¼å¼ï¼›\n- ç”Ÿæˆå·ç§¯ç¼“å†²åŒºï¼ˆCBUFï¼‰çš„å†™å…¥åœ°å€ï¼›\n- å°†ç‰¹å¾æ•°æ®å†™å…¥CBUFï¼›\n- æ›´æ–°CDMA_STATUSå­æ¨¡å—ä¸­CBUFçš„çŠ¶æ€ï¼›\n\n### CBUF\n\nCBUFæ¨¡å—æœ‰16ä¸ª32KBçš„Bankï¼Œæ¯ä¸ªBankç”±ä¸¤ä¸ª512ä½å®½ã€256æ·±åº¦çš„åŒå£RAMç»„æˆï¼Œå­˜å‚¨ç©ºé—´å…±512KBï¼›CBUFç¼“å­˜æ¥è‡ªCDMAçš„åƒç´ ã€ç‰¹å¾ã€æƒé‡å’ŒWMBæ•°æ®ï¼Œå¹¶ç”±CSCæ¨¡å—è¿›è¡Œè¯»å–ï¼›CBUFæœ‰ä¸¤ä¸ªå†™ç«¯å£å’Œä¸‰ä¸ªè¯»ç«¯å£ã€‚\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232141424.png)\n\nå¦‚æœæƒé‡è¢«å‹ç¼©ï¼Œé‚£ä¹ˆBank15åˆ†é…ç»™WMBæ•°æ®ï¼ŒBank0~14åˆ†é…ç»™ç‰¹å¾ã€æƒé‡è¿›è¡Œç¼“å­˜ã€‚å¦‚æœæƒé‡æ²¡è¢«å‹ç¼©ï¼Œé‚£ä¹ˆç‰¹å¾ã€æƒé‡ç¼“å†²åŒºå¯ä»¥ä½¿ç”¨16ä¸ªBankï¼›\n\næ¯ä¸ªBankéƒ½æ˜¯å¾ªç¯ç¼“å†²åŒºï¼Œæ–°çš„æ•°æ®è¿›æ¥æ—¶åœ°å€éƒ½ä¼šè¿›è¡Œè‡ªå¢ï¼Œå½“åœ°å€è¾¾åˆ°æœ€å¤§å€¼åä¼šå›åˆ°0é‡æ–°è‡ªåŠ ï¼›\n\n### CSC\n\nå·ç§¯åºåˆ—æ§åˆ¶å™¨ï¼ˆCSCï¼‰è´Ÿè´£ä»CBUFåŠ è½½è¾“å…¥ç‰¹å¾æ•°æ®ã€åƒç´ æ•°æ®å’Œæƒé‡æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ°CMACå•å…ƒï¼Œä¸»è¦åŒ…å«ä¸‰ä¸ªæ¨¡å—ï¼šCSC_SGã€CSC_WLå’ŒCSC_DLã€‚\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232142001.png)\n\n#### CSC_SG\n\nCSC_SGæ¨¡å—ç”¨æ¥ç”Ÿæˆåºåˆ—æ¥æ§åˆ¶å·ç§¯æ“ä½œï¼Œå®ƒçš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š\n\n1. åœ¨CBUFä¸­è½®è¯¢è¶³å¤Ÿçš„æ•°æ®å’Œæƒé‡ï¼›\n2. ç”Ÿæˆä¸€å¯¹åºåˆ—åŒ…ï¼ŒåŒ…æ‹¬weightåŠ è½½åŒ…å’ŒdataåŠ è½½åŒ…ï¼Œæ¯ä¸ªåŒ…è¡¨ç¤ºä¸€ä¸ªstripe operationï¼›\n3. å°†ä¸¤ä¸ªåŠ è½½åŒ…pushåˆ°ä¸¤ä¸ªFIFOä¸­ï¼›\n4. ä¸¤ä¸ªç”¨äºweightå’Œfeature/imageçš„è®¡æ•°å™¨éƒ½æ˜¯å‘ä¸‹è®¡æ•°ï¼›//è®¡æ•°å™¨çš„ä½œç”¨ï¼Ÿ\n5. å½“è®¡æ•°å™¨è¾¾åˆ°é›¶æ—¶ï¼Œæ£€æŸ¥æ¥è‡ªCACCçš„ä¿¡å·æ˜¯å¦æœ‰ä»»ä½•back pressureï¼›\n6. å¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½å‡†å¤‡å°±ç»ªï¼Œå°±å°†weightå’ŒdataåŒ…å‘é€ç»™CSC_WLå’ŒCSC_DLï¼›\n\n#### CSC_DL\n\nCSC_DLï¼ˆData loaderï¼‰è´Ÿè´£æ‰§è¡Œfeature/imageåŠ è½½åºåˆ—çš„é€»è¾‘ï¼Œä»–ä»CSC_SGæ¥æ”¶åŒ…ï¼Œä»CBUFåŠ è½½feature/image dataï¼Œå¹¶å°†å…¶å‘é€åˆ°CMACï¼›ä¸”å®ƒè¿˜ç»´æŠ¤CBUFçš„çŠ¶æ€ï¼Œå¹¶ä¸CDMAé€šä¿¡ä»¥ä¿æŒçŠ¶æ€æœ€æ–°ã€‚å¯¹äºWinogradæ¨¡å¼ï¼Œå®ƒè¿˜æ‰§è¡Œé¢„åŠ æ³•æ¥è½¬æ¢è¾“å…¥æ•°æ®ï¼›\n\nä»¥DC modeä¸ºä¾‹è¯´æ˜CSC_DLçš„å·¥ä½œæµç¨‹ï¼š\t\t\t\t\t\t\t\t\t\t\t\n\n1. æ¯ä¸ªAtomic Operationï¼ŒDLä»CBUFè¯»å–ä¸€ä¸ªdata atomï¼Œå¹¶å‘é€ç»™CMACï¼›\n2. æ¯ä¸ªStripe Operationï¼ŒDLä»CBUFè¯»å–16~32ä¸ªdata atomï¼Œå¹¶å‘é€ç»™CMACï¼›\n3. æ¯ä¸ªBlock Operationï¼ŒDLé‡å¤ï¼ˆweight_height*weight_widthï¼‰æ¬¡stripe operationï¼Œä»CBUFè¯»å–å¯¹åº”çš„data atomï¼Œå¹¶å‘é€ç»™CMACï¼›\n4. æ¯æ¬¡Channel Operationï¼ŒDLé‡å¤C/64æ¬¡block Operationï¼Œä»CBUFè¯»å–å¯¹åº”çš„data atomï¼Œå¹¶å‘é€ç»™CMACï¼›\n5. æ¯ä¸ªGroup Operationï¼ŒDLéå†æ•´ä¸ªfeature mapï¼Œé‡å¤ï¼ˆdata_width*data_heightï¼‰/ï¼ˆ16~32ï¼‰æ¬¡channel operationï¼Œå¹¶å‘é€ç»™CMACï¼›\n6. DLé‡å¤kernel_num/ï¼ˆ16~32ï¼‰æ¬¡group operationï¼Œæ¯æ¬¡çš„dataéƒ½æ˜¯ç›¸åŒçš„ï¼›\n\næ³¨ï¼š16 or 32å–å†³äºæ•°æ®ç²¾åº¦ã€‚\n\n#### CSC_WL\n\nCSC_WLï¼ˆWeight loaderï¼‰æ‰§è¡ŒweightåŠ è½½åºåˆ—çš„é€»è¾‘ï¼Œå®ƒä»CSC_SGæ¥æ”¶åŒ…ï¼Œä»CBUFåŠ è½½weightï¼Œå¹¶è¿›è¡Œå¿…è¦çš„è§£å‹ç¼©å¹¶å°†å…¶å‘é€åˆ°CMACã€‚å®ƒå¸®åŠ©ç»´æŠ¤æƒé‡ç¼“å†²åŒºçŠ¶æ€ï¼Œå¹¶ä¸CDMA_WTé€šä¿¡ï¼Œæ¥ä½¿çŠ¶æ€åŠæ—¶æ›´æ–°ã€‚\n\nä»¥DC modeä¸ºä¾‹è¯´æ˜CSC_WLçš„å·¥ä½œæµç¨‹ï¼š\t\t\t\t\t\t\t\t\t\t\t\n\n1. æ¯ä¸ªatomic operationï¼ŒWLä¸éœ€è¦æ“ä½œï¼›\n2. æ¯ä¸ªstripe operationï¼ŒWLä»CBUFè¯»å–1ä¸ªgroupçš„16/32ä¸ªweight atomï¼Œå¹¶å‘é€ç»™CMACï¼›\n3. æ¯ä¸ªblock operationï¼ŒWLé‡å¤ï¼ˆweight_height*weight_widthï¼‰æ¬¡stripe operationï¼Œä»CBUFè¯»å–å¯¹åº”çš„weight atomï¼Œå¹¶å‘é€ç»™CMACï¼›\n4. æ¯ä¸ªchannel operationï¼ŒWLé‡å¤C/64æ¬¡block operationï¼Œä»CBUFè¯»å–å¯¹åº”çš„weight atomï¼Œå¹¶å‘é€ç»™CMACï¼›ï¼ˆtipsï¼š64=128byte/(int16/fp16)ï¼‰\n5. æ¯ä¸ªgroup operationï¼ŒWLåå¤è¯»å–åŒä¸€ç»„groupçš„weightï¼Œé‡å¤ï¼ˆdata_width*data_heightï¼‰/ï¼ˆ16~32ï¼‰æ¬¡channel operationï¼Œå¹¶å‘é€ç»™CMACï¼›\n6. WLé‡å¤kernel_num/ï¼ˆ16~32ï¼‰æ¬¡group operationï¼Œå®Œæˆæ‰€æœ‰kernel groupçš„è¯»å–ï¼›\n\n### CMAC\n\nCMACï¼ˆConvolution Multiply Accumulateï¼‰æ¨¡å—æ˜¯æµæ°´çº¿å·ç§¯æ“ä½œçš„ä¸€ä¸ªé˜¶æ®µï¼Œå®ƒä»CSCæ¥æ”¶è¾“å…¥æ•°æ®å’Œæƒé‡ï¼Œè¿›è¡Œä¹˜æ³•å’ŒåŠ æ³•è¿ç®—ï¼Œå¹¶å°†è¾“å‡ºç»“æœè¾“å‡ºåˆ°å·ç§¯ç´¯åŠ å™¨ã€‚å½“åœ¨Winogradæ¨¡å¼ä¸‹å·¥ä½œæ—¶ï¼ŒCMACåœ¨è¾“å‡ºä¸Šæ‰§è¡ŒPOA(post addition)å°†ç»“æœè½¬æ¢ä¸ºæ ‡å‡†æ¿€æ´»æ ¼å¼ã€‚\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232142273.png)\n\nCMACæœ‰16ä¸ªç›¸åŒçš„MAC Cellï¼Œæ¯ä¸ªMAC CellåŒ…å«64ä¸ªç”¨äº16bitçš„16ä½ä¹˜æ³•å™¨ï¼Œè¿˜åŒ…å«72ä¸ª16bitçš„åŠ æ³•å™¨ï¼Œç”¨äºWinogradçš„POAã€‚æ¯ä¸ª16ä½å®½çš„ä¹˜æ³•å™¨å’ŒåŠ æ³•å™¨éƒ½å¯ä»¥æ‹†åˆ†æˆint8æ ¼å¼çš„ä¸¤ä¸ªè®¡ç®—å•å…ƒï¼Œæ‰€ä»¥int8çš„ååé‡æ˜¯int16çš„ä¸¤å€ï¼›MAC Cellçš„æµæ°´çº¿æ·±åº¦ä¸º7ä¸ªCycleã€‚\n\nä¸ºäº†Physical Design Optimizationï¼ŒCMACè¢«åˆ†ä¸ºä¸¤éƒ¨åˆ†CMAC_Aå’ŒCMAC_Bï¼Œæ¯ä¸ªéƒ½æœ‰å•ç‹¬çš„CSBæ¥å£ã€‚\n\n### CACC\n\nå·ç§¯ç´¯åŠ å™¨ï¼ˆCACCï¼‰æ˜¯å·ç§¯æµæ°´çº¿åœ¨CMACä¹‹åçš„é˜¶æ®µï¼Œå®ƒç”¨äºç´¯åŠ CMACæ¨¡å—çš„éƒ¨åˆ†å’Œï¼Œå¹¶åœ¨å‘é€åˆ°SDPä¹‹å‰å¯¹ç»“æœè¿›è¡Œèˆå…¥/é¥±å’Œã€‚å®ƒæ”¯æŒä¸åŒä½å®½çš„æ•°æ®è¾“å…¥ï¼Œå¯¹äºINT16è¾“å…¥è€Œè¨€ç»“æœä½å®½ä¸º48ä½ï¼Œå¯¹äºINT8è¾“å…¥è€Œè¨€ç»“æœä½å®½ä¸º34ä½ã€‚CACCå’ŒSDPæ¨¡å—ä¹‹é—´çš„æ•°æ®ä½å®½æ˜¯32ï¼Œæ‰€ä»¥åœ¨å°†ç»“æœå‘é€ç»™SDPä¹‹å‰éœ€è¦æ‰§è¡Œä¸€ä¸ªèˆå…¥å’Œé¥±å’Œè¿ç®—ã€‚\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232142043.png)\n\nCACCä¸­çš„ç»„ä»¶å¦‚å›¾æ‰€ç¤ºï¼Œå·¥ä½œæµç¨‹ä¸»è¦å¦‚ä¸‹ï¼š\n\n1. ä»assembly SRAMä¸­é¢„å–ç´¯åŠ å’Œï¼›\n2. å½“CMACçš„éƒ¨åˆ†å’Œåˆ°è¾¾æ—¶ï¼Œå°†å®ƒä»¬ä¸ç´¯åŠ å’Œä¸€èµ·å‘é€åˆ°adder arrayï¼›å¦‚æœéƒ¨åˆ†å’Œæ¥è‡ªç¬¬ä¸€ä¸ªstripe operationï¼Œåˆ™ç´¯ç§¯å’Œåº”ä¸º0ï¼›\n3. ä»adder arrayçš„è¾“å‡ºç«¯æ”¶é›†æ–°çš„ç´¯åŠ å’Œï¼›\n4. å­˜å‚¨åˆ°assembly SRAMä¸­ï¼›\n5. åœ¨stripe operationä¸­é‡å¤step1~step3ï¼Œç›´åˆ°ä¸€ä¸ªchannel operationå®Œæˆï¼›\n6. å¦‚æœå®Œæˆchannel operationï¼ŒåŠ æ³•å™¨çš„è¾“å‡ºå°†è¢«èˆå…¥å¹¶é¥±å’Œï¼›\n7. æ”¶é›†ä¸Šä¸€æ­¥çš„ç»“æœå¹¶å°†å…¶å­˜å‚¨åˆ°delivery SRAMä¸­ï¼›\n8. ä»delivery SRAMä¸­åŠ è½½ç»“æœå¹¶å°†å®ƒä»¬å‘é€ç»™SDPï¼›\n\nä¸ºæ”¯æŒDirect Convolutionæ¨¡å¼ä¸‹çš„Multi-Batché€‰é¡¹ï¼ŒCACCåœ¨äº¤ä»˜SRAMç»„ä¸­åº”ç”¨äº†data remappingåŠŸèƒ½ï¼›ä¸ºäº†é˜²æ­¢æ•°æ®æº¢å‡ºï¼ŒCACCä½¿ç”¨ç›¸å…³åè®®æ¥åå‹CSCæ¨¡å—ã€‚\n\n### SDP\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232142835.png)\n\nSDPæ˜¯å•ç‚¹æ•°æ®å¤„ç†å™¨ï¼Œæ„åœ¨å¯¹å•ä¸ªæ•°æ®å…ƒç´ çº§åˆ«æ‰§è¡Œåå¤„ç†æ“ä½œï¼Œä¸»è¦å®Œæˆä»¥ä¸‹çš„æ“ä½œï¼š\n\n1. **<u>BiasåŠ æ³•</u>**çš„å…¬å¼ä¸º`y=x+bias`ï¼Œbiasæ˜¯ä¸€ä¸ªé¢„å…ˆè®­ç»ƒçš„å‚æ•°ï¼Œå¯ä»¥æ˜¯ä»¥ä¸‹3ç§ä¹‹ä¸€ï¼šå¦‚æœæ•´ä¸ªdata cubeéƒ½æ˜¯åŒä¸€biasçš„è¯å¯ä»¥ä»å¯„å­˜å™¨è·å–ï¼›per-channelæ¨¡å¼ä¸‹ï¼ŒåŒä¸€channelå†…biaså…±äº«ï¼›per-elementæ¨¡å¼ä¸‹ï¼Œä¸åŒçš„elementçš„biaséƒ½ä¸åŒã€‚\n2. Non-Linear Functionï¼ŒåŒ…æ‹¬ReLUã€Sigmoidå’ŒåŒæ›²æ­£åˆ‡ã€‚ReLUå¯ä»¥é€šè¿‡ç¡¬ä»¶é€»è¾‘å®ç°ï¼ŒSigmoidå’ŒåŒæ›²æ­£åˆ‡å‡½æ•°æ˜¯éçº¿æ€§å‡½æ•°ï¼Œæ‰€ä»¥ç”¨æŸ¥æ‰¾è¡¨æ¥å®ç°ï¼›\n3. Batch Normalizationï¼šSDPæ”¯æŒä½¿ç”¨ç»™å®šçš„å‡å€¼/æ ‡å‡†æ–¹å·®å‚æ•°è¿›è¡Œæ‰¹é‡å½’ä¸€åŒ–ï¼Œå‚æ•°æ˜¯ä»è®­ç»ƒä¸­è·å¾—çš„ï¼ŒSDPè¿˜å¯ä»¥æ”¯æŒæŒ‰å±‚å‚æ•°æˆ–è€…æŒ‰é€šé“å‚æ•°è¿›è¡Œæ‰¹é‡å½’ä¸€åŒ–æ“ä½œï¼›\n4. Element-Wise Layerï¼šå®ƒæŒ‡ä¸¤ä¸ªå…·æœ‰ç›¸åŒWã€Hå’ŒCå‚æ•°çš„ç‰¹å¾æ•°æ®ç«‹æ–¹ä½“ä¹‹é—´çš„ä¸€ç§æ“ä½œã€‚è¿™ä¸¤ä¸ªWÃ—HÃ—Cç‰¹å¾æ•°æ®ç«‹æ–¹ä½“è¿›è¡Œå…ƒç´ åŠ æ³•ã€ä¹˜æ³•ã€æˆ–MAX/MINæ¯”è¾ƒæ“ä½œï¼Œå¹¶è¾“å‡ºä¸€ä¸ªWÃ—HÃ—Cçš„ç‰¹å¾æ•°æ®ç«‹æ–¹ä½“ï¼›\n5. PReLU Functionï¼ŒReLUæ˜¯å°†è´Ÿå€¼è£å‰ªåˆ°0ï¼Œè€ŒPReLUæ˜¯å°†è´Ÿå€¼è¿›è¡Œç¼©æ”¾ï¼›\n6. Format Conversionï¼šNVDLAæ”¯æŒINT8ã€INT16å’ŒFP16ç²¾åº¦ï¼Œè¾ƒä½çš„ç²¾åº¦å¯æä¾›è¾ƒé«˜çš„æ€§èƒ½ï¼Œè€Œè¾ƒé«˜çš„ç²¾åº¦å¯æä¾›æ›´å¥½çš„æ¨ç†ç»“æœã€‚\n\n### PDP\n\nPDPä¸»è¦æ²¿å®½Ã—é«˜çš„å¹³é¢æ‰§è¡Œæ“ä½œï¼ŒPDPæ¨¡å—æ—¨åœ¨å®Œæˆæ± åŒ–å±‚ï¼Œæ”¯æŒMAXã€MINå’ŒAVERAGEæ± åŒ–æ“ä½œã€‚PDPå•å…ƒæ¥æ”¶æ¥è‡ªSDPæˆ–è€…MCIF/SRAMIFçš„æ•°æ®ï¼Œå¹¶å°†æ•°æ®å‘é€ç»™MCIF/SRAMIFã€‚\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232142274.png)\n\næ”¯æŒçš„å°ºå¯¸å¦‚ä¸‹ï¼šPooling Kernel Sizeï¼š1~8ï¼›Pooling Kernel Strideï¼š1~16ï¼›\n\non-the-flyæ¨¡å¼ä¸‹è¾“å…¥æ•°æ®ç›´æ¥ä»SDPè·å–ï¼Œoff-flyæ¨¡å¼ä¸‹è¾“å…¥æ•°æ®ä»PDMAè·å–ï¼›\n\nPre-processingæ¨¡å—ä¸»è¦å®Œæˆæœ€å¤§ã€æœ€å°æ“ä½œä»¥åŠéƒ¨åˆ†å’Œçš„æ±‚å’Œæ“ä½œï¼›\n\nPos-processingæ¨¡å—ä¸»è¦é’ˆå¯¹Average Poolingè¿›è¡Œç›¸å…³çš„åå¤„ç†æ“ä½œï¼Œå¦‚æœæ˜¯MAX/MIN Poolingæ“ä½œçš„è¯ï¼Œé‚£ä¹ˆShare Line Bufferå­˜å‚¨çš„å°±æ˜¯æœ€ç»ˆç»“æœï¼›å¦‚æœæ˜¯Average Poolingçš„è¯ï¼Œéœ€è¦å–å‡ºShare Line Bufferä¸­çš„æ•°è¿›è¡Œé™¤æ³•æ“ä½œï¼Œå¹¶ä¸”ä¸ºæ–¹ä¾¿ç¡¬ä»¶å®ç°å°†é™¤æ³•è½¬æ¢ä¸ºä¹˜æ³•æ“ä½œï¼›\n\n### CDP\n\nCDPæ¨¡å—æ—¨åœ¨è§£å†³å±€éƒ¨å“åº”å½’ä¸€åŒ–å±‚ï¼ŒLRNé€šè¿‡åœ¨é€šé“æ–¹å‘ä¸Šå¯¹å±€éƒ¨è¾“å…¥åŒºåŸŸè¿›è¡Œå½’ä¸€åŒ–ã€‚CDPæ¨¡å—å§‹ç»ˆä¸å…¶å®ƒå¤„ç†å­å•å…ƒ<u>**ç‹¬ç«‹å·¥ä½œ**</u>ï¼Œå®ƒä»PDMAæ¥æ”¶è¾“å…¥æ•°æ®å¹¶å°†è¾“å‡ºæ•°æ®å‘é€å›PDMAã€‚\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232142860.png)\n\nLRNçš„è®¡ç®—å…¬å¼ä¸­æ¶‰åŠåˆ°é™¤æ³•å’ŒæŒ‡æ•°è¿ç®—ï¼Œä½¿ç”¨ç¡¬ä»¶å®ç°ä»£ä»·è¾ƒå¤§ï¼Œæ‰€ä»¥å†…éƒ¨ç”¨LUTå®ç°åŠŸèƒ½ã€‚\n\n### RUBIK\n\n![12](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232143590.png)\n\nRUBIKçš„åŠŸèƒ½æ˜¯è½¬æ¢æ•°æ®çš„æ˜ å°„æ ¼å¼ï¼Œä¸»è¦æœ‰ä¸‰ç§å·¥ä½œæ¨¡å¼ï¼š\n\n- contract data cube\n- split feature data cube into multi-planar formats\n- merge multi-planar formats to data cube\n\n### BDMA\n\nNVDLAä¸€èˆ¬å°†è¾“å…¥å›¾åƒå’Œå¤„ç†ç»“æœå­˜å‚¨åœ¨å¤–éƒ¨DRAMä¸­ï¼Œä½†å—é™äºDRAMçš„å¸¦å®½å’Œå»¶è¿Ÿï¼ŒNVDLAä¸èƒ½æé«˜MACé˜µåˆ—çš„æ•ˆç‡ï¼Œæ‰€ä»¥NVDLAé…ç½®äº†ä¸€ä¸ªåˆ°ç‰‡ä¸ŠSRAMçš„è¾…åŠ©å­˜å‚¨å™¨æ¥å£ã€‚\n\n![13](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232143215.png)\n\nNVDLAä½¿ç”¨BDMAæ¥åœ¨å¤–éƒ¨DRAMå’Œå†…éƒ¨SRAMä¹‹é—´ç§»åŠ¨æ•°æ®ï¼Œæœ‰ä¸¤ä¸ªç‹¬ç«‹çš„è·¯å¾„ï¼Œä¸€ä¸ªæ˜¯ä»DRAMåˆ°SRAMï¼Œå¦ä¸€ä¸ªæ˜¯ä»SRAMåˆ°DRAMï¼Œä¸¤ä¸ªæ–¹å‘ä¸èƒ½åŒæ—¶å·¥ä½œã€‚åŒæ—¶BDMAè¿˜å¯ä»¥å°†æ•°æ®ä»DRAMç§»åŠ¨åˆ°DRAMï¼Œæˆ–è€…ä»SRAMç§»åŠ¨åˆ°SRAMã€‚\n\nä¸¤ä¸ªæ¥å£çš„æ•°æ®ä½å®½å‡ä¸º512ä½ï¼Œæœ€å¤§çªå‘é•¿åº¦ä¸º4ã€‚\n\n### MCIF&SRAMIF\n\n![14](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232143502.png)\n\n![15](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232143212.png)\n\nMCIFç”¨äºä»²è£å¤šä¸ªå†…éƒ¨å­æ¨¡å—çš„è¯·æ±‚ï¼Œå¹¶è½¬æ¢ä¸ºAXIåè®®æ¥è¿æ¥åˆ°å¤–éƒ¨DRAMã€‚MCIFæ˜¯åŒæ—¶æ”¯æŒè¯»å†™é€šé“çš„ä»²è£çš„ï¼Œä½†æœ‰äº›NVDLAçš„å­æ¨¡å—åªæœ‰è¯»è¯·æ±‚ï¼Œå¦‚å›¾ä¸­çš„CDMA0å’ŒCDMA1åªæœ‰è¯»è¯·æ±‚ï¼Œå…¶å®ƒ5ä¸ªæ¥å£å‡éœ€è¦è¯»å†™ã€‚\n\nSRAMIFä¸MCIFæ¥å£åŠŸèƒ½ç±»ä¼¼ï¼Œä½†é¢„è®¡æ€»çº¿å»¶è¿Ÿæ›´ä½ã€‚\n\n## Convolution in NVDLA\n\nä¸‹é¢ç®€å•è¯´ä¸€ä¸‹NVDLAä¸­ç›´æ¥å·ç§¯çš„æµç¨‹ã€‚è¾“å…¥çš„Data Cubeä¸ºWÃ—HÃ—Cï¼›å…±Kä¸ªkernelï¼Œæ¯ä¸ªkernelçš„å°ºå¯¸ä¸ºSÃ—RÃ—Cï¼›è¾“å‡ºçš„Data Cubeå°ºå¯¸ä¸ºW'Ã—H'Ã—C'ï¼›å…¶ä¸­W'å’ŒH'ä¸Paddingå’ŒStrideæœ‰å…³ï¼ŒC'ä¸Kernelæ•°é‡ç›¸ç­‰ï¼›\n\n![16](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232143782.png)\n\nä¸‹å›¾æ˜¾ç¤ºäº†Strideå’ŒZero Paddingçš„ç¤ºæ„å›¾ï¼Œå…¶ä¸­é»‘è‰²è™šçº¿æ¡†å‡ºçš„æ˜¯Paddingä¹‹å‰çš„Feature Dataï¼›Kernelå­—æ¯è¡¨ç¤ºå·ç§¯æ ¸çš„ä¸­é—´ä½ç½®ï¼Œå¯ä»¥çœ‹åˆ°åœ¨Xæ–¹å‘å’ŒYæ–¹å‘ä¸Šåˆ†åˆ«ä»¥SXå’ŒSYä¸ºè·ç¦»è¿›è¡Œæ­¥è¿›ï¼›\n\n![17](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232143564.png)\n\n### Data Format\n\n![18](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232143069.png)\n\n![19](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232144717.png)\n\nè¿™å¼ å›¾æ˜¾ç¤ºäº†Direct Convolutionæ¨¡å¼ä¸‹ç‰¹å¾æ•°æ®ä¸æƒé‡çš„æ•°æ®æ ¼å¼ï¼Œç‰¹å¾æ•°æ®ä»¥32Byteä¸ºå•ä½ï¼Œåœ¨W-H-Cæ–¹å‘ä¸Šè¿›è¡Œæ‰«æå¹¶å¯¹æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œå¦‚æœåŸå§‹ç‰¹å¾æ•°æ®ä¸æ˜¯Cæ–¹å‘ä¸Šçš„32å­—èŠ‚å¯¹é½ï¼Œåˆ™å°†æ•°æ®æ·»åŠ åˆ°é€šé“æœ«å°¾ï¼›\n\næƒé‡æ•°æ®æ˜¯åœ¨å·ç§¯æ“ä½œä¹‹å‰å¾ˆä¹…å°±ç”Ÿæˆçš„ï¼Œè½¯ä»¶åº”å°†æƒé‡æ•°æ®æŒ‰DLAä¸­çš„è®¡ç®—é¡ºåºè¿›è¡Œæ˜ å°„ã€‚æƒé‡æ˜¯åœ¨é€šé“æ–¹å‘ä¸Šä»¥128Byteä¸ºå•ä½è¿›è¡Œåˆ’åˆ†ï¼Œä¸è¶³128Byteçš„è¯è¦è¿›è¡Œä¸€ä¸ªè¡¥é›¶æ“ä½œï¼Œåœ¨C'-W-H-Cæ–¹å‘ä¸Šè¿›è¡Œæ‰«æå¹¶å¯¹æ•°æ®è¿›è¡Œå­˜å‚¨ã€‚\n\n### Atomic Operation\n\n![20](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232144637.png)\n\nåœ¨ä¸€ä¸ªåŸå­æ“ä½œä¸­ï¼Œæ¯ä¸ªMAC Celléƒ½å–ä¸€ä¸ª1Ã—1Ã—64çš„weight cubeï¼ˆ16bitï¼‰æ¥ä¸1Ã—1Ã—64çš„feature dataåšè¿ç®—ï¼Œ**<u>å®Œæˆ64ä¸ªæ•°çš„ä¹˜åŠ è¿ç®—æ“ä½œï¼ˆ64ä¸ªChannelï¼‰</u>**ã€‚å› ä¸ºæœ‰16ä¸ªMAC Cellï¼Œæ‰€ä»¥ä¸€æ¬¡èƒ½å¹¶è¡Œè®¡ç®—16ä¸ªkernelï¼ŒMAC Cellä¹˜åŠ è¿ç®—åçš„ç»“æœå«åšéƒ¨åˆ†å’Œï¼Œæ‰€ä»¥**<u>æ¯ä¸ªCycleæˆ‘ä»¬å¯ä»¥å¾—åˆ°16ä¸ªéƒ¨åˆ†å’Œï¼ˆpartial sumï¼‰</u>**ã€‚å¾—åˆ°çš„éƒ¨åˆ†å’Œè¢«é€å¾€CACCæ¨¡å—è¿›è¡Œç´¯ç§¯å’Œçš„è®¡ç®—ã€‚\n\n### Stripe Operation\n\n![21](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232144640.png)\n\næ¡å¸¦æ“ä½œæ˜¯åŸå­æ“ä½œçš„ç»„åˆï¼Œåœ¨ä¸€æ¬¡æ¡å¸¦æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œ**<u>MAC Cellä¸­çš„æƒé‡æ•°æ®ä¿æŒä¸å˜</u>**ï¼Œç‰¹å¾æ•°æ®æ²¿ç€input data cubeæ»‘åŠ¨ã€‚ï¼ˆé¦–å…ˆæ²¿ç€Wæ–¹å‘è¿›è¡Œæ»‘åŠ¨ï¼‰\n\nç”±äºæ¡å¸¦æ“ä½œMAC Cellä¸­æƒé‡æ•°æ®ä¿æŒä¸å˜ï¼Œæ‰€ä»¥**<u>ä¸€æ¬¡æ¡å¸¦æ“ä½œä¸­çš„éƒ¨åˆ†å’Œä¸èƒ½è¿›è¡Œç´¯åŠ æ“ä½œ</u>**ï¼Œå› ä¸ºå®ƒä»¬æ¥è‡ªä¸åŒçš„å·ç§¯æ ¸ï¼›è¿™å°±æ˜¯è¯´éœ€è¦åœ¨CACCæ¨¡å—å¯¹éƒ¨åˆ†å’Œè¿›è¡Œç¼“å­˜ã€‚\n\n**<u>ç”±äºCACCæ¨¡å—çš„ç¼“å†²åŒºå—é™ï¼Œæ‰€ä»¥Stripe Operationçš„Lengthæœ‰ä¸Šé™ï¼Œä¸Šé™ä¸º32ã€‚</u>**åŒæ—¶Stripe Operationçš„Lengthä¹Ÿæœ‰ä¸‹é™ï¼Œ**<u>å› ä¸ºè¦æ›´æ–°ä¸‹ä¸€æ¬¡Stripe Operationçš„æƒé‡æ•°æ®è‡³å°‘è¦16ä¸ªCycleï¼Œæ‰€ä»¥ä¸‹é™ä¸º16ã€‚</u>**\n\nå³1æ¬¡Stripe Operation=16~32æ¬¡Atomic Operationï¼Œå…¶ä¸­Weight Dataä¸å˜ï¼Œæ»‘åŠ¨Feature Dataã€‚\n\n### Block Operation\n\n![22](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232144564.png)\n\nBlock Operationæ˜¯ç”±ä¸€ç³»åˆ—çš„Stripe Operationç»„æˆï¼Œ**<u>æ¬¡æ•°ä¸ºï¼ˆWeight WidthÃ—Weight Heightï¼‰</u>**ï¼Œæ¯æ¬¡Stripe Operationçš„éƒ¨åˆ†å’Œç»“æœéƒ½è¢«å‘é€åˆ°CACCæ¨¡å—è¿›è¡Œç´¯åŠ å’Œçš„è®¡ç®—ã€‚\n\n<!--NVDLAæ–‡æ¡£ä¸Šå†™çš„æ˜¯16-32 element accumulatorï¼Œæˆ‘ç†è§£çš„æ˜¯å¯ä»¥å¯¹16-32è·¯è¿›æ¥çš„æ•°æ®è¿›è¡Œç´¯åŠ ï¼Œåœ¨ä¸€æ¬¡Block Operationä¸­æ¯è·¯çš„æ•°æ®é‡åº”è¯¥æ˜¯ï¼ˆWeight WidthÃ—Weight Heightï¼‰ï¼Œæ¯ä¸ªæ•°æ®éƒ½æ˜¯Atomic Operationçš„éƒ¨åˆ†å’Œã€‚-->\n\n> The partial sums from the same block operation are added together per stripe operation in the convolution accumulator.\n\nç´¯åŠ å’Œçš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š\n$$\nAS_{w,h,k,c}=\\sum_{r=0}^{R-1}\\sum_{s=0}^{S-1}\\sum_{i=c}^{min(c+63,C-1)}x_{(w*SX-LP+r),(h*SY-TP+s),i}*wt_{r,s,i,k}\n$$\nåœ¨å…¬å¼ä¸­ï¼ŒASæŒ‡accumulative sumï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ±‚å’Œåº”è¯¥æ˜¯ç”±CACCæ¨¡å—è¿›è¡Œï¼Œç¬¬ä¸‰ä¸ªæ±‚å’Œåº”è¯¥æ˜¯MAC Cellè¿›è¡Œã€‚\n\n### Channel Operation\n\n![23](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232144295.png)\n\næ¯æ¬¡Block Operationå®Œæˆ64ä¸ªkernelçš„è¿ç®—ï¼ŒChannel Operationæ˜¯ä¸€ç³»åˆ—Block Operationçš„ç»„åˆï¼Œæ¬¡æ•°å…±æœ‰`(C+63)/64`ï¼Œå®ŒæˆChannelæ–¹å‘ä¸Šçš„æ‰€æœ‰è¿ç®—ã€‚**<u>åœ¨åŒä¸€ä¸ªChannel Operationä¸­çš„éƒ¨åˆ†å’Œåº”è¯¥ä»¥å·ç§¯æ ¸ä¸ºå•ä½ç»§ç»­è¿›è¡Œç´¯åŠ æ“ä½œ</u>**ï¼Œåœ¨Channel Operationå®Œæˆåï¼Œå­˜å‚¨çš„ç´¯åŠ å’Œæ‰æ˜¯å·ç§¯çš„æœ€ç»ˆç»“æœï¼Œæ‰ä¼šä»CACCæ¨¡å—ä¸­çš„assembly SRAMå¸è½½åˆ°delivery SRAMï¼Œé€ç»™åç»­çš„å¤„ç†æ¨¡å—ã€‚\n\n<!--CACCæ¨¡å—å¯¹16-32è·¯è¿›æ¥çš„æ•°æ®è¿›è¡Œç´¯åŠ ï¼Œåœ¨ä¸€æ¬¡Block Operationä¸­æ¯è·¯çš„æ•°æ®é‡åº”è¯¥æ˜¯ï¼ˆWeight WidthÃ—Weight Heightï¼‰Ã—[(C+63)/64]ï¼Œæ¯ä¸ªæ•°æ®éƒ½æ˜¯Atomic Operationçš„éƒ¨åˆ†å’Œã€‚-->\n\n### Group Operation\n\n![24](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232144454.png)\n\nGroup Operationæ˜¯Channel Operationçš„ç»„åˆï¼Œéœ€è¦é‡å¤`(data_width*data_height)/(16~32)`æ¬¡ã€‚åœ¨Group Operationåï¼Œè¾“å‡ºçš„æ•°æ®å°ºå¯¸ä¸º`WÃ—HÃ—K'`ï¼Œå…¶ä¸­K'ä¸ºä¸€æ¬¡Kernel Groupä¸­Kernelçš„æ•°é‡ï¼Œå¯¹äº16-bitçš„æ•°æ®è€Œè¨€ä¸º16ä¸ªï¼Œå¯¹äº8-bitçš„æ•°æ®è€Œè¨€ä¸º32ä¸ªã€‚\n\nDirect Convolutioné‡å¤`kernel_num/(16~32)`æ¬¡Group Operationå³å¯å®Œæˆå·ç§¯è¿ç®—ï¼Œæ¯æ¬¡çš„feature dataéƒ½æ˜¯ç›¸åŒçš„ã€‚\n\n## å…¶å®ƒ\n\n### æƒé‡å‹ç¼©\n\n- WMBï¼šWeight Mask Bitï¼Œç”¨ä¸€ä½æ ‡è®°æ¥æŒ‡ç¤ºæƒé‡å…ƒç´ æ˜¯å¦ä¸º0ï¼Œ1ä½ä¸1ä¸ªæƒé‡elementå¯¹åº”ï¼›å¯¹äºint16å’Œfp16ï¼Œ1ä½ä»£è¡¨2å­—èŠ‚æƒé‡æ•°æ®ï¼›å¯¹äºint8ï¼Œ1ä½ä»£è¡¨1ä¸ªå­—èŠ‚çš„æƒé‡æ•°æ®ï¼›WMBå§‹ç»ˆæ˜¯128Byteå¯¹é½ï¼Œä¸è¶³çš„è¡¥0ã€‚\n- WGSï¼šWeight Group Sizeï¼Œå‹ç¼©åçš„æƒé‡ç»„æ•°æ®é‡å¤§å°ï¼Œå•ä½ä¸ºByteï¼Œä½å®½ä¸º32bitï¼›\n\n### Multi-Batch Mode\n\nNVDLAæ”¯æŒå¤šæ‰¹æ¬¡æ¨¡å¼æ¥æé«˜æ€§èƒ½å¹¶é™ä½å¸¦å®½ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå…¨è¿æ¥å±‚ã€‚å…¨è¿æ¥å±‚çš„è¾“å‡ºæ˜¯1Ã—1Ã—Cçš„data cubeï¼Œä¹Ÿå°±æ˜¯è¯´FCå±‚ä¸­çš„æ‰€æœ‰æƒé‡åªä½¿ç”¨ä¸€æ¬¡ï¼Œå°±æ˜¯FCå±‚çš„ä¸€ä¸ªæ¡å¸¦æ“ä½œå†…åªæœ‰ä¸€ä¸ªåŸå­æ“ä½œï¼Œä½†æµæ°´çº¿å·ç§¯è¿˜éœ€è¦16ä¸ªå‘¨æœŸæ¥ä¸ºä¸‹ä¸€ä¸ªåŸå­æ“ä½œåŠ è½½æƒé‡ï¼ŒMACçš„æ•ˆç‡ä¸‹é™åˆ°6.25%ã€‚\n\nå¤šæ‰¹æ¬¡å°±æ˜¯è¯´åŒæ—¶å¤„ç†å¤šä¸ªè¾“å…¥çš„ç‰¹å¾æ•°æ®ç«‹æ–¹ä½“ï¼Œæµæ°´çº¿å·ç§¯å°†ä¸ºä¸€ç»„æƒé‡kernelè·å–å¤šä¸ªè¾“å…¥æ•°æ®ç«‹æ–¹ä½“ï¼Œè¿™ä¹Ÿæ”¹å˜äº†åŸå­æ“ä½œã€‚æ¥è‡ªä¸åŒè¾“å…¥æ•°æ®ç«‹æ–¹ä½“çš„1Ã—1Ã—64çš„cubeä¸€ä¸ªä¸€ä¸ªäº¤é”™åŠ è½½ä»¥è¿›è¡ŒåŸå­æ“ä½œï¼Œç„¶åæ¡å¸¦æ“ä½œåŒ…å«å¤šä¸ªæ‰¹æ¬¡çš„åŸå­æ“ä½œã€‚ç”±äºæƒé‡åœ¨æ•´ä¸ªStripe Operationä¸­é‡å¤ä½¿ç”¨ï¼Œå› æ­¤å¯ä»¥æŠŠæƒé‡åŠ è½½å‘¨æœŸéšè—åˆ°å¤„ç†æµç¨‹ä¸­ï¼Œæé«˜äº†MACçš„ä½¿ç”¨æ•ˆç‡ã€‚\n\n## END\n\n[Reference](http://nvdla.org/hw/v1/ias/unit_description.html)","tags":["Proj"],"categories":["Proj"]},{"title":"Verilogå„ç±»åˆ†é¢‘å™¨è®¾è®¡è¯¦è§£","url":"/2022/09/29/IC/Basic/Verilogå„ç±»åˆ†é¢‘å™¨è®¾è®¡è¯¦è§£/","content":"\n# Verilogå„ç±»åˆ†é¢‘å™¨è®¾è®¡è¯¦è§£\n\nåˆ†é¢‘å™¨æ˜¯æ—¶åºç”µè·¯çš„åŸºæœ¬å™¨ä»¶ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å¯¹ç³»ç»Ÿæ—¶é’Ÿæˆ–å…¶ä»–æ—¶é’Ÿè¿›è¡Œåˆ†é¢‘äº§ç”Ÿæ‰€éœ€è¦çš„æ—¶é’Ÿä¿¡å·ã€‚åˆ†é¢‘æœ‰ä¸¤ç§æ–¹å¼ï¼šä¸€æ˜¯é€šè¿‡HDLè¯­è¨€å»ºæ¨¡äº§ç”Ÿæ‰€éœ€è¦çš„æ—¶é’Ÿä¿¡å·ï¼ŒäºŒæ˜¯åˆ©ç”¨å¼€å‘å·¥å…·çš„PLLè¿›è¡Œåˆ†é¢‘ã€‚å‰è€…åˆ†é¢‘çµæ´»ï¼Œéœ€ç¼–å†™ä»£ç å®ç°ï¼›åè€…ä½¿ç”¨åœºæ™¯å—é™ï¼Œå› ä¸ºæœ‰çš„ä½ç«¯FPGAæ²¡æœ‰PLLï¼Œä½†PLLçš„åˆ†é¢‘æ•ˆæœæ›´å¥½ï¼Œè€Œä¸”åœ¨è¿›è¡Œå°æ•°åˆ†é¢‘æ—¶ä¹Ÿæ¯”è¾ƒå®¹æ˜“å®ç°ã€‚**æœ¬æ–‡é¦–å…ˆå°è¯•ç”¨HDLè¯­è¨€å»ºæ¨¡æ–¹å¼è®¾è®¡å„ç§ç±»å‹çš„åˆ†é¢‘å™¨ï¼Œæœ€åç»™å¤§å®¶ç®€å•ä»‹ç»ä¸€ä¸‹PLLçš„ä½¿ç”¨ã€‚**å¦‚æœ‰ä¸è¶³ä¹‹å¤„è¿˜æœ›å¤§å®¶æ‰¹è¯„æŒ‡æ­£ã€‚\n\n## å¶æ•°åˆ†é¢‘å™¨\n\næˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„å¶æ•°åˆ†é¢‘å™¨åˆ‡å…¥ï¼Œæ…¢æ…¢åˆ†æå„ç§åˆ†é¢‘å™¨çš„å®ç°ã€‚\n\nè‹¥è¦å®ç°äºŒåˆ†é¢‘ï¼Œåˆ™åªéœ€è¦åœ¨åŸæ—¶é’Ÿçš„ä¸Šå‡æ²¿è¿›è¡Œè¾“å‡ºæ—¶é’ŸçŠ¶æ€çš„ç¿»è½¬å³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232037429.png)\n\nè‹¥å®ç°å››åˆ†é¢‘å‘¢ï¼Ÿåˆ™éœ€è¦ä¸€ä¸ªè®¡æ•°å™¨ï¼Œæ¯æ¬¡åœ¨åŸæ—¶é’Ÿçš„ä¸Šå‡æ²¿è®¡æ•°ï¼Œå½“è®¡æ•°å™¨è®°åˆ°2ä¸ªä¸Šå‡æ²¿æ—¶è¾“å‡ºæ—¶é’ŸçŠ¶æ€è¿›è¡Œç¿»è½¬ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232037205.png)\n\nç°åœ¨å¯¹ä¸€èˆ¬æƒ…å†µè¿›è¡Œåˆ†æï¼Œ**å¯¹æ—¶é’Ÿè¿›è¡ŒNåˆ†é¢‘ï¼ŒNä¸ºå¶æ•°**ï¼›åˆ™è®¡æ•°å™¨æ¯æ¬¡åœ¨åŸæ—¶é’Ÿçš„ä¸Šå‡æ²¿è®¡æ•°ï¼Œ**è®¡æ•°å™¨çš„èŒƒå›´ä¸º0~(N-1)**ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨0â€”(N-1)è¿™Nä¸ªæ•°ä¸­åˆ†å‡ºä¸¤ä¸ªèŒƒå›´é€‰æ‹©è¾“å‡ºæ—¶é’Ÿçš„çŠ¶æ€ï¼Œå¦‚å½“cntåœ¨0â€”MèŒƒå›´æ—¶è¾“å‡ºæ—¶é’Ÿä¸ºä½ç”µå¹³ï¼Œå½“cntåœ¨(M+1)â€”(N-1)èŒƒå›´æ—¶è¾“å‡ºæ—¶é’Ÿä¸ºé«˜ç”µå¹³ï¼Œåˆ™**æˆ‘ä»¬å¯ä»¥åŠ¨æ€è°ƒæ•´è¾“å‡ºæ—¶é’Ÿçš„å ç©ºæ¯”**ï¼Œè¾“å‡ºæ—¶é’Ÿçš„å ç©ºæ¯”ä¸º(N-M-1)/Nï¼›\n\nä»¥8åˆ†é¢‘ä¸ºä¾‹ï¼Œåˆ™N=8ï¼Œå–M=3ï¼Œåˆ™æ­¤æ—¶è¾“å‡ºçš„æ—¶é’Ÿåº”å½“æ˜¯50%å ç©ºæ¯”ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232038249.png)\n\nè‹¥å–M=1ï¼Œåˆ™æ­¤æ—¶è¾“å‡ºæ—¶é’Ÿçš„å ç©ºæ¯”åº”å½“æ˜¯75%ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232038225.png)\n\n**å¶æ•°åˆ†é¢‘å™¨ä»£ç **\n\n```verilog\n// å¶æ•°åˆ†é¢‘å™¨ç¤ºä¾‹ï¼Œå¯è°ƒå ç©ºæ¯”\nmodule clk_div_even(\n\tinput wire clk,                 //ç³»ç»Ÿæ—¶é’Ÿ\n\tinput wire rst_n,               //å¼‚æ­¥ä½ç”µå¹³å¤ä½\n\tinput wire [7:0] clkperiod,     //åˆ†é¢‘ç³»æ•°ï¼ŒN(å¶æ•°)åˆ†é¢‘æ—¶clkperiod=N\n\tinput wire [7:0] clklow,        //ä½ç”µå¹³å ç”¨ç³»ç»Ÿæ—¶é’Ÿçš„å‘¨æœŸæ•°\n                                    //å ç©ºæ¯”ä¸º50%æ—¶clklow=N/2\n    output reg clk_out\t\t\t\t//è¾“å‡ºæ—¶é’Ÿ\n    );\n \nreg [7:0] cnt;\n \nalways @(posedge clk or negedge rst_n) begin\n    if(!rst_n) begin\n        cnt <= 8'b0;\n        clk_out <= 1'b0;\n    end\n    else begin\n        if(cnt == clklow - 1'b1) begin\n            clk_out <= 1'b1;\n            cnt <= cnt + 8'd1;\n        end\n        else if(cnt == clkperiod - 1'b1) begin\n            clk_out <= 1'b0;\n            cnt <= 8'd0;\n        end\n\t\telse begin\n            cnt <= cnt + 8'd1;\n\t\tend\n    end\nend\n \nendmodule\n```\n\n## å¥‡æ•°åˆ†é¢‘å™¨\n\næˆ‘ä»¬å…ˆä»¥ä¸‰åˆ†é¢‘æ¨¡å—åˆ‡å…¥ï¼Œåˆ†æå¥‡æ•°åˆ†é¢‘å™¨çš„æ€æƒ³ï¼šæ•´ä½“æ€è·¯æ˜¯**äº§ç”Ÿä¸¤è·¯ä¸Šå‡æ²¿å’Œä¸‹é™æ²¿è§¦å‘ä¿¡å·**ï¼Œç„¶åå¯¹è¿™ä¸¤è·¯ä¿¡å·è¿›è¡Œæ“ä½œå¾—åˆ°æœ€ç»ˆåˆ†é¢‘æ—¶é’Ÿã€‚\n\nå½“åˆ†é¢‘ç³»æ•°Nä¸ºå¥‡æ•°æ—¶ï¼Œä½¿ç”¨ä¸€ä¸ªè®¡æ•°å™¨åœ¨0~(N-1)å¾ªç¯è¿›è¡Œè®¡æ•°ï¼Œæ§åˆ¶è¾“å‡º(N-1)/2ä¸ªé«˜ç”µå¹³ï¼Œ(N+1)/2ä¸ªä½ç”µå¹³ï¼Œç§°ä¸º`clk_1`ï¼›ç„¶åå°†æ­¤`clk_1`ç”µå¹³ä¿¡å·å»¶è¿ŸåŠä¸ªå‘¨æœŸç§°ä¸º`clk_2`ï¼Œæœ€åè¾“å‡º`clk_out =  clk_1 | clk_2`ï¼Œå³ä¸ºå ç©ºæ¯”ä¸º50%çš„å¥‡æ•°åˆ†é¢‘å™¨ï¼›å¦ä¸€ç§æ€è·¯æ˜¯äº§ç”Ÿè¾“å‡º(N+1)/2ä¸ªé«˜ç”µå¹³ï¼Œ(N-1)/2ä¸ªä½ç”µå¹³çš„`clk_1`ï¼Œè¾“å‡ºçš„åˆ†é¢‘æ—¶é’Ÿä¸º`clk_out =  clk_1 & clk_2`ã€‚\n\nä»¥`clk_out =  clk_1 & clk_2`ä¸ºä¾‹ï¼Œå°†`clk_1`å»¶æ—¶åŠä¸ªæ—¶é’Ÿå‘¨æœŸçš„æ–¹æ³•æœ‰ä¸¤ç§ï¼Œæ³•1æ˜¯ç›´æ¥ä½¿ç”¨ä¸‹é™æ²¿çš„é”å­˜å™¨å¯¹`clk_1`é”å­˜å¾—åˆ°`clk_2`ï¼Œæ³•2å¾—åˆ°`clk_2`çš„åŸç†ä¸`clk_1`ç›¸åŒï¼Œä¸è¿‡æ˜¯åœ¨ä¸‹é™æ²¿æ£€æµ‹ã€‚\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232039017.png)\n\nè‹¥é‡‡ç”¨æ³•ä¸€ï¼Œåˆ™æˆ‘ä»¬ç”¨ä¸€ä¸ª**ä¸‹é™æ²¿è§¦å‘**çš„Dè§¦å‘å™¨é”å­˜`clk_1`çš„ç»“æœ`clk_2`ï¼Œç„¶åå°†`clk_1`ä¸`clk_2`ä¿¡å·åšé€»è¾‘â€œæˆ–â€å°±å¾—åˆ°äº†å ç©ºæ¯”50%çš„åˆ†é¢‘æ—¶é’Ÿä¿¡å·`clk_out`ã€‚\n\nç»“åˆä¸Šé¢çš„å¶æ•°åˆ†é¢‘å™¨ï¼Œå¦‚æœNä¸ºå¶æ•°ï¼Œåˆ™`clk_1`å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„åˆ†é¢‘ç»“æœï¼Œå¦‚æœNä¸ºå¥‡æ•°ï¼Œåˆ™`clk_1 & clk_2`å°±æ˜¯æˆ‘ä»¬æ‰€éœ€çš„åˆ†é¢‘ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå¶æ•°åˆ†é¢‘å’Œå¥‡æ•°åˆ†é¢‘ç»“åˆï¼Œå®ç°Nåˆ†é¢‘å™¨è®¾è®¡ï¼Œå…¶ä¸­Nä¸ºæ­£æ•´æ•°ï¼›é€šè¿‡N[0]é€‰æ‹©è¾“å‡ºï¼ŒN[0]=1ä¸ºå¥‡æ•°åˆ†é¢‘ï¼ŒN[0]=0ä¸ºå¶æ•°åˆ†é¢‘ã€‚\n\n5åˆ†é¢‘ç»“æœå¦‚ä¸‹ï¼š\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232040146.png)\n\n6åˆ†é¢‘ç»“æœå¦‚ä¸‹ï¼š\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232040660.png)\n\n**æ­£æ•´æ•°åˆ†é¢‘å™¨ä»£ç **\n\n```verilog\nmodule clk_div_integer #(\n    parameter N = 6,        //Nåˆ†é¢‘ï¼ŒNä¸ºæ•´æ•°\n    parameter WIDTH = 3     //è®¡æ•°å™¨ä½å®½\n) (\n    input wire clk,\n    input wire rstn,\n    output wire clk_out\n);\n\n    reg [WIDTH-1:0] cnt;\n    reg clk_1,clk_2;\n    wire clk_odd;\n\n    always @(posedge clk or negedge rstn) begin\n        if(~rstn) begin\n            cnt <= 0;\n        end\n        else begin\n            if(cnt == N-1) begin\n                cnt <= 0;\n            end\n            else begin\n                cnt <= cnt + 1'b1;\n            end\n        end\n    end\n\n    always @(posedge clk or negedge rstn) begin\n        if(~rstn) begin\n            clk_1 <= 1'b0;\n        end\n        else begin\n            if(cnt == ((N-1) >> 1)) begin\n                clk_1 <= 1'b1;\n            end\n            else if(cnt == (N-1))begin\n                clk_1 <= 1'b0;\n            end\n            else begin\n                clk_1 <= clk_1;\n            end\n        end\n    end\n\n    //æ³•1ï¼šåœ¨æ—¶é’Ÿä¸‹é™æ²¿é”å­˜clk_1å¾—åˆ°clk_2\n    always @(negedge clk or negedge rstn) begin\n        if(~rstn) begin\n            clk_2 <= 1'b0;\n        end\n        else begin\n            clk_2 <= clk_1;\n        end\n    end\n\n    //æ³•2:clk2ä¸clk_1äº§ç”Ÿçš„æ–¹å¼ç›¸åŒï¼Œå·®åˆ«æ˜¯clk_2æ˜¯ä¸‹é™æ²¿è§¦å‘\n    // always @(negedge clk or negedge rstn) begin\n    //     if(~rstn) begin\n    //         clk_2 <= 1'b0;\n    //     end\n    //     else begin\n    //         if(cnt == ((N-1) >> 1)) begin\n    //             clk_2 <= 1'b0;\n    //         end\n    //         else if(cnt == (N-1)) begin\n    //             clk_2 <= 1'b1;\n    //         end\n    //         else begin\n    //             clk_2 <= clk_2;\n    //         end\n    //     end\n    // end\n\n    assign clk_odd = clk_1 | clk_2;\n    assign clk_out = N[0] ? clk_odd : clk_1;\n    \nendmodule\n```\n\n## åŠæ•´æ•°åˆ†é¢‘å™¨\n\n**1ã€å ç©ºæ¯”é50%**\n\nç½‘ä¸Šæ¯”è¾ƒå¤šçš„åˆ†é¢‘æ€è·¯æ˜¯ï¼šåŠæ•´æ•°åˆ†é¢‘å¤šå‡ºæ¥çš„é‚£åŠä¸ªå‘¨æœŸä¸ºé«˜ç”µå¹³ï¼Œå…¶ä½™ä¸ºä½ç”µå¹³ã€‚ä»¥5.5åˆ†é¢‘ä¸ºä¾‹ï¼Œä»¥åŸæ—¶é’Ÿçš„åŠå‘¨æœŸä¸ºå•ä½ï¼Œå¯ä»¥åˆ†é¢‘è¾“å‡º1é«˜10ä½ã€‚åŸç†æ˜¯ç”¨è®¡æ•°å™¨å¾ªç¯è®°æ•°0~10å³11ä¸ªå‘¨æœŸï¼Œæ§åˆ¶è¾“å‡º`clk_1`å‰6å‘¨æœŸé«˜ç”µå¹³ï¼Œå5å‘¨æœŸä½ç”µå¹³ï¼Œç„¶åå†ä½¿ç”¨è¯¥è®¡æ•°å™¨å¾—åˆ°ä¸€ä¸‹é™æ²¿è§¦å‘çš„5ä½6é«˜çš„è¾“å‡º`clk_2`ï¼Œæœ€åè¾“å‡º`clk_out = clk_1 & clk_2`ã€‚æ³¢å½¢å›¾å¦‚ä¸‹å›¾æ‰€ç¤º\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232041944.png)\n\nç°åœ¨æˆ‘ä»¬è™½ç„¶å¾—åˆ°äº†5.5åˆ†é¢‘åçš„ä¿¡å·ï¼Œä½†å ç©ºæ¯”ä¸æ˜¯å¾ˆç†æƒ³ï¼Œæ˜¯å¦å¯ä»¥åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›æ¥å®ç°å ç©ºæ¯”è¿‘ä¼¼50%çš„åˆ†é¢‘ä¿¡å·å‘¢ï¼Ÿ\n\n**2ã€å ç©ºæ¯”è¿‘ä¼¼50%**\n\nç”±ä¸Šé¢çš„æ³¢å½¢å›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœ`clkx`å’Œ`clky`åœ¨`cnt`çš„å…¶å®ƒçŠ¶æ€(ç¨å¾®åå¤§çš„å€¼)è¿›è¡ŒçŠ¶æ€ç¿»è½¬çš„è¯ï¼Œå¯èƒ½è¾“å‡ºçš„`clk_out = clk_1 & clk_2`å°±èƒ½è¾¾åˆ°è¿‘ä¼¼50%çš„å ç©ºæ¯”ã€‚åœ¨å°è¯•åå‘ç°ï¼Œ`clkx`åœ¨`cnt`ç­‰äº`N+M`å’Œ`2N`æ—¶è¿›è¡ŒçŠ¶æ€ç¿»è½¬ï¼Œ`clky`åœ¨`cnt`ç­‰äº`N`å’Œ`M`æ—¶è¿›è¡ŒçŠ¶æ€ç¿»è½¬ï¼Œæ­¤æ—¶è¾“å‡ºçš„`clk_out = clk_1 & clk_2`è¿‘ä¼¼50%å ç©ºæ¯”ã€‚å…¶ä¸­Nä¸ºä¸è¶…è¿‡åˆ†é¢‘ç³»æ•°çš„æœ€å¤§æ•´æ•°ï¼Œå¦‚5.5åˆ†é¢‘æ—¶`N=5`ï¼Œå½“Nä¸ºå¥‡æ•°æ—¶`M=(N-1)/2`ï¼Œå½“Nä¸ºå¶æ•°æ—¶`M=(N+1)/2`\n\nå ç©ºæ¯”è¿‘ä¼¼50%çš„4.5åˆ†é¢‘çš„æ³¢å½¢å›¾å¦‚ä¸‹æ‰€ç¤º\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232041417.png)\n\n**åŠæ•´æ•°åˆ†é¢‘å™¨ä»£ç **\n\n```verilog\n`timescale 1ns/1ns\nmodule clk_div_half #(\n    parameter N = 5             //5.5åˆ†é¢‘æ—¶N=5,ä»¥æ­¤ç±»æ¨\n) (\n    input wire clk,\n    input wire rstn,\n    output wire clk_div\n);\n\n    //localparam M = 0;                                           //å ç©ºæ¯”é50%ï¼Œé«˜ç”µå¹³ä»…æœ‰åŠå‘¨æœŸ\n    localparam M = N[0] ? ((N - 1) >> 1) : ((N + 1) >> 1);        //å ç©ºæ¯”è¿‘ä¼¼50%\n    reg [31:0] cnt;\n    reg clkx,clky;\n\n    always @(posedge clk or negedge rstn) begin\n       if(~rstn) begin\n           cnt <= 32'd0;\n       end\n       else if(cnt == (N<<1)) begin\n           cnt <= 32'd0;\n       end\n       else begin\n           cnt <= cnt + 1'b1;\n       end\n    end\n\n    always @(posedge clk or negedge rstn) begin\n        if(~rstn) begin\n            clkx <= 1'b0;\n        end\n        else if(cnt == N + M) begin\n            clkx <= 1'b0;\n        end\n        else if(cnt == (N << 1))begin\n            clkx <= 1'b1;\n        end\n    end\n\n    always @(negedge clk or negedge rstn) begin\n        if(~rstn) begin\n            clky <= 1'b0;\n        end\n        else if(cnt == N) begin\n            clky <= 1'b1;\n        end\n        else if(cnt == M) begin\n            clky <= 1'b0;\n        end\n    end\n\n    assign clk_div = clkx & clky;\n    \nendmodule\n```\n\n## å°æ•°åˆ†é¢‘å™¨\n\nä»¥8.7åˆ†é¢‘ä¸ºä¾‹æ¥åˆ†æå°æ•°åˆ†é¢‘å™¨çš„è®¾è®¡ã€‚å› ä¸ºæ— æ³•ç”¨è®¡æ•°å™¨è¡¨ç¤º0.7è¿™ç§æ•°å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸ªç­‰æ•ˆçš„æ¦‚å¿µæ¥å®ç°8.7åˆ†é¢‘ï¼ŒåŸæ—¶é’Ÿ87ä¸ªå‘¨æœŸçš„æ€»æ—¶é—´ç­‰äºåˆ†é¢‘åçš„æ—¶é’Ÿ10ä¸ªå‘¨æœŸçš„æ€»æ—¶é—´ã€‚\n\nå› ä¸º8.7åˆ†é¢‘åœ¨8åˆ†é¢‘å’Œ9åˆ†é¢‘ä¹‹é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨8åˆ†é¢‘å’Œ9åˆ†é¢‘æ¥ç»„åˆç”Ÿæˆ8.7åˆ†é¢‘çš„æ—¶é’Ÿã€‚å¯ä»¥åˆ—æ–¹ç¨‹ç»„ï¼Œè®¾8åˆ†é¢‘å…±xä¸ªå‘¨æœŸï¼Œ9åˆ†é¢‘å…±yä¸ªå‘¨æœŸï¼Œåˆ™\n\n- x+y=10\t\t\t\t\t(1)\n- 8*x + 9 *y = 87\t  (2)\n\nè§£å¾—x=3ï¼Œy=7ã€‚\n\nå³é€šè¿‡3æ¬¡8åˆ†é¢‘å’Œ7æ¬¡9åˆ†é¢‘å¯å¾—åˆ°8.7åˆ†é¢‘ã€‚ä½†å¦‚æœæ˜¯æŒ‰åºå…ˆè¾“å‡º3ä¸ª8åˆ†é¢‘å†è¾“å‡º7æ¬¡9åˆ†é¢‘çš„æ—¶é’Ÿç”¨å¤„ä¸å¤§ï¼Œæˆ‘ä»¬è¿˜å¾—ä¹±åº**ä½¿å…¶å‡åŒ€è¾“å‡ºï¼Œä¸ç„¶ä¼šé€ æˆæ—¶é’Ÿé¢‘ç‡å‡åŒ€æ€§ä¸å¥½ï¼Œç›¸ä½æŠ–åŠ¨å¤§çš„é—®é¢˜**ã€‚\n\næ­¤å¤„æˆ‘ä»¬ä»‹ç»è„‰å†²åˆ é™¤å°æ•°åˆ†é¢‘ï¼Œè¯¥æ–¹æ³•ç›¸å¯¹æ¯”è¾ƒç®€å•ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯è¯´æˆ‘åœ¨87ä¸ªè¾“å…¥æ—¶é’Ÿé‡Œåˆ æ‰77ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œè¿™æ ·ä¸å°±è¾“å‡ºäº†10ä¸ªæ—¶é’Ÿå‘¨æœŸäº†å—ï¼Ÿä¹Ÿå°±å®ç°äº†8.7åˆ†é¢‘ï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆåˆ å‘¢ï¼ŸæŸ¥é˜…è®ºæ–‡åå¾—åˆ°ç»“è®ºï¼š\n\n1. è®¾ç½®å¯„å­˜å™¨cntä½å®½è‡ªå®šï¼Œåˆå§‹å€¼ä¸º0ï¼›\n2. åœ¨`clk`çš„ä¸Šå‡æ²¿`cnt=cnt+åˆ†æ¯`ï¼Œå¹¶åˆ¤æ–­`cnt`æ˜¯å¦å¤§äºåˆ†å­ï¼Œè‹¥å¤§äºåˆ†å­åˆ™åœ¨ä¸‹ä¸€å‘¨æœŸå‡å»åˆ†å­ï¼›\n3. `cnt`å°äºåˆ†å­æ—¶ï¼Œè¾“å‡ºè„‰å†²ä¿¡å·ä¸º0ï¼Œ`cnt`å¤§äºåˆ†å­æ—¶ï¼Œè¾“å‡ºè„‰å†²ä¿¡å·ä¸º1ï¼›\n\nè¯´èµ·æ¥æ¯”è¾ƒä¹±ï¼Œæˆ‘ä»¬ä»¥7/3åˆ†é¢‘ä¸ºä¾‹æ¥çœ‹\n\n| æ—¶é’Ÿåºå· |   cnt   | è¾“å‡ºè„‰å†² |\n| :------: | :-----: | :------: |\n|    0     |    3    |    0     |\n|    1     |    6    |    0     |\n|    2     |    9    |    1     |\n|    3     | (12->)5 |    0     |\n|    4     |    8    |    1     |\n|    5     | (11->)4 |    0     |\n|    6     | (7->)0  |    1     |\n\nä»è¡¨ä¸­å¯ä»¥çœ‹åˆ°æ¯7ä¸ªå‘¨æœŸè¾“å‡º3ä¸ªè„‰å†²ï¼Œåˆšå¥½æ»¡è¶³åˆ†é¢‘è¦æ±‚ã€‚\n\n**å°æ•°åˆ†é¢‘å™¨ä»£ç **\n\n```verilog\n`timescale 1ns/1ns\nmodule clk_div_decimal #(\n    parameter fraction = 16'd87,       //åˆ†é¢‘çš„åˆ†å­\n    parameter denominator = 16'd10,    //åˆ†é¢‘çš„åˆ†æ¯\n    parameter cnt_width = 8            //è®¡æ•°å™¨çš„ä½å®½\n) (\n    input wire clk,\n    input wire rstn,\n    output reg clk_out\n);\n\n    reg [cnt_width-1:0] cnt;\n    always @(posedge clk or negedge rstn) begin\n        if(~rstn) begin\n            cnt <= 0;\n            clk_out <= 1'b0;\n        end\n        else if(cnt < fraction) begin\n            cnt <= cnt + denominator;\n            clk_out <= 1'b0;\n        end\n        else begin\n            cnt <= cnt + denominator - fraction;\n            clk_out <= 1'b1;\n        end\n    end\n    \nendmodule\n```\n\n8.7åˆ†é¢‘ç»“æœå¦‚ä¸‹\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232042586.png)\n\n3.25åˆ†é¢‘ç»“æœå¦‚ä¸‹\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232042675.png)\n\n## PLLåˆ†é¢‘\n\nè¿™é‡Œå°±ç»™å¤§å®¶ç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•åœ¨Vivadoä¸­å¯¹PLLè¿›è¡Œä¾‹åŒ–ã€‚\n\né¦–å…ˆæ‰“å¼€`vivado`ï¼Œæ–°å»ºä¸€ä¸ªRTLé¡¹ç›®ï¼Œç‚¹å‡»`Flow Navigator`çª—å£ä¸­çš„`IP Catalog`ï¼Œåœ¨`search`å¤„æœç´¢è‡ªå·±æƒ³è¦çš„IPæ ¸çš„åå­—ï¼Œä¾‹å¦‚è¾“å…¥`clock`å°±ä¼šæ‰¾åˆ°`Clocking Wizard`è¿™ä¸ªIPæ ¸ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\n\n![12](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232045234.png)\n\nåŒå‡»Clocking Wizard è¿™ä¸ªIPæ ¸ï¼Œå°±èƒ½å¼¹å‡ºé…ç½®çª—å£ï¼›æˆ‘ä»¬ç®€å•é…ç½®ä¸€äº›ä¿¡æ¯ï¼Œè¾“å…¥æ—¶é’Ÿä¸º100MHzï¼Œåˆ†é¢‘è¾“å‡ºä¸¤ä¸ªæ—¶é’Ÿï¼Œä¸€ä¸ªæ˜¯30MHzï¼Œä¸€ä¸ªæ˜¯18MHzï¼ŒæŸ¥çœ‹åˆ†é¢‘æ•ˆæœï¼›\n\n![13](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232045483.png)\n\n![14](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232045206.png)\n\nç‚¹å‡»Generate,ç”ŸæˆIPæ ¸ï¼Œç„¶ååœ¨sourceçª—å£å°±ä¼šå‡ºç°ä¸€ä¸ªæ–‡ä»¶\n\n![15](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232045112.png)\n\n![16](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232045177.png)\n\nä¸‹é¢å¯¹è¿™ä¸ªç”Ÿæˆçš„IPè¿›è¡Œä¾‹åŒ–ï¼Œæµ‹è¯•åˆ†é¢‘æ•ˆæœ\n\n![17](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232045911.png)\n\nå°†è¿™ä¸ªä¾‹åŒ–æ¨¡å—çš„ä¾‹ç¨‹æ·»åŠ åˆ°è‡ªå·±çš„é¡¶å±‚ä»¿çœŸä»£ç ä¸­ï¼Œå°±å¯ä»¥æŸ¥çœ‹åˆ†é¢‘ç»“æœäº†ã€‚\n\n------\n\næœ¬æ¬¡çš„åšå®¢å°±è®²åˆ°è¿™é‡Œï¼Œå…¶ä¸­PLLçš„ä½¿ç”¨è®²çš„å¾ˆæµ…æ˜¾ï¼Œå¤§å®¶è¦æƒ³æ·±å…¥å­¦ä¹ PLLçš„IPä½¿ç”¨çš„è¯å¯ä»¥å­¦ä¹ å®˜æ–¹æ–‡æ¡£ã€‚è‹¥æ–‡ç« ä¸­å­˜åœ¨ä»»ä½•é”™è¯¯æˆ–ä¸è¶³æ¬¢è¿å¤§å®¶æŒ‡æ­£ï¼Œæ¬¢è¿å¤§å®¶åœ¨åšå®¢ä¸‹æ–¹ç•™è¨€äº¤æµã€‚","tags":["Basics"],"categories":["IC","Basics"]},{"title":"ä¸ºä»€ä¹ˆDè§¦å‘å™¨éœ€è¦å»ºç«‹æ—¶é—´å’Œä¿æŒæ—¶é—´","url":"/2022/09/29/IC/Basic/ä¸ºä»€ä¹ˆDè§¦å‘å™¨éœ€è¦å»ºç«‹æ—¶é—´ä¸ä¿æŒæ—¶é—´/","content":"\n# ä¸ºä»€ä¹ˆDè§¦å‘å™¨éœ€è¦å»ºç«‹æ—¶é—´ä¸ä¿æŒæ—¶é—´\n\n## å®šä¹‰\n\n**å»ºç«‹æ—¶é—´**ï¼šæ—¶é’Ÿæœ‰æ•ˆæ²¿åˆ°æ¥ä¹‹å‰çš„æŸæ®µæ—¶é—´å†…ï¼Œæ•°æ®å¿…é¡»ç¨³å®šï¼Œè¿™æ®µæ—¶é—´ç§°ä¸ºå»ºç«‹æ—¶é—´ï¼Œç”¨Tsetupæˆ–è€…Tsuè¡¨ç¤ºã€‚\n\n**ä¿æŒæ—¶é—´**ï¼šæ—¶é’Ÿæœ‰æ•ˆæ²¿åˆ°æ¥ä¹‹åçš„æŸæ®µæ—¶é—´å†…ï¼Œæ•°æ®å¿…é¡»ç¨³å®šï¼Œè¿™æ®µæ—¶é—´æˆä¸ºä¿æŒæ—¶é—´ï¼Œç”¨Tholdæˆ–è€…Thè¡¨ç¤ºã€‚\n\næ—¶åºå›¾å¦‚ä¸‹\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232048432.png)\n\n## ä¸ºä»€ä¹ˆéœ€è¦å»ºç«‹æ—¶é—´å’Œä¿æŒæ—¶é—´\n\n[ä»CMOSåˆ°å»ºç«‹æ—¶é—´å’Œä¿æŒæ—¶é—´](https://zhuanlan.zhihu.com/p/120863919)è¿™ç¯‡æ–‡ç« é‡Œä½œè€…å·²ç»è®²çš„å¾ˆè¯¦ç»†äº†ï¼Œæˆ‘å°±ä¸å†èµ˜è¿°é”å­˜å™¨çš„åŸç†äº†ï¼Œå¤§å®¶æœ‰ç–‘é—®çš„è¯å¯ä»¥å…ˆå»çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œè¿™é‡Œæˆ‘åªç®€å•ä¸¾ä¾‹è®°å½•ä¸€ä¸‹æˆ‘ä¸ªäººå¯¹å»ºç«‹æ—¶é—´å’Œä¿æŒæ—¶é—´çš„ç†è§£ã€‚\n\næˆ‘ä»¬ä»Dè§¦å‘å™¨çš„é—¨çº§ç”µè·¯å¼€å§‹åˆ†æï¼ŒDè§¦å‘å™¨çš„é—¨çº§ç”µè·¯å¦‚ä¸‹ï¼š\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232048337.png)\n\nDè§¦å‘å™¨åœ¨æ—¶é’Ÿ(ä¸Šå‡)è¾¹æ²¿è¿›è¡Œæ•°æ®çš„é”å­˜ã€‚æˆ‘ä»¬è¿™é‡Œå‡è®¾åŸæ¥çš„è¾“å‡ºæ˜¯1ï¼Œå³ä»é”å­˜å™¨é”å­˜çš„æ•°æ®ä¸º1ï¼Œè¦é”å­˜çš„æ•°æ®æ˜¯0ï¼Œæ¥ç†è§£å»ºç«‹æ—¶é—´å’Œä¿æŒæ—¶é—´ã€‚\n\nè¦è®©æ—¶é’Ÿä¸Šå‡æ²¿ä¹‹åQè¾“å‡ºä¸º0ï¼Œå³è®©ä»é”å­˜å™¨çš„è¾“å‡ºå˜ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¦è®©ä¸»é”å­˜å™¨åœ¨æ—¶é’Ÿä¸Šå‡æ²¿ä¹‹åç¨³å®šåœ°é”å­˜ä½0ã€‚\n\næ€»ç»“è€Œè¨€ï¼Œ**åœ¨ä¸Šå‡æ²¿åˆ°æ¥åŠåˆ°æ¥ä¹‹åï¼Œä¸»é”å­˜å™¨è´Ÿè´£é”å­˜æ•°æ®ï¼Œè€Œä»é”å­˜å™¨è´Ÿè´£ä¼ è¾“ä¸»é”å­˜å™¨æ‰€é”å­˜å¥½çš„æ•°æ®ã€‚**è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬é‡ç‚¹åˆ†æ**ä¸»é”å­˜å™¨**å³å¯ã€‚\n\nä¸»é”å­˜å™¨çš„é—¨çº§ç”µè·¯ï¼š\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232048755.png)\n\n**1ã€å¦‚æœæ•°æ®çš„å»ºç«‹æ—¶é—´ä¸è¶³ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ**\n\næŒ‰æˆ‘ä»¬çš„å‡è®¾ï¼Œä¹Ÿå°±æ˜¯æ•°æ®(0)ç›¸å¯¹äºæ—¶é’Ÿä¸Šå‡æ²¿æ¥çš„æ™šäº†ã€‚å‡è®¾åœ¨T=0nsçš„æ—¶å€™ï¼Œclkä»0å˜æˆ1(ä¸ºæ–¹ä¾¿åˆ†æï¼Œå‡è®¾æ—¶é’Ÿç†æƒ³æ— è·³å˜å»¶æ—¶)ã€‚æˆ‘ä»¬å‡è®¾ä¸€ä¸ªæ•°æ®D1=0åœ¨T=-0.7ns(å³æ¯”æ—¶é’Ÿä¸Šå‡æ²¿æå‰0.7s)çš„æ—¶å€™åˆ°è¾¾æ•°æ®çš„ç«¯å£ï¼Œç„¶åå¦ä¸€ä¸ªæ•°æ®D2=0åœ¨T=-0.3nsçš„æ—¶å€™æ‰æ¥åˆ°æ•°æ®ç«¯å£(å³D1æ¥å¾—æ—©ï¼Œè€ŒD2æ¥å¾—æ¯”è¾ƒæ™šä¸æ»¡è¶³å»ºç«‹æ—¶é—´çš„è¦æ±‚)ã€‚æˆ‘ä»¬çœ‹çœ‹D1çš„è·¯çº¿ï¼Œé¦–å…ˆç»è¿‡åç›¸å™¨å˜ä¸º1ï¼Œç„¶åç»è¿‡ä¸é—¨(æ­¤æ—¶æ—¶é’Ÿè¿˜æ˜¯ä½ç”µå¹³ï¼Œè¯¥ä¸é—¨çš„å¦ä¸€ä¸ªè¾“å…¥ä¸º1)å˜æˆ1ï¼Œç»è¿‡æˆ–éé—¨ä¹‹åï¼Œå°†è¾“å‡ºQå˜æˆäº†0ã€‚\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232048629.png)\n\nä½†**æ­¤æ—¶ä¸»é”å­˜å™¨è¾“å‡ºçš„Qè¿˜ä¸ç¨³å®šï¼Œéœ€è¦é€šè¿‡åé¦ˆæ”¹å˜æˆ–éé—¨çš„è¾“å…¥æ‰èƒ½ä¿æŒè¾“å‡ºæ•°æ®çš„ç¨³å®šã€‚**å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€šè¿‡åé¦ˆä½¿å¾—è‡ªå·±æˆ–éé—¨çš„è¾“å…¥ä¸º1æ‰èƒ½ç»´æŒQçš„ç¨³å®šï¼Œéœ€è¦`t1+t2+t3`çš„æ—¶é—´ã€‚\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232048942.png)\n\næˆ‘ä»¬å†å›è¿‡å¤´çœ‹D2è¿™ä¸ªæ•°æ®ï¼Œå®ƒæå‰äºæ—¶é’Ÿæ²¿çš„æ—¶é—´ä¸å¤šï¼Œåˆšç»è¿‡ä¸é—¨æ—¶é’Ÿæ²¿å°±æ¥äº†ï¼Œ**æ²¡æœ‰æˆåŠŸé€šè¿‡åé¦ˆåˆ°è¾¾æˆ–éé—¨çš„è¾“å…¥**ï¼Œä¸èƒ½ç¨³å®šé”å­˜ä½ä»é”å­˜å™¨è¦é”å­˜çš„0å€¼ï¼Œè¿™å°±æ˜¯å»ºç«‹æ—¶é—´ä¸è¶³å¼•èµ·çš„é”å­˜ä¸ä½å€¼å¯¼è‡´äºšç¨³æ€çš„åŸå› ã€‚\n\n**2ã€å¦‚æœæ•°æ®çš„ä¿æŒæ—¶é—´ä¸è¶³ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ**\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232048433.png)\n\næˆ‘ä»¬çœ‹ä¿æŒæ—¶é—´ä»è¦ä»ä¸»é”å­˜å™¨è¿™è¾¹çœ‹ï¼š\n\nå‡è®¾T=0æ—¶åˆ»æ—¶é’ŸClkå‘ç”Ÿä»0->1çš„ä¸Šå‡æ²¿è·³å˜ï¼ŒClkçš„é«˜ç”µå¹³ä¿¡å·é¦–å…ˆè¦ç»è¿‡åç›¸å™¨å˜æˆ0ä¿¡å·åä¼ åˆ°åé¢çš„ä¸é—¨ï¼Œå¦‚ä¸Šå›¾ç»¿çº¿æ‰€ç¤ºè·¯å¾„ï¼Œå‡è®¾è¯¥è·¯å¾„å»¶è¿Ÿæ—¶é—´ä¸ºt2ï¼Œä¹Ÿå°±æ˜¯è¯´t2æ—¶åˆ»ä¸é—¨çš„è¾“å…¥å°±ä¸ºä½ç”µå¹³0ï¼Œé‚£ä¹ˆåœ¨t2æ—¶åˆ»ä¹‹å‰ï¼Œä¸é—¨çš„Clkè¾“å…¥ç«¯å§‹ç»ˆä¿æŒé«˜ç”µå¹³1ã€‚\n\nåœ¨t2ä¹‹å‰ï¼Œå¦‚æœè¾“å…¥ç«¯Då‘ç”Ÿè·³å˜(æŒ‰æˆ‘ä»¬çš„å‡è®¾ï¼Œä»0å˜ä¸º1ï¼Œå³æ•°æ®çš„ä¿æŒæ—¶é—´ä¸è¶³)ï¼Œå˜æ¢åçš„æ•°æ®ç«¯é«˜ç”µå¹³ç»è¿‡t1å»¶è¿Ÿæ—¶é—´å(ä¸Šå›¾è“çº¿æ‰€ç¤ºè·¯å¾„)ï¼Œåˆ°è¾¾ä¸é—¨çš„å¦ä¸€ä¸ªè¾“å…¥ç«¯ã€‚\n\nä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”±äºæ—¶é’Ÿä¿¡å·éœ€è¦ç»è¿‡åç›¸å™¨ï¼Œæ‰€ä»¥`t2>t1`ï¼Œ**é‚£ä¹ˆä¸é—¨çš„è¾“å‡ºåœ¨t1~t2æ—¶åˆ»ä¹‹é—´çš„æ—¶å€™è¾“å‡ºä¸º1ã€‚**ä¹Ÿå°±æ˜¯SRé”å­˜å™¨çš„ç½®ä½ç«¯ä¸º1ï¼Œè¿™ä¼šå¯¼è‡´Q=1ï¼Œè¿™ä¸æˆ‘ä»¬è¦é”å­˜çš„0å€¼ä¸åŒï¼Œå¯¼è‡´äºšç¨³æ€çš„å‡ºç°ã€‚\n\n## æ€»ç»“\n\n**å»ºç«‹æ—¶é—´ï¼šåœ¨æ—¶é’Ÿä¸Šå‡æ²¿åˆ°æ¥ä¹‹å‰ä¸»é”å­˜å™¨å°†æ•°æ®ç¨³å®šé”å­˜æ‰€éœ€çš„æ—¶é—´ã€‚**\n\n**ä¿æŒæ—¶é—´ï¼šåœ¨æ—¶é’Ÿä¸Šå‡æ²¿åˆ°æ¥ä¹‹åä¸»é”å­˜å™¨ä¼ è¾“é—¨å…³æ–­è‡³é”å­˜æ•°æ®çš„æ—¶é—´ã€‚**\n\n","tags":["Basics"],"categories":["IC","Basics"]},{"title":"Ubuntuå¼€å‘ç¯å¢ƒæ‰“é€ ","url":"/2022/09/23/Misc/Ubuntuå¼€å‘ç¯å¢ƒæ‰“é€ /","content":"\n# Ubuntuå¼€å‘ç¯å¢ƒæ‰“é€ \n\n\n\n## å®‰è£…ubuntu18.04\n\nä¸‹è½½ï¼š\n\n>   https://mirrors.tuna.tsinghua.edu.cn/\n\n\n\n## é…ç½®æ¸…åè½¯ä»¶æº\n\n> https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/\n\n\n\n## åŒç³»ç»Ÿæ—¶é—´ä¸åŒæ­¥é—®é¢˜\n\n```\ntimedatectl set-local-rtc 1 --adjust-system-clock\n```\n\n\n\n## å®‰è£…SynapticåŒ…ç®¡ç†å™¨\n\n``` \nsudo apt-get install synaptic\n```\n\n\n\n## å®‰è£…ç¼–è¯‘å¼€å‘ç¯å¢ƒ\n\n```\nsudo apt-get install build-essential\n```\n\n\n\n## Homeä¸‹ç›®å½•æ”¹æˆè‹±æ–‡\n\n```\n$ export LANG=en_US\n\n$ xdg-user-dirs-gtk-update\n\nè¿™ä¸ªæ—¶å€™ä¼šå¼¹å‡ºä¸€ä¸ªé…ç½®ç•Œé¢ï¼Œæç¤ºæ˜¯å¦å°†ä¸­æ–‡ç›®å½•åˆ‡æ¢ä¸ºè‹±æ–‡ç›®å½•ã€‚é€‰ä¸­ä¸å†æç¤ºï¼Œç¡®å®š\n\næœ€åå†æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿˜åŸåˆ°ç³»ç»Ÿä¹‹å‰çš„è®¾ç½®\n$ export LANG=zh_CN\n```\n\n\n\n## å®‰è£…å¹¶é…ç½®VS Code\n\nä¸‹è½½å®‰è£…åŒ…\n\n> https://code.visualstudio.com/\n\nå®‰è£…\n\n```\ndpkg -i [å®‰è£…åŒ…æ–‡ä»¶å]\n```\n\nå¯åŠ¨\n\n```\ncode\n```\n\nä»¥è¶…çº§ç”¨æˆ·å¯åŠ¨\n\n```\nsudo code --user-data-dir=\"/home/wg/.vscode/\"\n```\n\nå®‰è£…æ’ä»¶\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232124452.png)\n\n## Ubuntuå®‰è£…pytorch\n\nç‰ˆæœ¬ï¼špython3.6.9\n\nå®‰è£…pip\n\n```\nsudo apt-get install python3-pip\n```\n\næ›´æ¢é˜¿é‡Œæº\nä¿®æ”¹ ~/.pip/pip.conf (æ²¡æœ‰å°±åˆ›å»ºä¸€ä¸ª)ï¼Œ å†…å®¹å¦‚ä¸‹ï¼š\n\n```\n[global]\nindex-url = https://mirrors.aliyun.com/pypi/simple/\n```\n\nå‡çº§pip\n\n```\nsudo pip3 install --upgrade pip\n```\n\nå®‰è£…å¸¸ç”¨åŒ…\n\n```\npip3 install numpy\npip3 install opencv-python\npip3 install torch\npip3 install torchvision\n```\n\nä¸‹è½½ç¦»çº¿å®‰è£…åŒ…\ntorch\ttorchvision\t   python\t                cuda\n\n1.5.1\t0.6.1\t       >=3.6\t                9.2, 10.1,10.2\n\n1.5.0\t0.6.0\t       >=3.6\t                9.2, 10.1,10.2\n\n1.4.0\t0.5.0\t       ==2.7, >=3.5, <=3.8\t    9.2, 10.0\n\n1.3.1\t0.4.2\t       ==2.7, >=3.5, <=3.7\t    9.2, 10.0\n\n1.3.0\t0.4.1\t       ==2.7, >=3.5, <=3.7\t    9.2, 10.0\n\n1.2.0\t0.4.0\t       ==2.7, >=3.5, <=3.7\t    9.2, 10.0\n\n1.1.0\t0.3.0\t       ==2.7, >=3.5, <=3.7\t    9.0, 10.0\n\n<1.0.1\t0.2.2\t       ==2.7, >=3.5, <=3.7\t    9.0, 10.0\n\n```\nsudo pip install torch-1.4.0-cp36-cp36m-linux_x86_64.whl\nsudo pip install torchvision-0.5.0-cp36-cp36m-linux_x86_64.whl\n```\n\n\n\n## å®‰è£…Vivado 2018.2\n\nä¸‹è½½å®‰è£…åŒ…\n\n> https://china.xilinx.com/support/download.html\n\nè§£å‹\n\n```\ntar xvzf xxx.tar.gz\n```\n\næ‰§è¡Œå®‰è£…\n\n```\nsudo ./xsetup\n```\n\nå®‰è£…è·¯å¾„é€‰æ‹©é»˜è®¤\n\nå®‰è£…JTAGé©±åŠ¨\n\n```\ncd /opt/Vivado/2018.2/data/xicom/cable_drivers/lin64/install_script/install_drivers/\nsudo ./install_drivers\n```\n\nè®¾ç½®ç¯å¢ƒå˜é‡\n\n```\nsudo gedit .bashrc\n```\n\næ·»åŠ å‘½ä»¤åˆ«å\n\n```\nalias svvd='source /opt/Xilinx/Vivado/2018.2/settings64.sh'\n```\n\nå¯åŠ¨\n\n```\n#å¯åŠ¨Vivado\n$ vivado\n\n#å¯åŠ¨Vivado HLS\n$ vivado_hls\n\n#å¯åŠ¨XSDK\n$ xsdk\n```\n\n\n\n## å®‰è£…SSHæœåŠ¡å¹¶å¼€æœºè‡ªå¯\n\n```\nsudo apt-get install openssh-server\nsudo systemctl enable ssh\nsudo systemctl status ssh\n```\n\n\n\n## å®‰è£…GHex\n\n```shell\nsudo apt-get install ghex\n```\n\n\n\n## å®‰è£…Typora\n\n> https://typora.io/#linux\n\n```shell\n# or run:\n# sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys BA300B7755AFCFAE\nwget -qO - https://typora.io/linux/public-key.asc | sudo apt-key add -\n\n# add Typora's repository\nsudo add-apt-repository 'deb https://typora.io/linux ./'\nsudo apt-get update\n\n# install typora\nsudo apt-get install typora\n```\n\n\n\n## å®‰è£…åšæœäº‘ï¼ˆNutStoreï¼‰\n\n> https://www.jianguoyun.com/s/downloads/linux\n\n```\nsudo dpkg -i nautilus_nutstore_amd64.deb\nsudo apt-get install -f\n```\n\n\n\n## å®‰è£…ç½‘æ˜“äº‘éŸ³ä¹\n\n> https://music.163.com/#/download\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232125711.png)\n\n```\nsudo dpkg -i xxx.deb\n```\n\n\n\n## å®‰è£…FlameShot\n\nä¸‹è½½å®‰è£…åŒ…\n\n> https://github.com/lupoDharkael/flameshot/releases\n\nrpmåŒ…æ˜¯yumçš„å®‰è£…æ–‡ä»¶ï¼Œ.debåŒ…æ‰æ˜¯Ubuntuå®‰è£…åŒ…\n\n- bionicï¼šUbuntu18.04çš„ç‰ˆæœ¬å\n\n- jessieï¼šDebian8.6ç‰ˆæœ¬çš„ç‰ˆæœ¬å\n\n- stretchï¼šDebian9çš„ç‰ˆæœ¬å\n\n```shell\ndpkg -i flameshot_0.6.0_bionic_x86_64.deb\n```\n\nåˆ›å»ºæˆªå›¾å¿«æ·é”®\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232125490.png)\n\n## ç ´è§£å®‰è£…Beyond Compare\n\n> http://www.scootersoftware.com/download.php\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232125626.png)\n\nä¸‹è½½64ä½çš„.debåŒ…ï¼Œ\n\n```\ndpkg -i [å®‰è£…åŒ…æ–‡ä»¶å]\n```\n\n**ç ´è§£**\n\n```\nè½¬åˆ°å®‰è£…è·¯å¾„ï¼š\ncd /usr/lib/beyondcompare/\n```\n\n```\nsudo sed -i \"s/keexjEP3t4Mue23hrnuPtY4TdcsqNiJL-5174TsUdLmJSIXKfG2NGPwBL6vnRPddT7tH29qpkneX63DO9ECSPE9rzY1zhThHERg8lHM9IBFT+rVuiY823aQJuqzxCKIE1bcDqM4wgW01FH6oCBP1G4ub01xmb4BGSUG6ZrjxWHJyNLyIlGvOhoY2HAYzEtzYGwxFZn2JZ66o4RONkXjX0DF9EzsdUef3UAS+JQ+fCYReLawdjEe6tXCv88GKaaPKWxCeaUL9PejICQgRQOLGOZtZQkLgAelrOtehxz5ANOOqCaJgy2mJLQVLM5SJ9Dli909c5ybvEhVmIC0dc9dWH+/N9KmiLVlKMU7RJqnE+WXEEPI1SgglmfmLc1yVH7dqBb9ehOoKG9UE+HAE1YvH1XX2XVGeEqYUY-Tsk7YBTz0WpSpoYyPgx6Iki5KLtQ5G-aKP9eysnkuOAkrvHU8bLbGtZteGwJarev03PhfCioJL4OSqsmQGEvDbHFEbNl1qJtdwEriR+VNZts9vNNLk7UGfeNwIiqpxjk4Mn09nmSd8FhM4ifvcaIbNCRoMPGl6KU12iseSe+w+1kFsLhX+OhQM8WXcWV10cGqBzQE9OqOLUcg9n0krrR3KrohstS9smTwEx9olyLYppvC0p5i7dAx2deWvM1ZxKNs0BvcXGukR+/g\" BCompare\n```\n\nç„¶åæ‰“å¼€Beyond Conpareï¼Œå¼¹å‡ºTrial Mode Errorï¼å¼¹çª—\n\nå•å‡»å³ä¸‹è§’æŒ‰é’®â€œEnter Keyâ€ï¼Œè¾“å…¥ä»¥ä¸‹ç§˜é’¥ã€æ³¨æ„ï¼šåŒ…æ‹¬å¼€å§‹å’Œç»“å°¾çš„æ¨ªçº¿è¡Œã€‘\n\n```\n--- BEGIN LICENSE KEY ---\nGXN1eh9FbDiX1ACdd7XKMV7hL7x0ClBJLUJ-zFfKofjaj2yxE53xauIfkqZ8FoLpcZ0Ux6McTyNmODDSvSIHLYhg1QkTxjCeSCk6ARz0ABJcnUmd3dZYJNWFyJun14rmGByRnVPL49QH+Rs0kjRGKCB-cb8IT4Gf0Ue9WMQ1A6t31MO9jmjoYUeoUmbeAQSofvuK8GN1rLRv7WXfUJ0uyvYlGLqzq1ZoJAJDyo0Kdr4ThF-IXcv2cxVyWVW1SaMq8GFosDEGThnY7C-SgNXW30jqAOgiRjKKRX9RuNeDMFqgP2cuf0NMvyMrMScnM1ZyiAaJJtzbxqN5hZOMClUTE+++\n--- END LICENSE KEY -----\n```\n\nç ´è§£æˆåŠŸçš„é‡è¦æ ‡å¿—\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232126402.png)\n\nåŠ¡å¿…å–æ¶ˆæ›´æ–°æ£€æµ‹ï¼ˆå¦åˆ™ç ´è§£è¿‡ä¸€æ®µæ—¶é—´å°±ä¼šå¤±æ•ˆï¼‰\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232126083.png)\n\n**ç ´è§£å¤±æ•ˆçš„è§£å†³åŠæ³•**\n\nåˆ é™¤å¦‚ä¸‹çš„ä¸¤ä¸ªæ–‡ä»¶å³å¯\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232127803.png)\n\n## å®‰è£…å¹¶é…ç½®Synergy\n\n```\nsudo apt install synergy\n```\n\né‡åˆ°é—®é¢˜system tray is unavailable, don't close your windowï¼Œè§£å†³ï¼š\n\n```bash\nsudo apt-get install sni-qt\n```\n\n> https://vvplus.net/multi-computer-screen-sharing-keyboard-mouse-synergy1-8-8-stable-windows10-mac-linux-download-configuration.html\n\nå¯ç”¨æ³¨å†Œç ï¼š\n```\n7B76313B70726F3BE5BDAC20E585B33B313B73796E313333323040676D61696C2E636F6D3B3B3B7D\n```\n\n\n\n## è®¾ç½®å¼€æœºå¯åŠ¨é¡¹\n\n```\nsudo apt install gnome-tweak-tool\n```\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232127621.png)\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232128108.png)\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232128032.png)\n\n## æ— æ³•è¯†åˆ«exfatæ ¼å¼åˆ†åŒº\n\n```\nsudo apt install exfat-utils\n```\n\n\n\n## Firefoxæ— æ³•æ’­æ”¾bilibiliè§†é¢‘\n\næç¤ºæœªå®‰è£…flashï¼Œå®é™…ä¸Šæ˜¯ç¼ºå°‘æœ¬åœ°è§£ç å™¨ï¼Œå¯ä»¥é€šè¿‡å®‰è£…~~mplayer~~è§£å†³ï¼Œï¼ˆmplayeræ— ç•Œé¢ï¼Œè½¬è€Œå®‰è£…vlcï¼‰\n\n```\nsudo apt install vlc\n```\n\n\n\n## vlcæ— æ³•æ’­æ”¾H.264è§†é¢‘\n\n```\nsudo apt-get install ubuntu-restricted-extras\n```\n\n\n\n## å®‰è£…æœç‹—è¾“å…¥æ³•\n\nä¸‹è½½.deb\n\nhttps://pinyin.sogou.com/linux/\n\nå®‰è£…è¿‡ç¨‹\n\nhttps://pinyin.sogou.com/linux/help.php\n\nå®‰è£…ç»“æŸåå¸è½½ibusæ¡†æ¶ç›¸å…³ç»„ä»¶ï¼Œåªä¿ç•™fcitxæ¡†æ¶\n\næŸ¥çœ‹æ—¥å¿—ï¼Œæœç‹—æç¤ºlibpng12.0.soæ‰¾ä¸åˆ°ï¼Œï¼ˆ18.04å·²ç»å®‰è£…äº†libpng16ï¼Œä¸èƒ½é€šè¿‡aptå®‰è£…libpng12ï¼Œåªèƒ½æ‰‹åŠ¨ä¸‹è½½debåŒ…å®‰è£…ï¼‰\n\n> https://mirrors.ustc.edu.cn/ubuntu/pool/main/libp/libpng/\n\nå®‰è£…åï¼Œæœç‹—çš„é¡¶æ å›¾æ ‡æ­£å¸¸ï¼ŒXilinxçš„Docnavä¹Ÿå¯ä»¥æ‰“å¼€ã€‚\n\nä½†å®‰è£…åï¼Œå‡ºç°äº†ä¸¤ä¸ªæœç‹—è¾“å…¥æ³•çš„å›¾æ ‡ï¼Œæ­¤æ—¶å¯¹fcitxè¿›è¡Œé…ç½®ï¼Œéšè—fcitxçš„å›¾æ ‡ã€‚\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232128452.png)\n\n## è§£å†³AIR 14 2020çš„å£°éŸ³ä¼ªè¾“å‡ºçš„é—®é¢˜\n\næœ¬é—®é¢˜å¯èƒ½ç”±äº5.4å†…æ ¸å¯¹è‹±ç‰¹å°”æœ€æ–°ç¡¬ä»¶çš„æ”¯æŒä¸è¶³å¯¼è‡´çš„ã€‚\n\nstep1ï¼šå¯¹äºUbuntu18.04ï¼Œå‡çº§å†…æ ¸ç›¸å…³çš„åŒ…åˆ°æœ€æ–°ç‰ˆæœ¬ï¼ˆgrub\\*ï¼Œlinux\\*ï¼‰\n\nstep2ï¼šåœ¨/etc/modprobe.d/alsa-base.confæ·»åŠ ä¸­\n\n```\noptions snd-hda-intel dmic_detect=0\næˆ–è€…\noptions snd-intel-dspcfg dsp_driver=1ï¼ˆä½¿ç”¨dspè€Œä¸æ˜¯sofï¼‰\n```\n\né‡å¯åæ£€æŸ¥æ˜¯å¦æœ‰å£°éŸ³ï¼Œ\n\nstep3ï¼šé‡æ–°å®‰è£…ï¼ˆalsa\\*ï¼Œä¸åŒ…æ‹¬alsa-toolsç­‰ï¼‰ï¼ˆpulseaudio\\*ï¼‰ç­‰åŒ…ï¼Œgstreamer1.0-alsaï¼Œgstreamer1.0-pulseaudioç­‰åŒ…ï¼Œ\n\né‡å¯ã€‚\n\n\n\n## è®¾ç½®GRUB2é»˜è®¤å¯åŠ¨æ“ä½œç³»ç»Ÿ\n\n```\nsudo gedit /etc/default/grub\n```\n\n```\n# è®¾å®šé»˜è®¤å¯åŠ¨é¡¹ï¼Œæ¨èä½¿ç”¨æ•°å­—ï¼ˆ0ä»£è¡¨ç¬¬1é¡¹ï¼Œ1 >0ä»£è¡¨ç¬¬2é¡¹çš„ç¬¬1å­é¡¹ï¼‰\nGRUB_DEFAULT=2\n\n#æ˜¾ç¤ºå€’è®¡æ—¶\nGRUB_TIMEOUT_STYLE=countdown\n\n#è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º10ç§’\nGRUB_TIMEOUT=6\n```\n\n**è®°å¾—**\n\n```\nsudo update-grub \n```\n\n\n\n## å®‰è£…æ¸…ç†å·¥å…·Bleachbit\n\n```\nsudo apt install bleachbit\n```\n\n\n\n## å®‰è£…PDFæ‰¹æ³¨è½¯ä»¶Xournal\n\n```\nsudo apt install xournal\n```\n\n\n\n## å®‰è£…ç”µå­ä¹¦ç®¡ç†å™¨Calibre\n\n```\nsudo apt install calibre\n```\n\n\n\n## å®‰è£…éŸ³é¢‘ç¼–è¾‘è½¯ä»¶Audacity\n\n```\nsudo apt install audacity\n```\n\n\n\n## å®‰è£…çŸ¢é‡ç»˜å›¾è½¯ä»¶Inkscape\n\n```\nsudo apt install inkscape\n```\n\n\n\n## å®‰è£…å‡ ä½•ç”»æ¿è½¯ä»¶GeoGebra\n\n```\nsudo apt install geogebra\n```\n\n\n\n## å®‰è£…ç§‘å­¦è®¡ç®—è½¯ä»¶Octave\n\n```\nsudo apt install octave\n```\n\n\n\n## å®‰è£…utoolsæ’ä»¶æ¡†æ¶\n\n> https://u.tools/\n\n```\nsudo dpkg -i xxx.deb\n```\n\nå®‰è£…ä¸‹é¢çš„æ’ä»¶\n\n![12](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232129296.png)\n\n## ç ´è§£å®‰è£…Xmind\n\nä¸‹è½½è¡¥ä¸ï¼ˆapp.asarï¼‰ï¼Œ\n\n> https://www.ghpym.com/xmindzen.html\n\nå®‰è£…å®˜æ–¹ç¨‹åºï¼Œ\n\n> https://www.xmind.cn/download/\n\nç„¶åè¿›å…¥ç¨‹åºç›®å½•/opt/XMind ZEN/XMind/resources\næ›¿æ¢æ­¤ç›®å½•çš„app.asar æ–‡ä»¶å³å¯\n\n![13](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232129487.png)\n\n## å®‰è£…VMware\n\n> https://www.vmware.com/go/downloadworkstation\n\n```\nsudo sh ./VMware-Workstation-Full-15.5.6.x86_64.bundle\n```\n\næ˜¾ç¤ºSuccessfulåˆ™æˆåŠŸ\n\n\n\n## å®‰è£…Gnome Shellæ’ä»¶\n\næ‰“å¼€Gnomeè½¯ä»¶ä¸­å¿ƒï¼Œé€‰æ‹©é™„åŠ ç»„ä»¶ï¼Œ\n\n![14](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232130975.png)\n\nå·²å®‰è£…ï¼š\n\n- Bing wallpaper\n- Workspace indicator\n- NetSpeed\n\nåœ¨è¿™é‡Œè¿›è¡Œç®¡ç†ï¼Œ\n\n![15](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232130925.png)\n\n## å±è”½é‚®ä»¶æœåŠ¡ç¨‹åºçš„å¼€æœºè‡ªå¯\n\n```\nsystemctl --user mask evolution-addressbook-factory.service evolution-calendar-factory.service evolution-source-registry.service\n```\n\n\n\n## æŸ¥çœ‹dpkgå®‰è£…æ—¥å¿—\n\n```\ngrep \"\\ install\\ \" /var/log/dpkg.log\n```\n\n\n\n## å®‰è£…Windowså­—ä½“\n\nä»Windowsç³»ç»Ÿä¸­æ‰¾åˆ°ç›¸åº”å­—ä½“æ–‡ä»¶ï¼›\n\n```\nsudo mkdir /usr/share/fonts/truetype/windows-font\n```\n\næ‹·è´å­—ä½“åˆ°Windowsç›®å½•ä¸‹\n\n```\nsudo chmod -R 777  /usr/share/fonts/truetype/windows-font\ncd /usr/share/fonts/truetype/windows-font\nmkfontscale\nmkfontdir\nfc-cache -fv\n```\n\n\n\n## é…ç½®ç§‘å­¦ä¸Šç½‘ï¼ˆç§‘æŠ€ç†Šã€å…‰é€Ÿäº‘ï¼‰\n\n> https://kejibearstudio.tk/\n\n> https://kejibearstudio.tk/user/tutorial?os=linux&client=clash\n\nä¸‹è½½clashçš„äºŒè¿›åˆ¶æ–‡ä»¶\n\nhttps://github.com/Dreamacro/clash/releases\n\nä¸‹è½½æœºåœºçš„é…ç½®æ–‡ä»¶\n\n```\nå…‰é€Ÿäº‘\nwget -O gsy-config.yaml \"https://136900.xyz/link/glLP6b5aqiOxa6Xg?clash=1&log-level=info\"\n\nç§‘æŠ€ç†Š\nwget -O kjx-config.yaml \"https://service-6wrorr47-1254266595.sh.apigw.tencentcs.com/link/MKKO2wk7drvLpKrp?clash=1&log-level=info\"\n```\n\nå¯¹äºå…‰é€Ÿäº‘\n\néœ€è¦ä¿®æ”¹`gsy-config.yaml`\n\n```\nåˆ é™¤ trojan æµ‹è¯• é¡¹\n```\n\næ‰§è¡Œ\n\n```\n./clash  -d .  -f gsy-config.yaml\n```\n\n> Usage of ./clash:\n>   -d string\n>     \tset configuration directory\n>   -ext-ctl string\n>     \toverride external controller address\n>   -ext-ui string\n>     \toverride external ui directory\n>   -f string\n>     \tspecify configuration file\n>   -secret string\n>     \toverride secret for RESTful API\n>   -t\ttest configuration and exit\n>   -v\tshow current version of clash\n\nä½¿ç”¨æµè§ˆå™¨è®¿é—®\n\nhttp://clash.razord.top/#/proxies\n\næ‰“å¼€ç³»ç»Ÿä»£ç†\n\næ‰“å¼€ç³»ç»Ÿè®¾ç½®ï¼Œé€‰æ‹©ç½‘ç»œï¼Œç‚¹å‡»ç½‘ç»œä»£ç†å³è¾¹çš„ âš™ æŒ‰é’®ï¼Œé€‰æ‹©æ‰‹åŠ¨ï¼Œå¡«å†™ HTTP å’Œ HTTPS ä»£ç†ä¸º `127.0.0.1:7890`ï¼Œå¡«å†™ Socks ä¸»æœºä¸º `127.0.0.1:7891`ï¼Œå³å¯å¯ç”¨ç³»ç»Ÿä»£ç†ã€‚\n\n![16](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232130527.png)\n\nè®¾ç½®å¼€æœºå¯åŠ¨\n\n```\nsh -c \"(sleep 15 && cd /home/kopera/Tools/ && clash -d . -f gsy-config.yaml)\"\n```\n\n\n\n## GNOME3å®‰è£…ä¸»é¢˜ä¸å›¾æ ‡åŒ…\n\n**theme**ï¼šæ§åˆ¶çª—å£æ ·å¼\n\n**shell theme**ï¼šæ§åˆ¶é¡¶æ æ ·å¼ï¼ˆå¯ä»¥ä¸å¯ç”¨ï¼‰\n\n> https://www.pling.com/p/1334194/\n\nåœ¨`home`ä¸‹å»ºç«‹`.themes`æ–‡ä»¶å¤¹ï¼Œæ”¾å…¥ä¸‹è½½çš„ä¸»é¢˜åŒ…åï¼Œä»gnome-tweak-toolä¸­é€‰æ‹©\n\n**icon theme**ï¼šæ§åˆ¶å›¾æ ‡æ ·å¼\n\n> https://www.pling.com/p/1279924/\n\nåœ¨`home`ä¸‹å»ºç«‹`.icons`æ–‡ä»¶å¤¹ï¼Œæ”¾å…¥ä¸‹è½½çš„å›¾æ ‡åŒ…åï¼Œä»gnome-tweak-toolä¸­é€‰æ‹©\n\n\n\n## å®‰è£…Foxit Readeré˜…è¯»å™¨\n\n> https://www.foxitsoftware.cn/\n\n![17](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232131679.png)\n\n![18](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232131998.png)\n\nä¸‹è½½`.run`æ–‡ä»¶ï¼Œä½¿ç”¨sudoæƒé™å®‰è£…è‡³`/opt/Foxit`ä¸‹\n\n\n\n## å®‰è£…CopyTranslator\n\n> https://github.com/CopyTranslator/CopyTranslator/releases\n\n\n\n## å®‰è£…balenaEtcher\n\n> https://www.balena.io/etcher/\n>\n> https://github.com/balena-io/etcher/releases\n\n\n\n## å®‰è£…Free Download Manager\n\n> https://www.freedownloadmanager.org/zh/download-fdm-for-linux.htm\n\n\n\n## åŸºäºVScode+Vivadoçš„HDLä»¿çœŸç¯å¢ƒ\n\nå®‰è£…æ’ä»¶ï¼š\n\n![19](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232133836.png)\n\né…ç½®æ’ä»¶ï¼š\n\n![20](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232133328.png)\n\nä¿®æ”¹æ’ä»¶æºç ï¼ˆä»¥æ”¯æŒlinuxå¹¶ä¸”å»æ‰æ— æ•ˆåŠŸèƒ½ï¼‰\n\n![21](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232133204.png)\n\n![22](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232133260.png)\n\nä¿®æ”¹æ’ä»¶æºç ï¼ˆä¿®æ”¹ç”Ÿæˆæ ·å¼ï¼‰\n\n![23](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232133268.png)\n\nMakefile\n\n```makefile\n#æŒ‡å®šç»¼åˆçš„é¡¶å±‚æ¨¡å—\nSYNTH_TOP = pc\n\n#æŒ‡å®šä»¿çœŸçš„é¡¶å±‚æ¨¡å—\nSIM_TOP = $(SYNTH_TOP)_tb\n\n#æŒ‡å®šæ–°å»ºå·¥ç¨‹çš„åºå·\nINDEX = $(N)\n\n#æŒ‡å®šåšæœäº‘åŒæ­¥ç›®å½•\nCur_Dir = $(shell basename `pwd`)\nNut_Path = /home/wg/Nutstore\\ Files/æˆ‘çš„åšæœäº‘/Coding/Verilog\n\n#æ–°å»ºæ–‡ä»¶\ncreate:\n\ttouch src/$(SIM_TOP).v\n\ttouch src/$(SYNTH_TOP).v\n\n#ç¼–è¯‘\nbuild:\n\tmkdir batch_sim\n\tcd batch_sim && xvlog --work mylib ../src/*.v\n\tcd batch_sim && xelab --debug typical -s simTest mylib.$(SIM_TOP)\n\n#é¦–æ¬¡ä»¿çœŸï¼ˆBatch Modeï¼‰\nfirst:\n\tcd batch_sim && xsim simTest -gui -wdb wave_data.wdb\n\n#ä»¿çœŸï¼ˆå¸¦æ³¢å½¢é…ç½®ï¼‰\ntest:\n\tcd batch_sim && xsim simTest -gui -wdb wave_data.wdb -view ../wave_config.wcfg\n\n#æ¸…ç©ºè¾“å‡º\nclean:\n\trm -r batch_sim vvd_prj\n\n#è°ƒè¯•ï¼ˆProject Modeï¼‰\ndebug:\n\tmkdir vvd_prj\n\tcd ./vvd_prj && vivado -mode tcl -source ../run_sim.tcl -tclargs $(SIM_TOP) $(SYNTH_TOP)\n\n#å¯åŠ¨Vivadoå·¥ç¨‹\nlaunch:\n\tcd ./vvd_prj && vivado debug_prj.xpr\n\n#å¦å­˜å·¥ä½œç©ºé—´\nnew_prj:\n\tmkdir ../demoT_$(INDEX)\n\tcp -r src ../demoT_$(INDEX)\n\tcp Makefile run_sim.tcl ../demoT_$(INDEX)\n\t\n#æ¨é€åšæœäº‘\npush_Nut:\n\tmkdir $(Nut_Path)/$(Cur_Dir)\n\tcp -r src $(Nut_Path)/$(Cur_Dir)\n\tcp Makefile run_sim.tcl $(Nut_Path)/$(Cur_Dir)\n```\n\nTclè„šæœ¬\n\n```tcl\nset sim_top [lindex $argv 0]\nset synth_top [lindex $argv 1]\n\ncreate_project debug_prj\n\nadd_files -fileset sources_1 -norecurse [glob ../src/*.v]\n\nset_property top $synth_top [current_fileset]\nupdate_compile_order -fileset [current_fileset]\n\nset_property top $sim_top [get_filesets sim_1]\nupdate_compile_order -fileset sim_1\n\nset_property -name {xsim.simulate.runtime} -value {30ns} -objects [get_filesets sim_1]\nlaunch_simulation -mode behavioral\nstart_gui\n```\n\n# è‡´è°¢\n\næ„Ÿè°¢èˆå‹è€ç‹çš„å€¾åŠ›æ”¯æŒ\n","tags":["Ubuntu"],"categories":["Misc","Ubuntu"]},{"title":"æˆ‘çš„å®ä¹ å°ç»“","url":"/2022/09/12/Interview/å®ä¹ å°ç»“/","content":"\n# æˆ‘çš„å®ä¹ å°ç»“\n\n## å­—èŠ‚è·³åŠ¨\n\nå­—èŠ‚è·³åŠ¨å¼€å§‹çš„æ¯”è¾ƒæ—©ï¼Œåœ¨2æœˆä¸­æ—¬çš„æ—¶å€™å¼€æ”¾æŠ•é€’ã€‚æˆ‘æ˜¯2æœˆ20æ—¥æ™šæŠ•é€’ç®€å†ï¼Œ2æœˆ21æ—¥<u>ç®€å†æŒ‚</u>ï¼Œåé¦ˆå¾ˆå¿«ã€‚è·Ÿå†…æ¨çš„å­—èŠ‚å¸ˆå…„äº¤æµåå‘ç°ï¼Œæ˜¯æˆ‘æŠ•é€’çš„ä¸Šæµ·éƒ¨é—¨é‚£è¾¹ä¸ç¼ºäººï¼Œæ‰€ä»¥ç›´æ¥ç®€å†æŒ‚ã€‚ç„¶åå¸ˆå…„å¸®æˆ‘è½¬æ—¥å¸¸å®ä¹ ï¼ŒbaseåŒ—äº¬ï¼Œç®—æ˜¯è¢«æäº†ã€‚\n\n![å›¾5.png](https://img-blog.csdnimg.cn/img_convert/b74ce162cb73e504052ff197613ce9c2.png)\n\né‡æ–°ç®€å†è¯„ä¼°åï¼Œ2æœˆ23æ—¥çº¦æˆ‘ï¼Œ3.1ä¸€é¢ï¼Œ3.8äºŒé¢ï¼Œ3.17ä¸‰é¢ï¼Œ3.28hré¢ï¼Œ3.30offer callã€‚\n\n### ä¸€é¢æŠ€æœ¯é¢ï¼ˆ3.1ï¼‰\n\n1ã€é¢è¯•å®˜ä¸€ä¸Šæ¥ç»™æˆ‘ç®€è¦ä»‹ç»äº†é¢è¯•çš„æµç¨‹ï¼Œè‡ªæˆ‘ä»‹ç»5-10minå·¦å³ï¼Œå‰©ä¸‹çš„è¯æ˜¯åŸºç¡€çŸ¥è¯†è€ƒæ ¸+æ’•é¢˜ã€‚ï¼ˆæœ‰ç‚¹æ…Œï¼Œæ²¡æœ‰é—®ä¸€ç‚¹é¡¹ç›®ï¼Œå¯èƒ½æ˜¯é¡¹ç›®ä¸å¯¹å£ï¼‰\n\n2ã€ç¬¬ä¸€é¢˜æ˜¯ç®€è¦ä»‹ç»ä¸€ä¸‹åŠŸè€—çš„å®šä¹‰ï¼Œæœ‰å“ªäº›é™åŠŸè€—çš„æ–¹å¼ï¼Ÿ\n\n3ã€ç¬¬äºŒé¢˜æ˜¯ä¸¤ä¸ªRegä¹‹é—´ç»å…¸çš„æ—¶åºåˆ†æï¼Œé€æ­¥åŠ å…¥skewã€jitterç­‰å› ç´ ï¼Œå†™å‡ºå»ºç«‹æ—¶é—´å’Œä¿æŒæ—¶é—´çš„è®¡ç®—å…¬å¼ï¼Œè¯¢é—®time borrowçš„æ¦‚å¿µï¼›\n\n4ã€æ’•ä¸€é“DDSçš„é¢˜ã€‚\n$$\ny=sin(\\frac{\\pi}{128}*x)+x\n$$\nxçš„èŒƒå›´æ˜¯[0,255]ï¼›\n\n1ï¼‰yçš„èŒƒå›´ï¼Œå®šç‚¹æ•°ï¼Œ16ä½å®½çš„è¯å°æ•°ç‚¹çš„ä½ç½®ï¼›2ï¼‰å®ç°æ€è·¯ï¼›3ï¼‰RTL codeï¼›\n\næœ€åä¸€é¢˜æ’•çš„æ—¶é—´æœ‰ç‚¹é•¿ï¼Œæœ€åä¹Ÿæ²¡å®Œæ•´æ’•å‡ºæ¥ï¼Œä¸è¿‡æ€è·¯å¤§è‡´ç»™é¢è¯•å®˜è¯´æ˜ç™½äº†ã€‚æ•´ä¸ªä¸€é¢å¤§çº¦ç”¨æ—¶1hå·¦å³ã€‚\n\n### äºŒé¢æŠ€æœ¯é¢ï¼ˆ3.8ï¼‰\n\n1ã€è‡ªæˆ‘ä»‹ç»ï¼Œä»æœ¬ç§‘åˆ°ç¡•å£«çš„é¡¹ç›®å’Œç§‘ç ”ç»å†ï¼›\n\n2ã€é¡¹ç›®ä¸­è·¨æ—¶é’ŸåŸŸéƒ¨åˆ†çš„å¤„ç†ï¼›\n\n3ã€å¼‚æ­¥FIFOä¸­binaryè½¬grayçš„åŸå› ï¼›\n\n4ã€multicycleå’Œmax delayçš„åŒºåˆ«ï¼›\n\n5ã€å•bitä¿¡å·è¦è·¨æ—¶é’ŸåŸŸå¹¶è¿›è¡Œå–åæ“ä½œï¼Œé—®åç›¸å™¨æ”¾ç½®çš„ä½ç½®ï¼›\n\n6ã€å¼‚æ­¥å¤ä½ã€åŒæ­¥å¤ä½çš„ä¼˜ç¼ºç‚¹ï¼›\n\n7ã€å¼‚æ­¥å¤ä½åŒæ­¥é‡Šæ”¾çš„åšæ³•ï¼›\n\n8ã€å¯¹èŠ¯ç‰‡å·¥è‰ºå’Œé¢‘ç‡çš„ä¸€äº›è®¨è®ºï¼›é¢è¯•å®˜è®¤ä¸º40nmå·¥è‰ºå¯ä»¥è·‘æ›´é«˜çš„æ—¶é’Ÿé¢‘ç‡ï¼›\n\n9ã€ç®€å•ä»‹ç»ä¸€ä¸‹AXIåè®®ï¼Œåè®®è½¬æ¢å¦‚ä½•åšï¼›\n\n10ã€ä»‹ç»ä¸€ä¸‹AXIä¸­çš„outstandingåŠŸèƒ½ï¼›\n\n11ã€æºåŒæ­¥è¾“å‡ºçš„æ—¶åºçº¦æŸï¼›\n\n12ã€é—®ä¸€ä¸‹é¡¹ç›®çš„ä»£ç é‡ï¼›\n\n13ã€æœ€åæ’•ä¸€é“é¢˜ï¼Œåœ¨ä¸€æ®µæ•°æ®åºåˆ—ä¸­æ‰¾æœ€å¤§æ¬¡å¤§å€¼ï¼›\n\n### ä¸‰é¢æŠ€æœ¯é¢ï¼ˆ3.17ï¼‰\n\né¢è¯•å®˜åœ¨ç¾å›½ï¼Œçº¦äº†æ—©8ç‚¹çš„é¢è¯•ï¼Œå¹´é¾„æ¯”è¾ƒå¤§ï¼Œé¢è¯•å®˜å¾ˆå’Œè”¼ï¼Œæœ‰ä»€ä¹ˆä¸æ˜ç™½çš„åœ°æ–¹ä¹Ÿä¼šå¾ªå¾ªå–„è¯±ï¼Œå¼•å¯¼ä½ è®²å‡ºæ¥ï¼Œé¢è¯•ä½“éªŒå¾ˆå¥½ã€‚é¦–å…ˆå¯’æš„äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰è®©è‡ªæˆ‘ä»‹ç»ï¼Œé—®äº†ä¸€ä¸‹å®ä¹ æ—¶é—´ï¼Œå®ä¹ åœ°ç‚¹ï¼Œè¯¢é—®ä¸€ä¸‹èŒä¸šè§„åˆ’ã€‚æœ€åè¯„ä»·è¯´ä¹¦æœ¬çŸ¥è¯†æŒæ¡çš„ä¸é”™ï¼Œä½†è¿˜ä¸å¤Ÿæ·±ç©¶ï¼Œå¸Œæœ›ä»¥ååœ¨å®ä¹ ä¸­ç»§ç»­åŠ æ·±ç†è§£ã€‚æ•´ä½“æµç¨‹å¤§æ¦‚25min\n\n1ã€SRAMã€DRAMçš„åŒºåˆ«ï¼›\n\n2ã€DRAMä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€åˆ·æ–°ï¼Ÿ\n\n3ã€ä»‹ç»ä¸€ä¸‹åŠŸè€—ï¼›\n\n4ã€ä»¥DRAMä¸ºä¾‹è§£é‡Šä¸€ä¸‹é™æ€åŠŸè€—ï¼›\n\n5ã€æ–¹æ³¢æ€ä¹ˆå¾—åˆ°æ­£å¼¦æ³¢ï¼Ÿ\n\n6ã€æ—¶é’Ÿç»è¿‡ä¸€æ®µè·¯å¾„ä¼šå¤±çœŸå—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\n7ã€äºŒåˆ†é¢‘ç”µè·¯ï¼›\n\n8ã€ç¯è·¯æŒ¯è¡å™¨ï¼›\n\n9ã€äº†è§£Power Domainå—ï¼Ÿ\n\n### å››é¢HRé¢ï¼ˆ3.28ï¼‰\n\n1ã€å¯¹å®ä¹ åœ°ç‚¹æ˜¯å¦æœ‰è¦æ±‚ï¼Ÿæ˜¯å¦æœ‰å€¾å‘æ€§ï¼Ÿ\n\n2ã€ç§‹æ‹›è¿˜ä¼šè€ƒè™‘å…¶ä»–å…¬å¸å—ï¼Ÿ\n\n3ã€åˆ«äººå¯¹ä½ çš„è¯„ä»·ï¼Ÿæœ‰å“ªäº›äº‹ä¾‹è¯æ˜ï¼Ÿ\n\n4ã€ç¡®è®¤å®ä¹ æ—¶é—´ï¼›\n\n5ã€å·¥ä½œå†…å®¹ï¼Œæ–¹å‘ç¡®è®¤ï¼›\n\n## ä¹é‘«ç§‘æŠ€\n\nä¹é‘«ç§‘æŠ€çš„é¢†è·‘è€…è®¡åˆ’åœ¨21å¹´12æœˆå°±å¼€å§‹äº†ï¼Œç„¶åç½‘ä¸Šè¯´å»å¹´çš„é¢è¯•ä½“éªŒä¸æ˜¯å¾ˆå¥½ï¼Œ**è‡ªå·±äº²èº«ä½“éªŒäº†ä¸€ä¸‹å‘ç°é¢è¯•ä½“éªŒéå¸¸éå¸¸å¥½**ï¼Œéå¸¸æ¨èå„ä½åŒå­¦æŠ•é€’ã€‚2.28ç®€å†æŠ•é€’ï¼Œ3.1é€šçŸ¥ç¬”è¯•ï¼Œ3.7å®Œæˆç¬”è¯•ï¼Œ3.14ä¸€é¢æŠ€æœ¯é¢ï¼Œ3.21äºŒé¢HRé¢ï¼Œ3.24offer callã€‚\n\n### ä¸€é¢æŠ€æœ¯é¢ï¼ˆ3.14ï¼‰\n\nä¹é‘«é¢è¯•çš„é£æ ¼ä¸å­—èŠ‚å®Œå…¨ä¸åŒï¼Œç´§ç´§å›´ç»•é¡¹ç›®ï¼Œä¸»è¦è¯¢é—®TWäºŒå·é¡¹ç›®ï¼Œå¤§éƒ¨åˆ†æ˜¯æˆ‘è®²é¢è¯•å®˜å¬ï¼Œé—®çš„é—®é¢˜ä¹Ÿæ˜¯é¡¹ç›®å¼ºç›¸å…³ï¼Œè¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹é¢è¯•å®˜çš„å…³æ³¨çš„ç‚¹ï¼›\n\n1ã€ç³»ç»Ÿæœ€å¤§ååç‡ï¼Œå·¥ä½œæ¨¡å¼æœ‰å“ªäº›ï¼›\n\n2ã€ç»„å¸§ã€ç»„åŒ…çš„å¿…è¦æ€§ï¼›\n\n3ã€æ¥å£ä¿¡å·çš„ä»‹ç»ï¼›\n\n4ã€è·¨æ—¶é’ŸåŸŸçš„æ–¹å¼ï¼›\n\n5ã€FIFOæ·±åº¦çš„è®¾è®¡ï¼Œæ˜¯å¦æœ‰æµæ§æœºåˆ¶ã€‚\n\n6ã€FIFOä¼šæº¢å‡ºå—ï¼Ÿå¦‚æœä¸ä¼šæ˜¯å¦‚ä½•ä¿è¯çš„ï¼Ÿå¦‚æœä¼šçš„è¯å¦‚ä½•åº”å¯¹ï¼Ÿ\n\n7ã€èˆªç©ºèˆªå¤©é¢†åŸŸå¦‚ä½•æŠ—å•ç²’å­ç¿»è½¬ï¼Ÿ\n\n8ã€ASICé¡¹ç›®æ˜¯å¦‚ä½•éªŒè¯çš„ï¼Ÿ\n\n9ã€è‡ªå·±ä¼šåšä¸€äº›ç»¼åˆçœ‹é¢ç§¯å—ï¼Ÿé¢ç§¯æœ‰è¦æ±‚å—ï¼Ÿ\n\n10ã€ç®€è¦ä»‹ç»ä¸€ä¸‹ä½åŠŸè€—çš„æ–¹æ³•ï¼Œè‡ªå·±åœ¨ASICé¡¹ç›®ä¸­ç”¨åˆ°äº†å“ªäº›ä½åŠŸè€—æ–¹å¼ï¼Ÿ\n\n11ã€è®¾è®¡ASICæ—¶æœ‰æ²¡æœ‰è€ƒè™‘æ’é—¨æ§æ—¶é’Ÿï¼Œé—¨æ§æ—¶é’Ÿæœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\n\n### äºŒé¢HRé¢ï¼ˆ3.21ï¼‰\n\nä¹é‘«çš„HRçœ‹ç€æ¯”è¾ƒå¹´è½»ï¼Œæ¯”æˆ‘ä»¬å¤§ä¸äº†å‡ å²ï¼Œä¸Šæ¥å¯’æš„äº†ä¸€ä¼šã€‚\n\n1ã€ç®€å•çš„è‡ªæˆ‘ä»‹ç»ï¼›\n\n2ã€è¯¢é—®å­¦ä¹ æ•™è‚²ç»å†ï¼›\n\n3ã€ä½ è§‰å¾—æ•°å­—ICè®¾è®¡çš„æœ€é‡è¦çš„ä¸‰ç‚¹èƒ½åŠ›ï¼Œä½ å“ªç‚¹æ¯”è¾ƒæ“…é•¿ï¼Œå“ªç‚¹æ¯”è¾ƒä¸è¶³ï¼Ÿ\n\n4ã€ä¸ºä»€ä¹ˆé€‰æ‹©æ•°å­—ICï¼Ÿæ˜¯çˆ¶æ¯åšçš„å†³å®šå—ï¼Ÿ\n\n5ã€ä½ æƒ³è±¡ä¸­äºŒåå¹´åçš„ä½ æ˜¯ä»€ä¹ˆæ ·çš„è§’è‰²ï¼Ÿ\n\n6ã€å‚ä¸é‚£ä¹ˆå¤šç«èµ›æœ‰ä»€ä¹ˆæ”¶è·ï¼Ÿ\n\n7ã€ç°åœ¨æœ‰æ˜ç¡®çš„èŒä¸šè§„åˆ’å—ï¼Ÿ\n\nåé—®ï¼š\n\n1ã€åç»­çš„é¢è¯•æµç¨‹ï¼›ï¼ˆå¦‚æœåˆ‡æ¢baseçš„è¯ä¼šåŠ ä¸»ç®¡é¢ï¼‰\n\n2ã€å»å¹´ç½‘ä¸Šä¹é‘«çš„é¢è¯•è¿‡ç¨‹è¯„ä»·ä¸é«˜ï¼Œä»Šå¹´çš„é¢è¯•ä½“éªŒå¾ˆå¥½ï¼Œå…¬å¸æ˜¯å¦åšäº†ç›¸åº”è°ƒæ•´ï¼ŒåŠæ—¶å€¾å¬åº”å±Šç”Ÿåé¦ˆï¼Ÿ\n\n**ä¹é‘«ä»Šå¹´çš„é¢è¯•ä½“éªŒå·¨å·¨å·¨å·¨å·¨å¥½**ï¼Œæˆ‘å­—èŠ‚çš„HRé¢åœ¨ä¹é‘«Offerçš„æˆªæ­¢æ—¥æœŸä¹‹å‰ï¼Œåœ¨ä¸HRè¯´æ˜æƒ…å†µåHRèƒ½å¸®å¿™å»¶è¿Ÿä¸€ä¸‹ç­¾Offerçš„æ—¶é—´ã€‚æœ€åæ²¡æœ‰ç­¾HRä¹Ÿä¼šæ‰“ç”µè¯è·Ÿä½ ç¡®è®¤ï¼Œè¿˜ç»™ç§‹æ‹›ç›´é€šç»ˆé¢çš„æœºä¼šï¼Œæ€»ä¹‹**ä½“éªŒéå¸¸ä¸é”™ï¼Œå¢™è£‚æ¨èï¼ï¼ï¼**\n\n---\n\n4.7æ—¥æ›´æ–°ä¸€æ³¢é˜¿å¹³é¢ç»\n\n## å¹³å¤´å“¥\n\n### ä¸€é¢æŠ€æœ¯é¢ï¼ˆ3.30ï¼‰\n\næˆ‘è§‰å¾—å¹³å¤´å“¥çš„é¢è¯•å®˜æ¯”è¾ƒåœ¨æ„çš„æ˜¯ä½ é¡¹ç›®ä¸­çš„äº®ç‚¹ï¼Œè¿™æ˜¯æˆ‘é¢è¯•ä¸­æ”¶è·æ¯”è¾ƒå¤§çš„ä¸€ç‚¹ã€‚é¡¹ç›®ä¸è¦ä¸Šæ¥å°±æ·±å…¥ç»†èŠ‚ï¼Œé¢è¯•å®˜åº”è¯¥ä¹Ÿä¸æ˜¯å¾ˆcareï¼Œ**ä¸Šæ¥æŠŠé¡¹ç›®æ¡†æ¶ä»‹ç»å®Œä¹‹åç›´æ¥ç»™é¢è¯•å®˜ä»‹ç»äº®ç‚¹å³å¯**ï¼Œé¢è¯•å®˜ä¹Ÿå¯ä»¥é€šè¿‡ä½ æ€»ç»“çš„äº®ç‚¹å¤§æ¦‚æ‘¸æ¸…ä½ çš„æŠ€æœ¯æ·±åº¦è¿™æ ·ã€‚\n\né—®é¢˜ä¸»è¦æ˜¯ç´§ç´§å›´ç»•é¡¹ç›®å±•å¼€çš„ï¼Œå¤§å®¶ä»…åšå‚è€ƒå³å¯ï¼Œå…«è‚¡æ¯”è¾ƒå°‘ï¼š\n\n1ã€ASICä¸FPGAåŠŸèƒ½åˆ’åˆ†çš„ä¾æ®ï¼›\n\n2ã€ASICçš„éªŒè¯æ˜¯æ€ä¹ˆåšçš„ï¼Ÿ\n\n3ã€å…³æ³¨TW2é¡¹ç›®ä¸­çš„æ•°æ®åå‹ï¼Œæ—¶é’Ÿå¤ä½ä¿¡å·çš„ç”Ÿæˆï¼›\n\n4ã€é¡¹ç›®ä¸­FIFOæ·±åº¦çš„è®¾ç½®ä¾æ®ï¼›\n\n5ã€è·¨å¤ä½åŸŸçš„ä¸€äº›é—®é¢˜ï¼Œå¤ä½çš„é‡Šæ”¾é¡ºåºç­‰ï¼›\n\n6ã€Verilogçš„å››å€¼é€»è¾‘ï¼Œä»¿çœŸä¸­ä½¿ç”¨ä»€ä¹ˆè¯­æ³•å¯ä»¥ä½¿Xæ€è¿›è¡Œä¼ æ’­ï¼›\n\n### äºŒé¢æŠ€æœ¯é¢ï¼ˆ4.7ï¼‰\n\näºŒé¢è¢«å®‰æ’åœ¨ä¸Šåˆ9ç‚¹ï¼Œé¢è¯•å®˜åº”è¯¥åœ¨æµ·å¤–ï¼Œç„¶åæ•´ä½“äº¤æµè¿‡ç¨‹ä¸­å¤¹å¸¦è‹±æ–‡æ¯”è¾ƒå¤šï¼Œæœ‰çš„æ—¶å€™æˆ‘å¯èƒ½å¬ä¸å¤ªæ‡‚ã€‚æˆ‘é¢çš„ç»„æ˜¯åšGPGPUçš„ï¼Œæ•´ä½“æµç¨‹ä¸ä¸Šé¢ç±»ä¼¼ï¼Œé—®é¢˜ä¹Ÿä¸ä¸Šé¢ç±»ä¼¼ï¼Œä¸»è¦è®°å½•ä¸€ä¸‹é—®çš„ä¸åŒçš„ç‚¹ï¼š\n\n1ã€æ—¶é’Ÿçº§è”çš„éš¾ç‚¹åŠå¿…è¦æ€§ï¼›\n\n2ã€æºåŒæ­¥è¾“å…¥/è¾“å‡ºçš„æ—¶åºçº¦æŸï¼Œå®ç°æ–¹æ³•ï¼›å¦‚ä½•ä¿è¯æ—¶é’Ÿä¸æ•°æ®çš„åç§»å…³ç³»ï¼Ÿ\n\n3ã€ASICä¸FPGAåŠŸèƒ½çš„åˆ’åˆ†åŸå› ï¼ŸASICçš„éªŒè¯æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ\n\n4ã€è®¾è®¡å¯é æ€§æ˜¯å¦‚ä½•ä¿éšœçš„ï¼Ÿ\n\n5ã€æ•°æ®åå‹æ˜¯å¦‚ä½•åšçš„ï¼Ÿ\n\nåé—®ï¼šå…¬å¸å†…éƒ¨å¯¹HLSå·¥å…·æ˜¯ä»€ä¹ˆçœ‹æ³•ï¼Ÿç­”ï¼šä½¿ç”¨èµ·æ¥å¾ˆä¿å®ˆï¼ŒDebugä¸ä¾¿ï¼Œæˆ–è®¸è¿‡å‡ å¹´æˆç†Ÿäº†æ‰ä¼šå¤§è§„æ¨¡ä½¿ç”¨ï¼›\n\n## å…¶ä»–å…¬å¸\n\nå¥•æ–¯ä¼Ÿæˆ‘æ˜¯2.20ç”³è¯·ï¼Œç›´åˆ°3.28é‚£è¾¹æ‰æœ‰å·¥ä½œäººå‘˜æ‰“ç”µè¯è·Ÿæˆ‘ç¡®è®¤æ—¶é—´ï¼Œé‚£è¾¹è¦æ±‚å®ä¹ æ—¶é—´6ä¸ªæœˆï¼Œä¿è¯ä¹‹åå®‰æ’é¢è¯•ï¼Œè¿™ä¸ªå®ä¹ æ—¶é—´æˆ‘æ˜¯è¾¾ä¸åˆ°è¦æ±‚çš„ï¼Œäºæ˜¯æ‹’ä¹‹ï¼›\n## å¾…è¡¥å……\nä»Šå¹´å®ä¹ å¼€å§‹çš„æ—©ï¼Œç»“æŸçš„ä¹Ÿæ—©ï¼Œåç»­åº”è¯¥ä¸ä¼šå†æŠ•é€’å…¶ä»–å…¬å¸çš„å®ä¹ äº†ï¼Œæ²¡æœ‰é›†é‚®çš„å…´è¶£ï¼Œç§‹æ‹›å†è¯´ã€‚","tags":["interview"],"categories":["interview"]},{"title":"HDLBitsç­”æ¡ˆæ±‡æ€»","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆæ±‡æ€»/","content":"\n# å‰è¨€\n\nè¯¥åšå®¢ä¸ºæœ¬äººåšHDLBitsä¹ é¢˜æ—¶çš„å¿ƒå¾—è®°å½•æ€»ç»“ï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·äº¤æµè¿›æ­¥ã€‚\n\n[HDLBitsç½‘ç«™é“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n## Verilog Language\n\n[Basics](https://david-luge.cn/2022/09/02/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(1)_Verilog%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/)\n\n[Vectors](https://david-luge.cn/2022/09/03/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(2)_Verilog%E5%90%91%E9%87%8F%E5%9F%BA%E7%A1%80/)\n\n[Modules:Hierarchy](https://david-luge.cn/2022/09/03/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(3)_Verilog%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BE%8B%E5%8C%96%E4%B8%8E%E8%B0%83%E7%94%A8/)\n\n[Procedures](https://david-luge.cn/2022/09/03/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(4)_%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E7%94%9F%E6%88%90%E9%94%81%E5%AD%98%E5%99%A8/)\n\n[More Verilog Features](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(5)_Generate%E5%AE%9E%E4%BE%8B%E5%8C%96%E6%A8%A1%E5%9D%97/)\n\n## Circuits\n\n### Combinational Logic\n\n[Basic gates](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(6)_%E7%A1%AC%E4%BB%B6%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%80%9D%E8%80%83%E6%96%B9%E5%BC%8F/)\n\n[Multiplexers](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(7)_Verilog%E5%A4%9A%E8%B7%AF%E9%80%89%E6%8B%A9%E5%99%A8/)\n\n[Arithmetic Circuits](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(8)_Verilog%E5%8D%8A%E5%8A%A0%E5%99%A8%E3%80%81%E5%85%A8%E5%8A%A0%E5%99%A8%E5%92%8C%E8%A1%8C%E6%B3%A2%E8%BF%9B%E4%BD%8D%E5%8A%A0%E6%B3%95%E5%99%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E8%AE%BE%E8%AE%A1/)\n\n[Karnaugh Map to Circuit](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(9)_%E5%8D%A1%E8%AF%BA%E5%9B%BE%E4%B8%8E%E6%9C%80%E7%AE%80SOP%E5%BC%8F/)\n\n### Sequential Logic\n\n[Latches and Flip-Flops](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(10)_D%E8%A7%A6%E5%8F%91%E5%99%A8%E3%80%81%E5%90%8C%E6%AD%A5%E4%B8%8E%E5%BC%82%E6%AD%A5%E5%A4%8D%E4%BD%8D%E3%80%81%E8%84%89%E5%86%B2%E8%BE%B9%E6%B2%BF%E6%A3%80%E6%B5%8B/)\n\n[Counters](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(11)_Verilog%E8%AE%A1%E6%95%B0%E5%99%A8/)\n\n[Shift Registers](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(12)_Verilog%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8/)\n\n[More Circuits](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(13)_Verilog%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8%E9%99%84%E5%8A%A0%E9%A2%98/)\n\n#### Finite State Machines\n\n[Simple FSM 1â€”Simple state transitions 3](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(14)_Verilog%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA(1)/)\n\n[Simple one-hot state transitions 3â€”Design a Moore FSM](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(15)_Verilog%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA(2)/)\n\n[Lemmings 1-4](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(16)_Verilog%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA(3)/)\n\n[One-hot FSMâ€”PS/2 packet parser and datapath](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(17)_Verilog%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA(4)/)\n\n[Serial receiverâ€”Serial receiver with parity checking](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(18)_Verilog%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA(5)/)\n\n[Q8â€”Q5b](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(19)_Verilog%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA(6)/)\n\n[Q3aâ€”Q6](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(20)_Verilog%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA(7)/)\n\n[Q2aâ€”Q2b](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(21)_Verilog%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA(8)/)\n\n[Building Larger Circuits](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(22)_%E5%9F%BA%E4%BA%8E%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA%E7%9A%84%E8%AE%A1%E6%95%B0%E5%99%A8/)\n\n## Verification:Reading Simulations\n\n[Finding bugs in code](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(23)_%E6%89%BEBUG/)\n\n[Build a circuit from a simulation waveform](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(24)_%E7%94%B1%E6%B3%A2%E5%BD%A2%E5%9B%BE%E6%8F%8F%E8%BF%B0%E7%94%B5%E8%B7%AF/)\n\n[Verification:Writing Testbenches](https://david-luge.cn/2022/09/12/IC/HDLBits/HDLBits%E7%AD%94%E6%A1%88(25)_%E7%BC%96%E5%86%99Testbench/)","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(25)_ç¼–å†™TestBench","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(25)_ç¼–å†™Testbench/","content":"\n# ç¼–å†™TestBench\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©æ›´æ–°HDLBitsæœ€åä¸€ç« çš„ä¹ é¢˜ï¼šç¼–å†™Testbenchã€‚\n\n------\n\n## é¢˜åº“\n\n### Clock\n\næä¾›äº†å¦‚ä¸‹æè¿°çš„æ¨¡å—ï¼š\n\n```verilog\nmodule dut ( input clk ) ;\n```\n\nè¦æ±‚ä¼ å…¥é¢‘ç‡ä¸º10psçš„æ—¶é’Ÿï¼Œåˆå§‹ä¸º0ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232209621.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module ();\n\n    reg clk;\n    initial begin\n        clk = 1'b0;\n    end\n    always #5 clk = ~clk;\n    \n    dut u0(clk);\n    \nendmodule\n```\n\n### Testbench 1\n\näº§ç”Ÿå¦‚ä¸‹å›¾æ‰€ç¤ºçš„A,Bæ¿€åŠ±ã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232209771.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module ( output reg A, output reg B );//\n\n    // generate input patterns here\n    initial begin\n\t\tA = 1'b0;\n        B = 1'b0;\n        #10 A = 1'b1;\n        #5 B = 1'b1;\n        #5 A = 1'b0;\n        #20 B = 1'b0;\n    end\n\nendmodule\n```\n\n### AND gate\n\nå†™æµ‹è¯•æ¿€åŠ±æµ‹è¯•andæ¨¡å—ï¼Œæ³¢å½¢å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232209459.png)\n\næä¾›çš„ANDæ¨¡å—å£°æ˜å¦‚ä¸‹ï¼š\n\n```verilog\nmodule andgate (\n    input [1:0] in,\n    output out\n);\n```\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module();\n\n    reg in_0,in_1;\n    reg out;\n    \n    initial begin\n        in_0 = 1'b0;\n        in_1 = 1'b0;\n        #10 in_0 = 1'b1;\n        #10 \n        in_0 = 1'b0;\n        in_1 = 1'b1;\n        #10 in_0 = 1'b1;\n    end\n    \n    andgate u0(.in({in_1,in_0}),.out(out));\n    \nendmodule\n```\n\n### Testbench 2\n\näº§ç”Ÿå¦‚ä¸‹å›¾æ³¢å½¢å›¾æ‰€ç¤ºçš„æ¿€åŠ±ä¿¡å·ï¼Œæ¿€åŠ±æ¨¡å—q7ï¼›\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232209501.png)\n\næ¨¡å—q7çš„æè¿°å¦‚ä¸‹ï¼š\n\n```verilog\nmodule q7 (\n    input clk,\n    input in,\n    input [2:0] s,\n    output out\n);\n```\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module();\n\n    reg clk,in,out;\n    reg [2:0] s;\n    \n    initial begin\n        clk = 1'b0;\n        in = 1'b0;\n        s = 3'd2;\n        #10 s = 3'd6;\n        #10\n        s = 3'd2;\n        in = 1'b1;\n        #10\n        s = 3'd7;\n        in = 1'b0;\n        #10\n        s = 3'd0;\n        in = 1'b1;\n        #30\tin = 1'b0;\n    end\n    \n    always #5 clk = ~clk;\n    \n    q7 u0(.clk(clk),\n          .in(in),\n          .s(s),\n          .out(out));\n    \nendmodule\n```\n\n### T flip-flop\n\nè¯¥é¢˜ä½œè€…ç»™å‡ºäº†ä¸€ä¸ªTè§¦å‘å™¨çš„moduleï¼Œæˆ‘ä»¬ä»…éœ€å°†å…¶å¤ä½ï¼Œç„¶ååˆ‡å›åˆ°çŠ¶æ€1å°±å¯ä»¥äº†ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module ();\n    reg clk,reset,t;\n    wire q;\n    \n    tff u0(\n        .clk\t(clk    ),\n        .reset\t(reset  ),\n        .t      (t      ),\n        .q      (q      )\n    );\n\n    initial begin\n        clk = 1'b0;\n        reset = 1'b0;\n        #3;\n        reset = 1'b1;\n        #10;\n        reset = 1'b0;   \n    end\n    \n    always #5 clk = ~clk;\n    \n    always@(posedge clk)begin\n        if(reset)begin\n            t <= 1'b0;\n        end\n        else begin\n            t <= 1'b1;\n        end\n    end\n \nendmodule\n```\n\n## ç»“è¯­\n\nHDLBitsç³»åˆ—æ€»ç®—æ˜¯æ›´æ–°ç»“æŸäº†ï¼Œéå¸¸æ„Ÿè°¢è¯¥ç½‘ç«™çš„ä½œè€…ï¼è‡ªå·±ç«‹çš„flagæ€»ç®—å®Œæˆäº†ï¼Œåœ¨å¯’å‡æ”¶å‡å‰åˆ·å®Œäº†ã€‚å¦‚æœä»£ç æœ‰é”™è¯¯çš„åœ°æ–¹æ¬¢è¿å¤§å®¶æŒ‡æ­£ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(24)_ç”±æ³¢å½¢å›¾æè¿°ç”µè·¯","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(24)_ç”±æ³¢å½¢å›¾æè¿°ç”µè·¯/","content":"\n# ç”±æ³¢å½¢å›¾æè¿°ç”µè·¯\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©æ›´æ–°HDLBitsä¹ é¢˜ç”±æ³¢å½¢å›¾æè¿°ç”µè·¯çš„éƒ¨åˆ†ï¼Œçœ‹å›¾å†™ä»£ç ã€‚\n\n------\n\n## é¢˜åº“\n\n### Combinational circuit 1\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232207128.png)\n\nç”±å›¾å¯è§ï¼Œ`q=a&b`\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input a,\n    input b,\n    output q );//\n\n    assign q = a & b; // Fix me\n\nendmodule\n```\n\n### Combinational circuit 2\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232207980.png)\n\nç”±å›¾åˆ—å‡ºå¡è¯ºå›¾æè¿°å‡ºæ¥å³å¯ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input a,\n    input b,\n    input c,\n    input d,\n    output q );//\n\n    assign q = ~a & ~b & ~c & ~d | ~a & ~b & c & d | ~a & b & ~c & d | ~a & b & c & ~d | a & ~b & ~c & d | a & ~b & c & ~d | a & b & ~c & ~d | a & b & c & d; // Fix me\n\nendmodule\n```\n\n### Combinational circuit 3\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232208100.png)\n\nç”±æ³¢å½¢å›¾åˆ—å‡ºå¡è¯ºå›¾åŒ–ç®€å¯å¾—ã€‚\n\n**Solution**:\n\n```verilog\nmodule top_module (\n    input a,\n    input b,\n    input c,\n    input d,\n    output q );//\n\n    assign q = b & d | b & c | a & d | a & c; // Fix me\n\nendmodule\n```\n\n### Combinational circuit 4\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232208388.png)\n\nä¸ä¸Šé¢˜åŒç†\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input a,\n    input b,\n    input c,\n    input d,\n    output q );//\n\n    assign q = b | c; // Fix me\n\nendmodule\n```\n\n### Combinational circuit 5\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232208020.png)\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232208045.png)\n\nç”±æ³¢å½¢å›¾å¯è§è¿™æ˜¯ä¸ªå¤šè·¯é€‰æ‹©å™¨ï¼Œé€šè¿‡cè·¯ä¿¡å·è¿›è¡Œä¿¡å·é€‰æ‹©ï¼›\n\n**Solution**:\n\n```verilog\nmodule top_module (\n    input [3:0] a,\n    input [3:0] b,\n    input [3:0] c,\n    input [3:0] d,\n    input [3:0] e,\n    output [3:0] q );\n\n    always @(*) begin\n        case(c)\n            4'd0:\tq <= b;\n            4'd1:\tq <= e;\n            4'd2:\tq <= a;\n            4'd3:\tq <= d;\n            default:q <= 4'hf;\n        endcase\n    end\n    \nendmodule\n```\n\n### Combinational circuit 6\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232208479.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [2:0] a,\n    output [15:0] q ); \n\n    always @(*) begin\n        case(a)\n            3'd0:\tq <= 16'h1232;\n            3'd1:\tq <= 16'haee0;\n            3'd2:\tq <= 16'h27d4;\n            3'd3:\tq <= 16'h5a0e;\n            3'd4:\tq <= 16'h2066;\n            3'd5:\tq <= 16'h64ce;\n            3'd6:\tq <= 16'hc526;\n            default:q <= 16'h2f19;\n        endcase\n    end\n    \nendmodule\n```\n\n### Sequential circuit 7\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232208047.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input a,\n    output q );\n\n    always @(posedge clk) begin\n        q <= ~a;\n    end\n    \nendmodule\n```\n\n### Sequential circuit 8\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232208231.png)\n\nç”±å›¾å¯è§ï¼Œpä¸ºaåœ¨clockä¸ºé«˜ç”µå¹³æ—¶çš„é€‰é€šä¿¡å·ï¼Œqä¸ºclockä¸‹é™æ²¿è§¦å‘çš„ä¿¡å·ï¼Œå­˜æ”¾pçš„å€¼ã€‚\n\n**Solution**:\n\n```verilog\nmodule top_module (\n    input clock,\n    input a,\n    output p,\n    output q );\n\n    reg clk_0;\n    assign p = clock ? a : p;\n    \n    always @(negedge clock) begin\n        q <= p;\n    end\n    \nendmodule\n```\n\n### Sequential circuit 9\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232209779.png)\n\nç”±å›¾å¯è§ï¼Œqåº”å½“æ˜¯ä¸€ä¸ªä»0-6çš„è®¡æ•°å™¨ï¼Œå½“aä¸ºé«˜ç”µå¹³æ—¶ï¼Œqä¿æŒä¸º4ï¼Œç›´åˆ°aä¸ºä½ç”µå¹³æ—¶ï¼Œå†ç»§ç»­è®¡æ•°ï¼›\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input a,\n    output [3:0] q );\n\n    always @(posedge clk) begin\n        if(a) begin\n            q <= 4'd4;\n        end\n        else if(q == 4'd6) begin\n            q <= 4'd0;\n        end\n        else begin\n            q <= q + 4'd1;\n        end\n    end\n    \nendmodule\n```\n\n### Sequential circuit 10\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232209486.png)\n\nqä¸ºa,bå’Œstateçš„ç»„åˆé€»è¾‘ï¼Œåˆ—å‡ºçœŸå€¼è¡¨å³å¯ï¼›\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input a,\n    input b,\n    output q,\n    output state  );\n\n    assign q = a ^ b ^ state;\n    \n    always @(posedge clk) begin\n        if(a & b) begin\n            state <= 1'b1;\n        end\n        else if(~a & ~b) begin\n            state <= 1'b0;\n        end\n        else begin\n            state <= state;\n        end\n    end\n    \nendmodule\n```\n\n## ç»“è¯­\n\nè¯¥å°ç»“å°±ç®—æ›´æ–°ç»“æŸäº†ï¼Œèƒœåˆ©å°±åœ¨çœ¼å‰ï¼Œå“ˆå“ˆå“ˆï¼æœ¬ç« çš„è§£æ³•å¹¶ä¸å”¯ä¸€ï¼Œå¤§å®¶æœ‰ä»€ä¹ˆå…¶ä»–æ€è·¯æ¬¢è¿åœ¨è¯„è®ºåŒºè®¨è®ºäº¤æµã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(23)_Finding bugs in code","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(23)_æ‰¾BUG/","content":"\n# Finding bugs in code\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©æ›´æ–°HDLBitsä¹ é¢˜éƒ¨åˆ†æ‰¾BUGéƒ¨åˆ†ï¼Œæ¯”è¾ƒç®€å•ï¼Œå¤§å®¶çœ‹ä¸€ä¸‹å³å¯ã€‚\n\n------\n\n## é¢˜åº“\n\n### 8bit_2_1_Mux\n\nåŸCodeï¼š\n\n```verilog\nmodule top_module (\n    input sel,\n    input [7:0] a,\n    input [7:0] b,\n    output out  );\n\n    assign out = (~sel & a) | (sel & b);\n\nendmodule\n```\n\nä»ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¾“å‡ºçš„outä¿¡å·ä½å®½ä¸å¯¹ï¼Œå…¶æ¬¡å¤šè·¯é€‰æ‹©çš„è¡¨è¾¾å¼æœ‰è¯¯ï¼ŒæŒ‰ä¸Šå›¾ä»£ç ä¸­çš„å–æ³•åªèƒ½å–å‡º1bitã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input sel,\n    input [7:0] a,\n    input [7:0] b,\n    output [7:0] out);\n\n    assign out = sel ? a : b;\n\nendmodule\n```\n\n### NAND\n\nç”¨5ä¸éæ¥å®ç°3ä¸é\n\nå¯ä¾›è°ƒç”¨çš„5ä¸æ¨¡å—ï¼š\n\n```verilog\nmodule andgate ( output out, input a, input b, input c, input d, input e );\n```\n\nåŸCode:\n\n```verilog\nmodule top_module (input a, input b, input c, output out);//\n\n    andgate inst1 ( a, b, c, out );\n\nendmodule\n```\n\nç”±ä¸Šé¢å¯ä¾›è°ƒç”¨çš„æ¨¡å—å¯è§ï¼Œè¾“å…¥è¾“å‡ºçš„å¯¹åº”å…³ç³»ä¸å¯¹ï¼Œä¸”å‚æ•°æ•°é‡ä¹Ÿä¸å¯¹ï¼Œä»£ç æ”¹æ­£å¦‚ä¸‹ï¼š\n\n**Solution**:\n\n```verilog\nmodule top_module (input a, input b, input c, output out);//\n    \n\twire and_out;\n    \n    andgate inst1 ( and_out, a, b, c, 1, 1);\n    \n    assign out = ~and_out;\n\nendmodule\n```\n\n### 8bit_4_1_Mux\n\næä¾›äº†ä¸€ä¸ªæ— BUGçš„2_1_Mux\n\n```verilog\nmodule mux2 (\n    input sel,\n    input [7:0] a,\n    input [7:0] b,\n    output [7:0] out\n);\n```\n\nå¾…æ”¹ä»£ç ï¼š\n\n```verilog\nmodule top_module (\n    input [1:0] sel,\n    input [7:0] a,\n    input [7:0] b,\n    input [7:0] c,\n    input [7:0] d,\n    output [7:0] out  ); //\n\n    wire mux0, mux1;\n    mux2 mux0 ( sel[0],    a,    b, mux0 );\n    mux2 mux1 ( sel[1],    c,    d, mux1 );\n    mux2 mux2 ( sel[1], mux0, mux1,  out );\n\nendmodule\n```\n\nåˆ†æï¼šsel[1]åŒºåˆ†ä¸äº†cå’Œdï¼Œæ­¤å¤„åº”è¯¥è¿˜æ˜¯sel[0]ã€‚æ­¤å¤–ä¾‹åŒ–åä¸å˜é‡åä¸èƒ½é‡å¤ï¼›ä¸”wireä¿¡å·çš„ä½å®½ä¹Ÿä¸å¯¹ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [1:0] sel,\n    input [7:0] a,\n    input [7:0] b,\n    input [7:0] c,\n    input [7:0] d,\n    output [7:0] out  ); //\n\n    wire [7:0] mux00, mux11;\n    mux2 mux0 ( sel[0],    a,    b, mux00 );\n    mux2 mux1 ( sel[0],    c,    d, mux11 );\n    mux2 mux2 ( sel[1], mux00, mux11,  out );\n\nendmodule\n```\n\n### Add/Sub\n\nåŸä»£ç ï¼š\n\n```verilog\n// synthesis verilog_input_version verilog_2001\nmodule top_module ( \n    input do_sub,\n    input [7:0] a,\n    input [7:0] b,\n    output reg [7:0] out,\n    output reg result_is_zero\n);//\n\n    always @(*) begin\n        case (do_sub)\n          0: out = a+b;\n          1: out = a-b;\n        endcase\n\n        if (~out)\n            result_is_zero = 1;\n    end\n\nendmodule\n```\n\nå› ä¸º`result_is_zero`ä¸ºregå‹ï¼Œå½“å…¶ä¸º1åä¸€ç›´ä¸º1ï¼Œå› ä¸ºæ²¡æœ‰å…¶ä»–çŠ¶æ€èƒ½ä½¿å…¶æ”¹å˜ï¼Œä¸”éœ€é”å­˜çŠ¶æ€ï¼Œå› ä¸ºifæœªéå†æ‰€æœ‰çŠ¶æ€ã€‚\n\n**Solution**:\n\n```verilog\n// synthesis verilog_input_version verilog_2001\nmodule top_module ( \n    input do_sub,\n    input [7:0] a,\n    input [7:0] b,\n    output reg [7:0] out,\n    output reg result_is_zero\n);//\n\n    always @(*) begin\n        case (do_sub)\n          0: out = a+b;\n          1: out = a-b;\n        endcase\n\n        if (out == 8'd0) begin\n            result_is_zero = 1;\n        end\n        else begin\n            result_is_zero = 0;\n        end\n    end\n\nendmodule\n```\n\n### Case statement\n\nåŸä»£ç ï¼š\n\n```verilog\nmodule top_module (\n    input [7:0] code,\n    output reg [3:0] out,\n    output reg valid=1 );//\n\n     always @(*)\n        case (code)\n            8'h45: out = 0;\n            8'h16: out = 1;\n            8'h1e: out = 2;\n            8'd26: out = 3;\n            8'h25: out = 4;\n            8'h2e: out = 5;\n            8'h36: out = 6;\n            8'h3d: out = 7;\n            8'h3e: out = 8;\n            6'h46: out = 9;\n            default: valid = 0;\n        endcase\n\nendmodule\n```\n\nåˆ†æï¼šé»˜è®¤è¾“å‡ºvalid=1ä¸èƒ½æŒ‰ä¸Šå›¾æ‰€ç¤ºçš„ç¼–å†™ä»£ç ï¼Œé»˜è®¤çš„è¾“å…¥å¯ä»¥ï¼›å…¶æ¬¡è¿›åˆ¶`8'd26`éœ€æ”¹æˆ8è¿›åˆ¶ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [7:0] code,\n    output reg [3:0] out,\n    output reg valid);//\n\n     always @(*) begin\n         case (code)\n            8'h45: out = 4'd0;\n            8'h16: out = 4'd1;\n            8'h1e: out = 4'd2;\n            8'h26: out = 4'd3;\n            8'h25: out = 4'd4;\n            8'h2e: out = 4'd5;\n            8'h36: out = 4'd6;\n            8'h3d: out = 4'd7;\n            8'h3e: out = 4'd8;\n            8'h46: out = 4'd9;\n            default: begin\n                out = 4'd0;\n            end\n        endcase\n\n         if(out == 4'd0 && code!= 8'h45) begin\n            valid = 1'b0;\n        end\n        else begin\n            valid = 1'b1;\n        end\n     end\n     \t\t              \nendmodule\n```\n\n## ç»“è¯­\n\nè¯¥å°ç»“å°±ç®—æ›´æ–°ç»“æŸäº†ï¼Œæ‰¾BUGéƒ¨åˆ†çš„ä¹ é¢˜è¿˜æŒºç®€å•çš„ï¼Œæœ‰è¯¯çš„åœ°æ–¹æ¬¢è¿å¤§å®¶æŒ‡æ­£ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(22)_åŸºäºæœ‰é™çŠ¶æ€æœºçš„è®¡æ•°å™¨","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(22)_åŸºäºæœ‰é™çŠ¶æ€æœºçš„è®¡æ•°å™¨/","content":"\n\n\n# åŸºäºæœ‰é™çŠ¶æ€æœºçš„è®¡æ•°å™¨\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©æ›´æ–°æ­å»ºæ›´å¤§çš„ç”µè·¯éƒ¨åˆ†çš„ä¹ é¢˜ï¼Œå†…å®¹ä¸»è¦è·Ÿè®¡æ•°å™¨å’Œæœ‰é™çŠ¶æ€æœºæœ‰å…³ã€‚\n\n------\n\n## é¢˜åº“\n\n### Counter with period 1000\n\næ„é€ ä¸€ä¸ª0-999çš„è®¡æ•°å™¨ï¼ŒåŒæ­¥é«˜ç”µå¹³å¤ä½ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,\n    output [9:0] q);\n\n    always @(posedge clk) begin\n        if(reset) begin\n            q <= 10'd0;\n        end\n        else if(q == 10'd999) begin\n            q <= 10'd0;\n        end\n        else begin\n            q <= q + 1'b1;\n        end\n    end\n\nendmodule\n```\n\n### 4-bit shift register and down counter\n\næ„é€ ä¸€ä¸ª4bitçš„ç§»ä½å¯„å­˜å™¨ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åšå€’æ•°çš„è®¡æ•°å™¨ä½¿ç”¨ã€‚å…¶ä¸­å½“`shift_ena`ä¸º1æ—¶æ•°æ®dataçš„é«˜ä½å…ˆè¿›åˆ°ç§»ä½å¯„å­˜å™¨ä¸­ï¼›å½“`count_ena`ä¸º1æ—¶ï¼Œè®¡æ•°å™¨ä»å¯„å­˜å™¨ä¸­å­˜å‚¨çš„æ•°å¼€å§‹é€æ—¶é’Ÿé€’å‡ï¼›`shift_ena`å’Œ`count_ena`æ²¡æœ‰é‡è¦çº§å…ˆåé¡ºåºï¼Œå› ä¸ºä»–ä»¬ä¸ä¼šåŒæ—¶ä½¿èƒ½ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232206423.png)\n\n**Solution**:\n\n```verilog\nmodule top_module (\n    input clk,\n    input shift_ena,\n    input count_ena,\n    input data,\n    output [3:0] q);\n\n    reg [3:0] q_temp;\n\n    always @(posedge clk) begin\n        if(shift_ena) begin\n            q_temp <= {q_temp[2:0],data};\n        end\n        else if(count_ena) begin\n            if(q_temp == 4'd0) begin\n                q_temp <= 4'd15;\n            end\n            else begin\n                q_temp <= q_temp - 1'b1;\n            end\n        end\n    end\n\n    assign q = q_temp;\n\nendmodule\n```\n\næˆ‘ä»¥ä¸ºè®¡æ•°å™¨åˆ°0æ—¶åœæ­¢è®¡æ•°ï¼Œæœ¬æ¥æŒ‰è¿™ä¸ªé€»è¾‘å†™çš„ï¼Œç„¶ååœ¨çº¿æäº¤æ—¶å‡ºé”™ã€‚ä½œè€…çš„æ„æ€æ˜¯0åé¢ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯15ï¼Œè¿™ä¸ªå¤§å®¶åšé¢˜æ—¶éœ€æ³¨æ„ã€‚\n\n### FSM:Sequence 1101 recognizer\n\næ„é€ ä¸€ä¸ªæœ‰é™çŠ¶æ€æœºæ£€æµ‹`data`ä¸­çš„1101åºåˆ—ï¼Œå¦‚æœæ£€æµ‹åˆ°è¯¥åºåˆ—ï¼Œåˆ™å°†è¾“å‡ºä¸€ç›´æ‹‰é«˜ç›´åˆ°åŒæ­¥å¤ä½ä¿¡å·ä¸ºé«˜ã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232206706.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,      // Synchronous reset\n    input data,\n    output start_shifting);\n\n    parameter IDLE = 3'd0, S1 = 3'd1, S2 = 3'd2;\n    parameter S3 = 3'd3, OUT = 3'd4;\n    reg [2:0] current_state, next_state;\n\n    always @(*) begin\n        case(current_state)\n            IDLE:       next_state = data ? S1 : IDLE;\n            S1:         next_state = data ? S2 : IDLE;\n            S2:         next_state = data ? S2 : S3;\n            S3:         next_state = data ? OUT : IDLE;\n            OUT:        next_state = OUT;\n            default:    next_state = IDLE;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset) begin\n            current_state <= IDLE;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    assign start_shifting = current_state == OUT;\n\nendmodule\n```\n\n### FSMï¼šEnable shift register\n\nå½“æœ‰é™çŠ¶æ€æœºè¢«å¤ä½æ—¶ï¼Œå°†`shift_ena`æ‹‰é«˜4ä¸ªå‘¨æœŸï¼Œä¹‹åä¿æŒä¸º0ç›´åˆ°å†æ¬¡å¤ä½ã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232207220.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,      // Synchronous reset\n    output shift_ena);\n\n    parameter IDLE = 2'd0, ENA = 2'd1, STOP = 2'd2;\n    reg [1:0] current_state, next_state;\n    reg [2:0] counter;\n\n    always @(*) begin\n        case(current_state)\n            IDLE:       next_state = ENA;\n            ENA:        next_state = (counter == 3'd3) ? STOP : ENA;\n            STOP:       next_state = STOP;\n            default:    next_state = IDLE;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset) begin\n            current_state <= IDLE;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    always @(posedge clk) begin\n        if(reset) begin\n            counter <= 3'd0;\n        end\n        else begin\n            case(next_state)\n                IDLE:       counter <= 3'd0;\n                ENA:        counter <= counter + 1'b1;\n                STOP:       counter <= 3'd0;\n                default:    counter <= 3'd0;\n            endcase\n        end      \n    end\n\n    assign shift_ena = current_state == ENA | current_state == IDLE;\n\nendmodule\n```\n\néœ€æ³¨æ„çš„æ˜¯å¤ä½ä¸€ç›´ä¸ºé«˜çš„æ—¶å€™è¾“å‡ºä¹Ÿä¸€ç›´ä¸ºé«˜ç”µå¹³ï¼›\n\n### FSMï¼šThe complete FSM\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232207885.png)\n\nå®˜æ–¹æä¾›çš„çŠ¶æ€è½¬ç§»å›¾\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232207451.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,      // Synchronous reset\n    input data,\n    output shift_ena,\n    output counting,\n    input done_counting,\n    output done,\n    input ack );\n\n    parameter S = 4'd0, S1 = 4'd1, S11 = 4'd2, S110 = 4'd3;\n    parameter B0 = 4'd4, B1 = 4'd5, B2 = 4'd6, B3 = 4'd7;\n    parameter Count = 4'd8, Wait = 4'd9;\n    reg [3:0] current_state, next_state;\n\n    always @(*) begin\n        case(current_state)\n            S:          next_state = data ? S1 : S;\n            S1:         next_state = data ? S11 : S;\n            S11:        next_state = data ? S11 : S110;\n            S110:       next_state = data ? B0 : S;\n            B0:         next_state = B1;\n            B1:         next_state = B2;\n            B2:         next_state = B3;\n            B3:         next_state = Count;\n            Count:      next_state = done_counting ? Wait : Count;\n            Wait:       next_state = ack ? S : Wait;\n            default:    next_state = S;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset) begin\n            current_state <= S;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    assign shift_ena = current_state == B0 | current_state == B1 | current_state == B2 | current_state == B3;\n    assign counting = current_state == Count;\n    assign done = current_state == Wait;\n\nendmodule\n```\n\næ ‡å‡†çš„FSMæ ¼å¼ï¼Œæ²¡å•¥è¯´çš„ï¼Œç”»å‡ºçŠ¶æ€è½¬ç§»è¡¨å†™å°±è¡Œäº†ã€‚\n\n### The complete timer\n\nè¯¥é“çŠ¶æ€æœºå°±æ˜¯å‰é¢å‡ é“çŠ¶æ€æœºçš„ç»„åˆï¼Œå¤§å®¶éœ€æ³¨æ„çš„æ˜¯è®¡æ•°é‚£è¾¹çš„éƒ¨åˆ†ï¼›ä¹‹å‰æˆ‘å°†è®¡æ•°å­çš„ä½å®½è®¾ç½®ä¸å½“ï¼Œå¯¼è‡´è¿™é¢˜å¡çš„æŒºä¹…ï¼Œå¸Œæœ›å¤§å®¶åšé¢˜åˆ†ææ—¶æ³¨æ„ã€‚\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232207129.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,      // Synchronous reset\n    input data,\n    output [3:0] count,\n    output counting,\n    output done,\n    input ack );\n\n    parameter IDLE = 4'd0, S1 = 4'd1, S2 = 4'd2, S3 = 4'd3;\n    parameter C0 = 4'd4, C1 = 4'd5, C2 = 4'd6, C3 = 4'd7;\n    parameter Count_1000 = 4'd8, Done = 4'd9;\n    \n    reg [3:0] current_state, next_state;\n    reg [15:0] num;\n    reg [3:0] delay;\n    reg [3:0] already_count;\n\n    wire count_state;\n    assign count_state = (num == (delay + 1'b1)*1000) ? 1'b1 : 1'b0;\n\n    always @(*) begin\n        if(num <= 16'd1000) begin\n            already_count = 4'd0;\n        end\n        else if(num > 16'd1000 && num <= 16'd2000) begin\n            already_count = 4'd1;\n        end\n        else if(num > 16'd2000 && num <= 16'd3000) begin\n            already_count = 4'd2;\n        end\n        else if(num > 16'd3000 && num <= 16'd4000) begin\n            already_count = 4'd3;\n        end\n        else if(num > 16'd4000 && num <= 16'd5000) begin\n            already_count = 4'd4;\n        end\n        else if(num > 16'd5000 && num <= 16'd6000) begin\n            already_count = 4'd5;\n        end\n        else if(num > 16'd6000 && num <= 16'd7000) begin\n            already_count = 4'd6;\n        end\n        else if(num > 16'd7000 && num <= 16'd8000) begin\n            already_count = 4'd7;\n        end\n        else if(num > 16'd8000 && num <= 16'd9000) begin\n            already_count = 4'd8;\n        end\n        else if(num > 16'd9000 && num <= 16'd10000) begin\n            already_count = 4'd9;\n        end\n        else if(num > 16'd10000 && num <= 16'd11000) begin\n            already_count = 4'd10;\n        end\n        else if(num > 16'd11000 && num <= 16'd12000) begin\n            already_count = 4'd11;\n        end\n        else if(num > 16'd12000 && num <= 16'd13000) begin\n            already_count = 4'd12;\n        end\n        else if(num > 16'd13000 && num <= 16'd14000) begin\n            already_count = 4'd13;\n        end\n        else if(num > 16'd14000 && num <= 16'd15000) begin\n            already_count = 4'd14;\n        end\n        else begin\n            already_count = 4'd15;\n        end\n    end\n\n    always @(posedge clk) begin\n        if(reset) begin\n            num <= 16'd0;\n        end\n        else if(next_state == Done) begin\n            num <= 16'd0;\n        end\n        else if(next_state == Count_1000) begin\n            num <= num + 16'd1;\n        end\n    end\n\n    always @(*) begin\n        case(current_state)\n            IDLE:       next_state = data ? S1 : IDLE;\n            S1:         next_state = data ? S2 : IDLE;\n            S2:         next_state = data ? S2 : S3;\n            S3:         next_state = data ? C0 : IDLE;\n            C0:begin\n                        next_state = C1;\n                        delay[3] = data;\n            end         \n            C1:begin\n                        next_state = C2;    \n                        delay[2] = data;\n            end         \n            C2:begin\n                        next_state = C3;    \n                        delay[1] = data;\n            end         \n            C3:begin\n                        next_state = Count_1000;    \n                        delay[0] = data;\n            end         \n            Count_1000: next_state = count_state ? Done : Count_1000;\n            Done:       next_state = ack ? IDLE : Done;\n            default:    next_state = IDLE;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset) begin\n            current_state <= IDLE;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    assign count = (current_state == Count_1000) ? (delay - already_count) : 4'd0;\n    assign counting = (current_state == Count_1000);\n    assign done = current_state == Done;\n\nendmodule\n```\n\n### FSMï¼šOne-hot logic equations\n\nç”¨one-hotç¼–ç çš„çŠ¶æ€å†™å‡ºçŠ¶æ€è½¬ç§»ä»£ç ã€‚\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232207395.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module(\n    input d,\n    input done_counting,\n    input ack,\n    input [9:0] state,    // 10-bit one-hot current state\n    output B3_next,\n    output S_next,\n    output S1_next,\n    output Count_next,\n    output Wait_next,\n    output done,\n    output counting,\n    output shift_ena\n); //\n\n    // You may use these parameters to access state bits using e.g., state[B2] instead of state[6].\n    parameter S=0, S1=1, S11=2, S110=3, B0=4, B1=5, B2=6, B3=7, Count=8, Wait=9;\n\n    assign B3_next = state[B2];\n    assign S_next = ~d & state[S] | ~d & state[S1] | ~d & state[S110] | ack & state[Wait];\n    assign S1_next = d & state[S];\n    assign Count_next = state[B3] | ~done_counting & state[Count];\n    assign Wait_next = done_counting & state[Count] | ~ack & state[Wait];\n    assign done = state[Wait];\n    assign counting = state[Count];\n    assign shift_ena = state[B0] | state[B1] | state[B2] | state[B3];\n\nendmodule\n```\n\n## ç»“è¯­\n\nè¯¥å°ç»“å°±ç®—æ›´æ–°ç»“æŸäº†ï¼Œä¸‹é¢å‰©çš„ä¹Ÿä¸å¤šäº†ã€‚å¦‚æœ‰ä¸å¯¹çš„è¿˜æœ›å¤§å®¶æŒ‡æ­£ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(21)_Verilogæœ‰é™çŠ¶æ€æœº(8)","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(21)_Verilogæœ‰é™çŠ¶æ€æœº(8)/","content":"\n# Verilogæœ‰é™çŠ¶æ€æœº(8)\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©ç»§ç»­æ›´æ–°çŠ¶æ€æœºå°èŠ‚çš„ä¹ é¢˜ã€‚\n\n------\n\n## é¢˜åº“\n\n### Q2a:FSM\n\næ­£å®—çš„FSMé¢˜ï¼Œæ²¡å•¥è¯´çš„ï¼Œçœ‹å›¾å†™ä»£ç ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232206848.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,   // Synchronous active-high reset\n    input w,\n    output z\n);\n\n    parameter A = 3'd0, B = 3'd1, C = 3'd2;\n    parameter D = 3'd3, E = 3'd4, F = 3'd5;\n    reg [2:0] current_state, next_state;\n\n    always @(*) begin\n        case(current_state)\n            A:      next_state = w ? B : A;\n            B:      next_state = w ? C : D;\n            C:      next_state = w ? E : D;\n            D:      next_state = w ? F : A;\n            E:      next_state = w ? E : D;\n            F:      next_state = w ? C : D;\n            default:next_state = A;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset) begin\n            current_state <= A;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    assign z = (current_state == E) | (current_state == F);\n\nendmodule\n```\n\n### Q2b:One-hot FSM equations\n\nçŠ¶æ€ä½¿ç”¨ç‹¬çƒ­ç¼–ç ï¼Œå°†çŠ¶æ€ä¸­çš„y[1]å’Œy[3]è¡¨ç¤ºå‡ºæ¥ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [5:0] y,\n    input w,\n    output Y1,\n    output Y3\n);\n\n    assign Y1 = y[0] & w;\n    assign Y3 = (y[1] | y[2] | y[4] | y[5]) & ~w;\n    \nendmodule\n```\n\n### Q2a:FSM\n\næœ¬é¢˜æ˜¯ç”¨çŠ¶æ€æœºå®ç°ä¸€ä¸ªåˆ¤ä¼˜å™¨ã€‚å…¶ä¸­r1ã€r2ã€r3åˆ†åˆ«è¡¨ç¤ºä¸‰ç§è®¾å¤‡çš„requestï¼Œg1ã€g2ã€g3è¡¨ç¤ºèµ„æºçš„åˆ†é…æƒ…å†µã€‚ç”±ä¸‹é¢çš„çŠ¶æ€å›¾å¯è§ï¼Œè®¾å¤‡1,2,3çš„ä¼˜å…ˆçº§ä¾æ¬¡é€’å‡ã€‚å½“è®¾å¤‡è¯·æ±‚åˆ°èµ„æºæ—¶ï¼Œéœ€ç­‰å…¶å®Œæˆä»»åŠ¡æ‰èƒ½é‡Šæ”¾èµ„æºã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232206772.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input resetn,    // active-low synchronous reset\n    input [3:1] r,   // request\n    output [3:1] g   // grant\n);\n\n    parameter A = 2'd0, B = 2'd1;\n    parameter C = 2'd2, D = 2'd3;\n    reg [1:0] current_state, next_state;\n\n    always @(*) begin\n        case(current_state)\n            A:begin\n                if(r[1] == 1'b1) begin\n                    next_state = B;\n                end\n                else if(r[2] == 1'b1) begin\n                    next_state = C;\n                end\n                else if(r[3] == 1'b1) begin\n                    next_state = D;\n                end\n                else begin\n                    next_state = A;\n                end\n            end\n            B:       next_state = r[1] ? B : A;\n            C:       next_state = r[2] ? C : A;\n            D:       next_state = r[3] ? D : A;\n            default: next_state = A;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(~resetn) begin\n            current_state <= A;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    assign g[1] = current_state == B;\n    assign g[2] = current_state == C;\n    assign g[3] = current_state == D;\n\nendmodule\n```\n\n### Q2b:Another FSM\n\nè¯¥é¢˜çš„çŠ¶æ€æœºå…±2è¾“å…¥2è¾“å‡ºï¼›å½“å¤ä½ä¿¡å·æ’¤é”€æ—¶ï¼Œåœ¨ä¸‹ä¸€ä¸ªå‘¨æœŸå†…å°†fè¾“å‡ºä¸º1ï¼Œéœ€ç•™æ„fä¸º1æŒç»­ä¸€ä¸ªå‘¨æœŸï¼›ç„¶åçŠ¶æ€æœºå–å†³äºxçš„å€¼ï¼Œå½“xåœ¨è¿ç»­çš„ä¸‰ä¸ªå‘¨æœŸä¸­äº§ç”Ÿå€¼ä¸º1ã€0ã€1æ—¶ï¼Œä¸‹ä¸€å‘¨æœŸå°†gè¾“å‡ºä¸º1ï¼Œ<u>åœ¨ä¿æŒgä¸º1æ—¶åˆ¤æ–­yçš„è¾“å…¥</u>ï¼Œå¦‚æœyåœ¨ä¸¤ä¸ªå‘¨æœŸä¸­æœ‰ä»»æ„ä¸€ä¸ªå‘¨æœŸä¸º1äº†ï¼Œé‚£ä¹ˆgæ°¸ä¹…ä¿æŒ1ï¼›å¦‚æœä¸¤ä¸ªå‘¨æœŸéƒ½æ²¡æœ‰1ï¼Œé‚£ä¹ˆgå°†æ°¸ä¹…ä¿æŒ0ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input resetn,    // active-low synchronous reset\n    input x,\n    input y,\n    output f,\n    output g\n); \n\n    parameter IDLE = 4'd0, FOUT = 4'd1, S1 = 4'd2;\n    parameter S2 = 4'd3, S3 = 4'd4, S4 = 4'd5;\n    parameter S5 = 4'd6, ALL_ONE = 4'd7, ALL_ZERO = 4'd8;\n    reg [3:0] current_state, next_state;\n\n    always @(*) begin\n        case(current_state)\n            IDLE:       next_state = FOUT;\n            FOUT:       next_state = S1;\n            S1:         next_state = x ? S2 : S1;\n            S2:         next_state = x ? S2 : S3;\n            S3:         next_state = x ? S4 : S1;\n            S4:         next_state = y ? ALL_ONE : S5;\n            S5:         next_state = y ? ALL_ONE : ALL_ZERO;\n            ALL_ONE:    next_state = ALL_ONE;\n            ALL_ZERO:   next_state = ALL_ZERO;\n            default:    next_state = IDLE;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(~resetn) begin\n            current_state <= IDLE;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    assign f = current_state == FOUT;\n    assign g = current_state == S4 | current_state == S5 | current_state == ALL_ONE;\n\nendmodule\n```\n\nå¿ƒå¾—ï¼šçŠ¶æ€æœºè®¾è®¡çš„å¥½åå†³å®šä»£ç çš„éš¾æ˜“ç¨‹åº¦ï¼Œåœ¨ç”»çŠ¶æ€è½¬ç§»å›¾æ—¶å¯ä»¥å¤šç•™ç‚¹æ—¶é—´ã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232206654.png)\n\n## ç»“è¯­\n\nçŠ¶æ€æœºè¿™éƒ¨åˆ†é¢˜ç›®ç»ˆäºæ›´æ–°å®Œäº†ï¼Œè‡ªå·±åœ¨åšè¿™äº›é¢˜ç›®çš„è¿‡ç¨‹ä¸­æ”¶è·ä¹Ÿéå¸¸å¤§ï¼Œå¾ˆæ„Ÿè°¢è¯¥ç½‘ç«™çš„ä½œè€…ã€‚å¦‚æœä»£ç å“ªé‡Œæœ‰è¯¯ï¼Œè¯·å¤§å®¶æŒ‡æ­£ï¼Œè¯„è®ºåŒºä¹Ÿæ¬¢è¿å¤§å®¶äº¤æµä¸åŒçš„è§£é¢˜æ€è·¯ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(20)_Verilogæœ‰é™çŠ¶æ€æœº(7)","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(20)_Verilogæœ‰é™çŠ¶æ€æœº(7)/","content":"\n# Verilogæœ‰é™çŠ¶æ€æœº(7)\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©ç»§ç»­æ›´æ–°çŠ¶æ€æœºå°èŠ‚çš„ä¹ é¢˜ã€‚\n\n------\n\n## é¢˜åº“\n\n### Q3a:FSM\n\né¢˜ç›®é‡Œè¯´å½“sä¸º0æ—¶ï¼Œè¿›å…¥BçŠ¶æ€ï¼Œç„¶åä¼šæ£€æŸ¥wçš„å€¼ï¼Œå¦‚æœåœ¨æ¥ä¸‹æ¥çš„ä¸‰ä¸ªå‘¨æœŸä¸­wå€¼æ°å¥½æœ‰ä¸¤ä¸ªå‘¨æœŸéƒ½ä¸º1ï¼Œé‚£ä¹ˆzè¾“å‡º1ï¼Œå¦åˆ™zè¾“å‡º0ã€‚æ³¨æ„ï¼Œç”±ç¤ºä¾‹çš„æ³¢å½¢å›¾çœ‹åº”è¯¥æ˜¯ä¸é‡å æ£€æµ‹ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232204786.png)\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232204239.png)\n\n**Solution**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,   // Synchronous reset\n    input s,\n    input w,\n    output z\n);\n    parameter S0 = 1'd0, S1 = 1'd1;\n    reg current_state, next_state;\n    reg [1:0] counter,num_one;\n\n    always @(*) begin\n        case(current_state)\n            S0:     next_state = s ? S1 : S0;\n            S1:     next_state = S1;\n            default:next_state = S0;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            current_state <= S0;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            counter <= 2'd0;\n        end\n        else if(counter == 2'd2) begin\n            counter <= 2'd0;\n        end\n        else if(current_state == S1) begin\n            counter <= counter + 1'd1;\n        end\n    end\n\n    always @(posedge clk) begin\n        if(reset) begin\n            num_one <= 1'd0;\n        end\n        else begin\n            if(counter == 2'd0)begin\n                num_one <= w ? 1'd1 : 1'd0;\n            end\n            else if(current_state == S1) begin\n                num_one <= w ? (num_one+1'd1) : num_one;\n            end   \n        end          \n    end\n\n    assign z = (current_state == S1 && num_one == 2'd2 && counter == 2'd0);\n\nendmodule\n```\n\næ­¤é¢˜ä¸­æˆ‘ç”¨äº†ä¸¤ä¸ªè®¡æ•°å™¨æ¥å®Œæˆï¼Œéœ€ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ»¡è¶³å“ªç§æ¡ä»¶æ—¶è®¡æ•°å™¨æ¸…é›¶æˆ–è€…è‡ªåŠ ï¼Œä¸€å®šæ³¨æ„ï¼\n\n### Q3b:FSM\n\nè¯¥é¢˜è®©å®ç°ä¸‹å›¾æ‰€ç¤ºçš„çŠ¶æ€æœºï¼Œå…¶ä¸­å¤ä½ä¿¡å·è®©çŠ¶æ€è½¬ç§»è‡³000ï¼›\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232204468.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,   // Synchronous reset\n    input x,\n    output z\n);\n\n    parameter S0 = 3'b000, S1 = 3'b001, S2 = 3'b010;\n    parameter S3 = 3'b011, S4 = 3'b100;\n    reg [2:0] current_state, next_state;\n\n    always @(*) begin\n        case(current_state)\n            S0:     next_state = x ? S1 : S0;\n            S1:     next_state = x ? S4 : S1;\n            S2:     next_state = x ? S1 : S2;\n            S3:     next_state = x ? S2 : S1;\n            S4:     next_state = x ? S4 : S3;\n            default:next_state = S0;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            current_state <= S0;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            z <= 1'b0;\n        end\n        else begin\n            case(next_state)\n                S3:     z <= 1'b1;\n                S4:     z <= 1'b1;\n                default:z <= 1'b0;\n            endcase\n        end      \n    end\n\nendmodule\n```\n\nå¿ƒå¾—ï¼šç¬¬ä¸‰æ®µçŠ¶æ€æœºè¾“å‡ºç”¨åˆ°`next_state`åšæ¡ä»¶æ—¶ï¼Œè®°å¾—è¦å°†`reset`æ¡ä»¶åŠ ä¸Šï¼Œå› ä¸º`reset`å½±å“çš„æ˜¯`current_state`ï¼Œä¸å½±å“`next_state`ã€‚\n\n### Q3c:FSM logic\n\nç”±ä¸‹é¢çš„çŠ¶æ€è½¬ç§»è¡¨å°†Y[0]ä¸zè¡¨ç¤ºå‡ºæ¥ã€‚\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232204847.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input [2:0] y,\n    input x,\n    output Y0,\n    output z\n);\n\n    assign Y0 = ((~y[2]&y[0])|(y==3'b100))&~x | (~y[2]&~y[0])&x;\n    assign z = (y == 3'b011) | (y == 3'b100);\n\nendmodule\n```\n\n### Q6bï¼šFSM next-state logic\n\né€šè¿‡ä¸‹é¢çš„çŠ¶æ€è½¬ç§»è¡¨å°†Y[2]çš„ä¸‹ä¸€çŠ¶æ€è¡¨ç¤ºå‡ºæ¥ï¼Œå…¶ä¸­wä¸ºè¾“å…¥ã€‚\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232205665.png)\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232205948.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [3:1] y,\n    input w,\n    output Y2);\n\n    assign Y2 = (y == 3'b001 | y == 3'b101) & ~w | (y == 3'b001 | y == 3'b010 | y == 3'b100 | y == 3'b101) & w;\n    \nendmodule\n```\n\næŒ‰ä¸Šé¢æˆ‘åˆ—çš„çŠ¶æ€è½¬ç§»è¡¨å°†Y2è¡¨ç¤ºå‡ºæ¥å³å¯ã€‚\n\n### Q6c:FSM one-hot next-state logic\n\nè¿™é‡Œä½¿ç”¨äº†one-hotç¼–ç ï¼Œå°†Y2å’ŒY4è¾“å‡ºå‡ºæ¥ï¼Œæ€è·¯ä¸ä¸Šé¢˜ç±»ä¼¼ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [6:1] y,\n    input w,\n    output Y2,\n    output Y4);\n    \n    assign Y2 = ~w & y[1];\n    assign Y4 = (w & y[2])|(w & y[3])|(w & y[5])|(w & y[6]);\n\nendmodule\n```\n\n### Q6ï¼šFSM\n\nè¿™æ˜¯ä¸ªæ­£å®—çš„FSMé¢˜ï¼Œç…§ç€å›¾åˆ—çŠ¶æ€å³å¯ã€‚\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232205569.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,     // synchronous reset\n    input w,\n    output z);\n\n    parameter A = 3'd0, B = 3'd1, C=3'd2;\n    parameter D = 3'd3, E = 3'd4, F=3'd5;\n    reg [2:0] current_state, next_state;\n\n    always @(*) begin\n        case(current_state)\n            A:      next_state = w ? A : B;\n            B:      next_state = w ? D : C;\n            C:      next_state = w ? D : E;\n            D:      next_state = w ? A : F;\n            E:      next_state = w ? D : E;\n            F:      next_state = w ? D : C;\n            default:next_state = A;\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            current_state <= A;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    assign z = (current_state == E | current_state == F);\n\nendmodule\n```\n\n## ç»“è¯­\n\nä»Šå¤©å…ˆæ›´æ–°è¿™å‡ é¢˜å§ï¼ŒFSMè¿™éƒ¨åˆ†é¢˜ç›®éƒ½ç®—æ¯”è¾ƒåŸºç¡€çš„é¢˜ç›®ï¼Œä»£ç æœ‰ä¸è¶³ä¹‹å¤„è¿˜æœ›æŒ‡æ­£ï¼ŒçŠ¶æ€æœºéƒ¨åˆ†çš„é¢˜ç»ˆäºè¦ç»“æŸäº†ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(19)_Verilogæœ‰é™çŠ¶æ€æœº(6)","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(19)_Verilogæœ‰é™çŠ¶æ€æœº(6)/","content":"\n# Verilogæœ‰é™çŠ¶æ€æœº(6)\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©ç»§ç»­æ›´æ–°çŠ¶æ€æœºå°èŠ‚çš„ä¹ é¢˜ã€‚\n\n------\n\n## é¢˜åº“\n\n### Fsm hdlc\n\nåŒæ­¥å¸§æ£€æµ‹æ¶‰åŠå¯¹æ•°æ®çš„è¿ç»­ä½æµè¿›è¡Œè§£ç ï¼Œä»¥å¯»æ‰¾æŒ‡ç¤ºå¸§ï¼ˆæ•°æ®åŒ…ï¼‰å¼€å§‹å’Œç»“æŸçš„ä½æ¨¡å¼ã€‚ 6ä¸ªè¿ç»­çš„1ï¼ˆå³01111110ï¼‰æ˜¯è¡¨ç¤ºå¸§è¾¹ç•Œçš„â€œæ ‡å¿—â€ã€‚ ä¸ºäº†é¿å…æ•°æ®æµæ„å¤–åŒ…å«â€œæ ‡å¿—â€ï¼Œå‘é€æ–¹å¿…é¡»åœ¨æ¥æ”¶æ–¹å¿…é¡»æ£€æµ‹å¹¶ä¸¢å¼ƒçš„æ¯5ä¸ªè¿ç»­çš„1ç§’åæ’å…¥ä¸€ä¸ªé›¶ã€‚ å¦‚æœè¿ç»­7ä¸ªæˆ–æ›´å¤š1ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å‘å‡ºé”™è¯¯ä¿¡å·ã€‚\n\nå¯ä»¥é€šè¿‡çŠ¶æ€æœºæ¥è¯†åˆ«ä¸‹é¢ä¸‰ç§åºåˆ—ï¼š\n\n0111110ï¼šè¡¨ç¤º5ä¸ª1åé¢çš„0bitéœ€è¢«å¿½ç•¥ï¼›\n\n01111110ï¼šè¡¨ç¤ºä¸€å¸§çš„å¼€å§‹æˆ–ç»“æŸï¼›\n\n01111111...ï¼šé”™è¯¯\n\nå½“çŠ¶æ€æœºè¢«å¤ä½æ—¶ï¼Œå®ƒåº”å½“è¡¨ç°ä¸ºä¹‹å‰çš„è¾“å…¥ä¸º0ï¼›\n\nä¸‹é¢æ˜¯ä¸‰ç§æ³¢å½¢ç¤ºä¾‹ï¼š\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232203111.png)\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232203892.png)\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232203681.png)\n\nå®˜æ–¹æä¾›çš„çŠ¶æ€æœºè®¾è®¡æç¤ºï¼š\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232203790.png)\n\n**Solution**:\n\n```verilog\n//----------------way1----------------------\nmodule top_module(\n    input clk,\n    input reset,    // Synchronous reset\n    input in,\n    output disc,\n    output flag,\n    output err);\n\n    parameter NONE = 4'd0,ONE = 4'd1,TWO = 4'd2;\n    parameter THREE = 4'd3,FOUR = 4'd4,FIVE = 4'd5;\n    parameter SIX = 4'd6,ERROR = 4'd7;\n    parameter DISC = 4'd8,FLAG = 4'd9;\n\n    reg [3:0] current_state,next_state;\n\n    always @(*) begin\n        case(current_state)\n            NONE:begin\n                next_state = in ? ONE : NONE;\n            end\n            ONE:begin\n                next_state = in ? TWO : NONE;\n            end\n            TWO:begin\n                next_state = in ? THREE : NONE;\n            end\n            THREE:begin\n                next_state = in ? FOUR : NONE;\n            end\n            FOUR:begin\n                next_state = in ? FIVE : NONE;\n            end\n            FIVE:begin\n                next_state = in ? SIX : DISC;\n            end\n            SIX:begin\n                next_state = in ? ERROR : FLAG;\n            end\n            DISC:begin\n                next_state = in ? ONE : NONE;\n            end\n            FLAG:begin\n                next_state = in ? ONE : NONE;\n            end\n            ERROR:begin\n                next_state = in ? ERROR : NONE;\n            end\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            current_state <= NONE;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            disc <= 1'd0;\n            flag <= 1'd0;\n            err  <= 1'd0;\n        end\n        else begin\n            case(next_state)\n                DISC:begin\n                    disc <= 1'd1;\n                    flag <= 1'd0;\n                    err  <= 1'd0;\n                end\n                FLAG:begin\n                    disc <= 1'd0;\n                    flag <= 1'd1;\n                    err  <= 1'd0;\n                end\n                ERROR:begin\n                    disc <= 1'd0;\n                    flag <= 1'd0;\n                    err  <= 1'd1;\n                end\n                default:begin\n                    disc <= 1'd0;\n                    flag <= 1'd0;\n                    err  <= 1'd0;\n                end\n            endcase\n        end\n    end\n\nendmodule\n//----------------way2----------------------\nmodule top_module(\n    input clk,\n    input reset,    // Synchronous reset\n    input in,\n    output disc,\n    output flag,\n    output err);\n\n    parameter NONE = 3'd0,DATA = 3'd1;\n    parameter DISC = 3'd2,FLAG = 3'd3,ERROR = 3'd4;\n\n    reg [2:0] current_state,next_state;\n    reg [2:0] counter;\n\n    always @(*) begin\n        case(current_state)\n            NONE:begin\n                next_state = in ? DATA : NONE;\n            end\n            DATA:begin\n                case(counter)\n                    3'd5:   next_state = in ? DATA : DISC;\n                    3'd6:   next_state = in ? ERROR : FLAG;\n                    default:next_state = in ? DATA : NONE;\n                endcase\n            end\n            DISC:begin\n                next_state = in ? DATA : NONE;\n            end\n            FLAG:begin\n                next_state = in ? DATA : NONE;\n            end\n            ERROR:begin\n                next_state = in ? ERROR : NONE;\n            end\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            current_state <= NONE;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            disc <= 1'd0;\n            flag <= 1'd0;\n            err  <= 1'd0;\n            counter <= 3'd0;\n        end\n        else begin\n            case(next_state)\n                DATA:begin\n                    disc <= 1'd0;\n                    flag <= 1'd0;\n                    err  <= 1'd0;\n                    counter <= counter + 1'd1;\n                end\n                DISC:begin\n                    disc <= 1'd1;\n                    flag <= 1'd0;\n                    err  <= 1'd0;\n                    counter <= 3'd0;\n                end\n                FLAG:begin\n                    disc <= 1'd0;\n                    flag <= 1'd1;\n                    err  <= 1'd0;\n                    counter <= 3'd0;\n                end\n                ERROR:begin\n                    disc <= 1'd0;\n                    flag <= 1'd0;\n                    err  <= 1'd1;\n                    counter <= 3'd0;\n                end\n                default:begin\n                    disc <= 1'd0;\n                    flag <= 1'd0;\n                    err  <= 1'd0;\n                    counter <= 3'd0;\n                end\n            endcase\n        end\n    end\n\nendmodule\n```\n\nå…¶ä¸­way1ä¸é¢˜ç›®æç¤ºçš„æ€è·¯ç›¸åŒï¼Œå…¶ä¸­ç¬¬ä¸‰æ®µçŠ¶æ€æœºä¸€å¼€å§‹å¿˜è®°åŠ resetçš„é‚£ç§æƒ…å†µï¼Œæœç„¶è¿˜æ˜¯é•¿æ—¶é—´æ²¡æ¥è§¦verilogæ‰‹ç”Ÿäº†ï¼Œä»¥åç»§ç»­ç»ƒä¹ ï¼›\n\nway2ä½¿ç”¨counterå»æ‰ä¸­é—´çŠ¶æ€ï¼Œé è¾“å…¥å’Œcounterçš„å€¼æ¥å†³å®šçŠ¶æ€è½¬ç§»ï¼Œæ˜¯ä¸€ç§ç±³åˆ©çŠ¶æ€æœºçš„æ€æƒ³ï¼›çŠ¶æ€è½¬ç§»å›¾å¦‚ä¸‹(æ‰‹ç»˜æœ‰ç‚¹ä¸‘ï¼Œè§è°…)ï¼š\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232204068.png)\n\n### ç±³åˆ©å‹çŠ¶æ€æœº\n\næ£€æµ‹è¾“å…¥çš„Xä¸­â€101â€œæ˜¯å¦å‡ºç°ï¼Œå‡ºç°çš„è¯è¾“å‡ºZä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚å¤ä½ä¸ºå¼‚æ­¥ä½ç”µå¹³å¤ä½ï¼›åªå…è®¸å‡ºç°3ç§çŠ¶æ€ï¼›å…è®¸äº¤å æ£€æµ‹ï¼šå³è¾“å…¥è‹¥ä¸º10101æ—¶ï¼ŒZåº”è¯¥åœ¨æ—¶åˆ»3å’Œæ—¶åˆ»5å„è¾“å‡ºä¸€æ¬¡1ï¼›\n\nä»£ç ä¸­ä¸»è¦å¦™åœ¨ä¸¤å¤„ï¼šä¸€æ˜¯å¦‚ä½•ç”¨3ç§çŠ¶æ€è¡¨ç¤ºï¼Œéœ€åœ¨ç¬¬ä¸‰ç§çŠ¶æ€ä¸­å°†è¾“å‡ºä¸è¾“å…¥å…³è”èµ·æ¥ï¼›äºŒæ˜¯å¦‚ä½•è¿›è¡Œäº¤å æ£€æµ‹ï¼ŒçŠ¶æ€çš„è½¬ç§»æœ‰å¦™å¤„ï¼›\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input aresetn,    // Asynchronous active-low reset\n    input x,\n    output z ); \n\n    parameter S0 = 2'd0,S1 = 2'd1,S2 = 2'd2;\n    reg [1:0] current_state,next_state;\n\n    always @(*) begin\n        case(current_state)\n            S0: next_state = x ? S1 : S0;\n            S1: next_state = x ? S1 : S2;\n            S2: next_state = x ? S1 : S0;\n        endcase\n    end\n\n    always @(posedge clk or negedge aresetn) begin\n        if(~aresetn)begin\n            current_state <= S0;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    always @(*) begin\n        z = (current_state == S2) ? x : 1'b0;\n    end\n\nendmodule\n```\n\n### Q5a:Serial two's complementer(Moore FSM)\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232204746.png)\n\nä½œè€…è¿™é‡Œå‡è®¾æˆ‘ä»¬è¿™è¾¹è¾“å…¥çš„éƒ½æ˜¯è´Ÿæ•°ï¼Œä¸ç”¨ç®¡ç¬¦å·ä½çš„é—®é¢˜ï¼›å³è¡¥ç å…¨éƒ¨éƒ½æ˜¯å–ååŠ 1æ±‚å¾—ã€‚\n\nä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œè¾“å…¥çš„å·¦è¾¹ä¸ºä½ä½æ•°æ®ï¼Œå³è¾¹ä¸ºé«˜ä½æ•°æ®ï¼›å³è¾“å…¥ä¸º00110100ï¼Œåˆ™å–ååŠ 1åå¾—è¾“å‡ºä¸º11001100ï¼›\n\nå–åæ“ä½œå¥½è¿›è¡Œï¼Œä¸»è¦éº»çƒ¦åœ¨åŠ ä¸€çš„æ“ä½œä¸Šï¼Œä¸çŸ¥é“è¿›ä½åˆ°å“ªä¸€ä½ä¸ºæ­¢ï¼Œæ­¤æ—¶æˆ‘ä»¬ç”¨çŠ¶æ€æœºæ¥è§£å†³ï¼›<u>è‹¥æœ€å‰é¢çš„è¾“å…¥éƒ½æ˜¯0çš„è¯ï¼Œå–åå‡ä¸º1ï¼Œä½ä½åŠ 1çš„æ—¶å€™ä¸€ç›´è¿›ä½ï¼Œåˆ™è¾“å‡ºéƒ½æ˜¯0ï¼Œç›´åˆ°è¾“å…¥æœ‰ä¸ª1ä¸ºæ­¢(å–ååŠ 1ä¸è¿›ä½)ï¼Œè¿™ä¸€é˜¶æ®µæˆ‘ä»¬ç”¨ä¸€ä¸ªçŠ¶æ€S1æ¥è¡¨ç¤ºï¼›åé¢é˜¶æ®µå°±å°†è¾“å…¥å–åè¿›è¡Œè¾“å‡ºå³å¯ï¼Œå› ä¸ºè¿›ä½é“¾åœ¨S1çŠ¶æ€å·²ç»“æŸï¼›</u>\n\nå› ä¸ºæ˜¯æ‘©å°”å‹çŠ¶æ€æœºï¼Œè¾“å‡ºçš„ç»“æœä¸è¾“å…¥æ— å…³ï¼Œä»…ä¸çŠ¶æ€æœ‰å…³ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç”¨åˆ°3ä¸ªçŠ¶æ€ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input areset,\n    input x,\n    output z\n); \n\n    parameter S0 = 2'd0, S1 = 2'd1, S2 = 2'd2;\n    reg [1:0] current_state, next_state;\n\n    always @(*) begin\n        case(current_state)\n            S0:     next_state = x ? S1 : S0;\n            S1:     next_state = x ? S2 : S1;\n            S2:     next_state = x ? S2 : S1;\n        endcase\n    end\n\n    always @(posedge clk or posedge areset) begin\n        if(areset)begin\n            current_state <= S0;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    assign z = (current_state == S1);\n\nendmodule\n```\n\n### Q5b:Serial two's complementer(Mealy FSM)\n\né¢˜æ„ä¸ä¸Šé¢˜ç›¸åŒï¼Œæ­¤æ—¶ç”¨ç±³åˆ©å‹çŠ¶æ€æœºå®ç°ã€‚ä¸‹é¢æ˜¯å®˜æ–¹æä¾›çš„çŠ¶æ€è½¬ç§»æç¤ºï¼š\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232204552.png)\n\n```verilog\nmodule top_module (\n    input clk,\n    input areset,\n    input x,\n    output z\n); \n\n    parameter S0 = 1'b0, S1 = 1'b1;\n    reg current_state,next_state;\n\n    always @(*) begin\n        case(current_state)\n            S0:     next_state = x ? S1 : S0;\n            S1:     next_state = S1;\n        endcase\n    end\n\n    always @(posedge clk or posedge areset) begin\n        if(areset)begin\n            current_state <= S0;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    assign z = ((current_state == S0) && x) || ((current_state == S1) && ~x);\n\nendmodule\n```\n\n## ç»“è¯­\n\nä»Šå¤©å…ˆæ›´æ–°è¿™å‡ é¢˜å§ï¼Œå¤§å®¶å¦‚æœå¯¹è½¬è¡¥ç çš„é¢˜ç›®è¿˜æœ‰ä»€ä¹ˆç–‘é—®æ¬¢è¿è¯„è®ºäº¤æµï¼Œä»£ç æœ‰ä¸è¶³ä¹‹å¤„è¿˜æœ›æŒ‡æ­£ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(18)_Verilogæœ‰é™çŠ¶æ€æœº(5)","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(18)_Verilogæœ‰é™çŠ¶æ€æœº(5)/","content":"\n# Verilogæœ‰é™çŠ¶æ€æœº(5)\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©ç»§ç»­æ›´æ–°çŠ¶æ€æœºå°èŠ‚çš„ä¹ é¢˜ã€‚\n\n------\n\n## é¢˜åº“\n\n**é¢˜ç›®æè¿°1ï¼š**\n\nç¬¬ä¸€é“é¢˜ç›®æ¯”è¾ƒå®¹æ˜“ï¼Œé¢˜ç›®ä¸­çš„inä¿¡å·åŒ…å«äº†ä¸€ä¸ªèµ·å§‹ä½ï¼ˆ0ï¼‰ï¼Œ8ä¸ªæ•°æ®ä½å’Œä¸€ä¸ªåœæ­¢ä½ï¼ˆ1ï¼‰ï¼Œå¼€å§‹inä¸º1ï¼Œä¹Ÿå°±æ˜¯IDLEçŠ¶æ€ï¼Œå½“inä¸º0æ—¶ï¼Œè¿›å…¥STARTçŠ¶æ€ï¼Œç„¶åç»è¿‡8ä¸ªå‘¨æœŸï¼Œå¦‚æœinä¸º1ï¼Œåˆ™è¿›å…¥STOPçŠ¶æ€ï¼Œæ¥ç€å¦‚æœinä¸º0ï¼Œè¿›å…¥ç¬¬äºŒè½®STARTçŠ¶æ€ï¼Œå¦åˆ™è¿›å…¥IDLEçŠ¶æ€ã€‚\n\nè¿™é‡Œæˆ‘ç”¨äº†å¾ˆå¤šä¸ªçŠ¶æ€ï¼Œå®é™…ä¸Šå¯ä»¥ç”¨è®¡æ•°å™¨æ¥ä»£æ›¿ä¸­é—´çš„8ä¸ªçŠ¶æ€ï¼Œè¿™é‡Œæ˜¯8ä¸ªå‘¨æœŸï¼Œå¦‚æœæ˜¯100ä¸ªã€200ä¸ªå‘¨æœŸï¼Œé‚£ä¹ˆéœ€è¦100ä¸ªã€200ä¸ªçŠ¶æ€ï¼Œæ˜¾ç„¶ä¸ç°å®ã€‚è¿™é“é¢˜ç›®æ˜¯ä¸‰é“é¢˜ç›®ä¸­çš„åŸºç¡€é¢˜ï¼Œå¤§å®¶ä¸ç”¨è€ƒè™‘é‚£ä¹ˆå¤šï¼Œç›´æ¥å®Œæˆå°±å¥½äº†ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232203628.png)\n\n**Solution1ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input in,\n    input reset,    // Synchronous reset\n    output done\n); \n    parameter [3:0] START = 4'd0;\n    parameter [3:0] ONE = 4'd1;\n    parameter [3:0] TWO = 4'd2;\n    parameter [3:0] THREE = 4'd3;\n    parameter [3:0] FOUR = 4'd4;\n    parameter [3:0] FIVE = 4'd5;\n    parameter [3:0] SIX = 4'd6;\n    parameter [3:0] SEVEN = 4'd7;\n    parameter [3:0] EIGHT = 4'd8;\n    parameter [3:0] STOP = 4'd9;\n    parameter [3:0] IDLE = 4'd10;\n    parameter [3:0] WAIT = 4'd11;\n    \n    reg [3:0] state,next_state;\n    \n    always @(*)begin\n        case(state)\n            START:begin\n                next_state = ONE;\n            end\n            ONE:begin\n                next_state = TWO;\n            end\n            TWO:begin\n                next_state = THREE;\n            end\n            THREE:begin\n                next_state = FOUR;\n            end\n            FOUR:begin\n                next_state = FIVE;\n            end\n            FIVE:begin\n                next_state = SIX;\n            end\n            SIX:begin\n                next_state = SEVEN;\n            end\n            SEVEN:begin\n                next_state = EIGHT;\n            end\n            EIGHT:begin\n                if(in)begin\n                    next_state = STOP;\n                end\n                else begin\n                    next_state = WAIT;\n                end\n            end\n            STOP:begin\n                if(in)begin\n                    next_state = IDLE;\n                end\n                else begin\n                    next_state = START;\n                end\n            end\n            WAIT:begin\n                if(in)begin\n                    next_state = IDLE;\n                end\n                else begin\n                    next_state = WAIT;\n                end\n            end\n            IDLE:begin\n                if(~in)begin\n                    next_state = START;\n                end\n                else begin\n                    next_state = IDLE;\n                end\n            end\n        endcase\n    end\n    \n    always @(posedge clk)begin\n        if(reset)begin\n            state <= IDLE;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n    \n    assign done = (state == STOP);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°2ï¼š**\n\nè¿™é“é¢˜ç›®æ˜¯ä¸Šä¸€é“é¢˜ç›®çš„æ‰©å±•ï¼Œä¸ä»…éœ€è¦è¾“å‡ºdoneä¿¡å·ï¼Œè¿˜éœ€è¦è¾“å‡ºæ•°æ®ã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232203720.png)\n\n**Solution2ï¼š**\n\n```verilog\n/* way 1*/\nmodule top_module(\n    input clk,\n    input in,\n    input reset,    // Synchronous reset\n    output [7:0] out_byte,\n    output done\n); //\n    \n    parameter [3:0] START = 4'd0;\n    parameter [3:0] ONE = 4'd1;\n    parameter [3:0] TWO = 4'd2;\n    parameter [3:0] THREE = 4'd3;\n    parameter [3:0] FOUR = 4'd4;\n    parameter [3:0] FIVE = 4'd5;\n    parameter [3:0] SIX = 4'd6;\n    parameter [3:0] SEVEN = 4'd7;\n    parameter [3:0] EIGHT = 4'd8;\n    parameter [3:0] STOP = 4'd9;\n    parameter [3:0] IDLE = 4'd10;\n    parameter [3:0] WAIT = 4'd11;\n    \n    reg [3:0] state,next_state;\n    \n    reg [7:0]\tpar_in;\n    \n    always @(*)begin\n        case(state)\n            START:begin\n                next_state = ONE;\n                par_in[0] = in;\n            end\n            ONE:begin\n                next_state = TWO;\n                par_in[1] = in;\n            end\n            TWO:begin\n                next_state = THREE;\n                par_in[2] = in;\n            end\n            THREE:begin\n                next_state = FOUR;\n                par_in[3] = in;\n            end\n            FOUR:begin\n                next_state = FIVE;\n                par_in[4] = in;\n            end\n            FIVE:begin\n                next_state = SIX;\n                par_in[5] = in;\n            end\n            SIX:begin\n                next_state = SEVEN;\n                par_in[6] = in;\n            end\n            SEVEN:begin\n                next_state = EIGHT;\n                par_in[7] = in;\n            end\n            EIGHT:begin\n                if(in)begin\n                    next_state = STOP;\n                end\n                else begin\n                    next_state = WAIT;\n                end\n            end\n            STOP:begin\n                if(in)begin\n                    next_state = IDLE;\n                end\n                else begin\n                    next_state = START;\n                end\n            end\n            WAIT:begin\n                if(in)begin\n                    next_state = IDLE;\n                end\n                else begin\n                    next_state = WAIT;\n                end\n            end\n            IDLE:begin\n                if(~in)begin\n                    next_state = START;\n                end\n                else begin\n                    next_state = IDLE;\n                end\n            end\n        endcase\n    end\n    \n    always @(posedge clk)begin\n        if(reset)begin\n            state <= IDLE;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n    \n    assign done = (state == STOP);\n    assign out_byte = (state == STOP) ? par_in : 8'd0;\n\nendmodule\n\n/* way 2 */\nmodule top_module(\n    input clk,\n    input in,\n    input reset,    // Synchronous reset\n    output [7:0] out_byte,\n    output done\n); \n\tparameter IDLE = 3'd0, START = 3'd1, DATA = 3'd2;\n    parameter STOP = 3'd3, WAIT = 3'd4;\n    reg [3:0]\tcurrent_state;\n    reg [3:0]\tnext_state;\n    reg [3:0]\tcounter;\n    reg [7:0]\tpar_in;\n    // Use FSM from Fsm_serial\n    always @(*)begin\n        case(current_state)\n            IDLE:begin\n                if(~in)begin\n                    next_state = START;\n                end\n                else begin\n                    next_state = IDLE;\n                end\n            end\n            START:begin\n                next_state = DATA;\n            end\n            DATA:begin\n                if(counter == 4'd8)begin\n                    next_state = in? STOP:WAIT;\n                end\n                else begin\n                    next_state = DATA;\n                end\n            end\n            STOP:begin\n                next_state = in? IDLE:START;\n            end\n            WAIT:begin\n                next_state = in? IDLE:WAIT;\n            end\n            default:begin\n                next_state = IDLE;\n            end\n        endcase\n    end\n    \n    always @(posedge clk)begin\n        if(reset)begin\n            current_state <= IDLE;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    always @(posedge clk)begin\n        if(reset)begin\n            done <= 1'd0;\n            out_byte <= 8'd0;\n            counter <= 4'd0;\n        end\n        else begin\n            case(next_state)\n                IDLE:begin\n                    done <= 1'd0;\n           \t\t    out_byte <= 8'd0;\n            \t\tcounter <= 4'd0;\n                end\n                START:begin\n                    done <= 1'd0;\n           \t\t    out_byte <= 8'd0;\n            \t\tcounter <= 4'd0;\n                end\n                DATA:begin\n                    done <= 1'd0;\n           \t\t    out_byte <= 8'd0;\n                    par_in[counter] <= in;\n            \t\tcounter <= counter + 1'd1;\n                end\n                STOP:begin\n                    done <= 1'd1;\n           \t\t    out_byte <= par_in;\n            \t\tcounter <= 4'd0;\n                end\n                WAIT:begin\n                    done <= 1'd0;\n           \t\t    out_byte <= 8'd0;\n            \t\tcounter <= 4'd0;\n                end\n            endcase\n        end\n    end\n    // New: Datapath to latch input bits.\n\nendmodule\n```\n\nä¸Šè¿°ç¬¬ä¸€ç§è§£æ³•è™½ç„¶æ­£ç¡®ï¼Œä½†æ˜¯ä¼šç”Ÿæˆé”å­˜å™¨ï¼Œå¹¶ä¸”è¿™é‡Œåªæœ‰1ä¸ªå­—èŠ‚æ•°æ®è¿˜å¥½ï¼Œç”¨8ä¸ªçŠ¶æ€æ˜¯å¯ä»¥çš„ï¼Œå¦‚æœæ¢æˆäº†10ä¸ªå­—èŠ‚ã€100ä¸ªå­—èŠ‚ï¼Œéš¾é“è¦80ã€800ä¸ªçŠ¶æ€å—ï¼Ÿè¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œäºæ˜¯ä¾¿è¯ç”Ÿäº†**æ–¹æ³•äºŒ**åšä¸»æœ€æƒ³è®©å¤§å®¶ä½¿ç”¨çš„æ–¹æ³•ã€‚å¤§å®¶å¯ä»¥å¥½å¥½çœ‹ä¸€ä¸‹ï¼Œè¿™é‡Œå°†8ä¸ªæ•°æ®çŠ¶æ€å®šä¹‰æˆäº†ä¸€ä¸ªDATAçŠ¶æ€ï¼Œä¸ç”¨å®šä¹‰S1ã€S2ã€S3ä»€ä¹ˆçš„äº†ï¼Œåœ¨çŠ¶æ€æœºçš„ç¬¬ä¸‰æ®µï¼Œå°†é™¤äº†**DATAçŠ¶æ€çš„å…¶ä»–çŠ¶æ€æ—¶çš„counteréƒ½æ¸…é›¶**ï¼Œåªæœ‰åˆ°äº†**DATAçŠ¶æ€æ—¶å¼€å§‹è®¡æ•°**ï¼Œé¡ºä¾¿å°†**par_inä¸­çš„ä½æ•°ç”¨counterä»£æ›¿**ï¼Œè¿™æ ·åªéœ€è¦å¢åŠ counterå’Œout_byteçš„ä½å®½ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å®½åº¦æ•°æ®çš„è¾“å‡ºï¼Œå®ç”¨æ€§å¼ºã€‚\n\n**é¢˜ç›®æè¿°3ï¼š**\n\nè¾ƒä¸Šé¢˜æ·»åŠ äº†å¥‡å¶æ ¡éªŒä½ã€‚\n\n```verilog\nmodule top_module(\n    input clk,\n    input in,\n    input reset,    // Synchronous reset\n    output [7:0] out_byte,\n    output done\n); //\n\t\n    parameter IDLE = 3'd0,START = 3'd1,DATA = 3'd2;\n    parameter STOP = 3'd3,WAIT = 3'd4;\n\n    reg [2:0] current_state,next_state;\n    reg [3:0] counter;\n    reg [8:0] data_in;\n    reg odd_temp;\n    wire Isdone;\n\n    // Modify FSM and datapath from Fsm_serialdata\n    always @(*) begin\n        case(current_state)\n            IDLE:begin\n                if(~in)begin\n                    next_state = START;\n                end\n                else begin\n                    next_state = IDLE;\n                end\n            end\n            START:begin\n                next_state = DATA;\n            end\n            DATA:begin\n                if(counter == 4'd9)begin\n                    next_state = in ? STOP : WAIT;\n                end\n                else begin\n                    next_state = DATA;\n                end\n            end\n            STOP:begin\n                next_state = in ? IDLE : START;\n            end\n            WAIT:begin\n                next_state = in ? IDLE : WAIT;\n            end\n            default:begin\n                next_state = IDLE;\n            end\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            current_state <= IDLE;\n        end\n        else begin\n            current_state <= next_state;\n        end\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            done <= 1'd0;\n            out_byte <= 8'd0;\n            counter <= 4'd0;\n        end\n        else begin\n            case(next_state)\n                IDLE:begin\n                    done <= 1'd0;\n                    out_byte <= 8'd0;\n                    counter <= 4'd0;\n                end\n                START:begin\n                    done <= 1'd0;\n                    out_byte <= 8'd0;\n                    counter <= 4'd0;\n                end\n                DATA:begin\n                    done <= 1'd0;\n                    out_byte <= 8'd0;\n                    counter <= counter + 1'd1;\n                    data_in[counter] <= in;\n                end\n                STOP:begin\n                    done <= odd_temp ? 1'd1 : 1'd0;\n                    out_byte <= odd_temp ? data_in[7:0] : 8'd0;\n                    counter <= 4'd0;\n                end\n                WAIT:begin\n                    done <= 1'd0;\n                    out_byte <= 8'd0;\n                    counter <= 4'd0;\n                end\n            endcase\n        end\n    end\n    // New: Add parity checking.\n    assign Isdone = (next_state == START);\n    parity u0(clk,Isdone,in,odd_temp);\n\nendmodule\n```\n\nè¯¥é¢˜ç­”æ¡ˆä¸ä¸Šé¢˜ç±»ä¼¼ï¼Œè¿™é‡Œæˆ‘å°†å¥‡å¶æ ¡éªŒä½æ•°æ®ä¹Ÿè®¡ç®—åœ¨DATAçŠ¶æ€å†…ï¼Œåˆ¤æ–­èµ·æ¥ç›¸å¯¹è¾ƒå®¹æ˜“ï¼Œå¤§å®¶å¯ä»¥å€Ÿé‰´ä¸€ä¸‹ã€‚\n\n**æ³¨æ„ä½œè€…åœ¨é¢˜ç›®ä¸­ç»™äº†å¥‡å¶æ ¡éªŒçš„æ¨¡å—ï¼Œå¤§å®¶ç›´æ¥è°ƒç”¨å³å¯ã€‚**\n\n## ç»“è¯­\n\nå¥½ä¹…æ²¡æ›´æ–°HDLBitsäº†ï¼Œå¯’å‡åœ¨å®¶é—²æ¥æ— äº‹ï¼Œå¸Œæœ›å‹‰åŠ±è‡ªå·±æŠŠHDLBitsåˆ·å®Œå§ï¼ŒåŠ æ²¹ï¼æœ‰é—®é¢˜çš„åœ°æ–¹æ¬¢è¿å¤§å®¶ä¸æˆ‘è®¨è®ºäº¤æµã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(17)_Verilogæœ‰é™çŠ¶æ€æœº(4)","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(17)_Verilogæœ‰é™çŠ¶æ€æœº(4)/","content":"\n# Verilogæœ‰é™çŠ¶æ€æœº(4)\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©ç»§ç»­æ›´æ–°çŠ¶æ€æœºå°èŠ‚çš„ä¹ é¢˜ã€‚\n\n------\n\n## é¢˜åº“\n\n**é¢˜ç›®æè¿°1ï¼š**\n\nOne-hot FSM\n\nç‹¬çƒ­ç¼–ç ï¼Œæ ¹æ®çŠ¶æ€è½¬ç§»å›¾è¾“å‡ºä¸‹ä¸€çŠ¶æ€ä¸ç»“æœã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232202048.png)\n\n**Solution1ï¼š**\n\n```verilog\nmodule top_module(\n    input in,\n    input [9:0] state,\n    output [9:0] next_state,\n    output out1,\n    output out2);\n    \n    parameter S0 = 4'd0;\n    parameter S1 = 4'd1;\n    parameter S2 = 4'd2;\n    parameter S3 = 4'd3;\n    parameter S4 = 4'd4;\n    parameter S5 = 4'd5;\n    parameter S6 = 4'd6;\n    parameter S7 = 4'd7;\n    parameter S8 = 4'd8;\n\tparameter S9 = 4'd9;\n    \n    assign next_state[0] = ~in & (state[S0] | state[S1] | state[S2] | state[S3] | state[S4] | state[S7] | state[S8] | state[S9]);\n    assign next_state[1] = in & (state[S0] | state[S8] | state[S9]);\n    assign next_state[2] = in & state[S1];\n    assign next_state[3] = in & state[S2];\n    assign next_state[4] = in & state[S3];\n    assign next_state[5] = in & state[S4];\n    assign next_state[6] = in & state[S5];\n    assign next_state[7] = in & (state[S6] | state[S7]);\n    assign next_state[8] = ~in & state[S5];\n    assign next_state[9] = ~in & state[S6];\n    \n    assign out1 = (state[S8] | state[S9]);\n    assign out2 = (state[S7] | state[S9]);\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°2ï¼š**\n\n PS/2 packet parser\n\né¦–å…ˆï¼Œè¿™é“é¢˜ç›®ä¸­ä½œè€…è¡¨æ˜inçš„ç¬¬3ä½ä¸º1æ—¶ï¼ŒçŠ¶æ€æœºå¯åŠ¨ï¼Œå…¶ä»–ä¸¤ä½å¯èƒ½ä¸º1æˆ–0ï¼Œæ³¨æ„ï¼Œè¿™é‡Œä¸å…è®¸é‡å æ£€æµ‹ï¼Œæ ¹æ®ä½œè€…ç»™å‡ºçš„æ—¶åºå›¾ï¼Œå¤§å®¶åº”è¯¥å°±å¯ä»¥å†™å‡ºçŠ¶æ€æœºäº†ã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232202256.png)\n\n**Solution2ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input [7:0] in,\n    input reset,    // Synchronous reset\n    output done); //\n\n    parameter BYTE_FIRST = 2'd0;\n    parameter BYTE_SECOND = 2'd1;\n    parameter BYTE_THIRD = 2'd2;\n    parameter WAIT = 2'd3;\n    \n    reg [1:0] state,next_state;\n    // State transition logic (combinational)\n    always @(*)begin\n        case(state)\n            BYTE_FIRST:begin\n                next_state = BYTE_SECOND;\n            end\n            BYTE_SECOND:begin\n                next_state = BYTE_THIRD;\n            end\n            BYTE_THIRD:begin\n                if(in[3] == 1'b1)begin\n                    next_state = BYTE_FIRST;\n                end\n                else begin\n                    next_state = WAIT;\n                end\n            end\n            WAIT:begin\n                if(in[3] == 1'b1)begin\n                    next_state = BYTE_FIRST;\n                end\n                else begin\n                    next_state = WAIT;\n                end\n            end\n        endcase\n    end\n    \n    // State flip-flops (sequential)\n    always @(posedge clk)begin\n        if(reset)begin\n            state <= WAIT;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n    \n    // Output logic\n    assign done = (state == BYTE_THIRD);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°3ï¼š**\n\nPS/2 packet parser and datapath\n\nè¿™é“é¢˜ç›®ç›¸æ¯”ä¸Šä¸€é“å¤šäº†æ•°æ®ä½è¾“å‡ºï¼Œå½“doneä¿¡å·ä¸º1æ—¶ï¼Œè¾“å‡º24bitçš„æ•°æ®ï¼Œè¿™24bitçš„æ•°æ®é«˜8ä½ï¼Œä¸­8ä½ï¼Œä½8ä½åˆ†åˆ«ä»in[3]ä¸º1å¼€å§‹è®¡èµ·ï¼Œä¾æ¬¡è¾“å‡ºã€‚doneä¿¡å·ä¸º0çš„æ—¶å€™ä¸å…³å¿ƒæ•°æ®ä¿¡å·ã€‚é«˜8ä½è¾“å‡ºä»…å½“ä¸‹ä¸€çŠ¶æ€ä¸º`BYTE_SECOND`æ‰å¼€å§‹ï¼Œæ­¤å¤„å¯ä»¥ç®€åŒ–åˆ¤æ–­é€»è¾‘ï¼Œå¤§å®¶å¯ä»¥æ³¨æ„ä¸€ä¸‹ã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232202630.png)\n\n**Solution3ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input [7:0] in,\n    input reset,    // Synchronous reset\n    output [23:0] out_bytes,\n    output done); //\n\n    parameter BYTE_FIRST = 2'd0;\n    parameter BYTE_SECOND = 2'd1;\n    parameter BYTE_THIRD = 2'd2;\n    parameter DONE = 2'd3;\n    \n    reg [1:0] state,next_state;\n    reg [23:0] out_bytes_reg;\n    // FSM from fsm_ps2\n    always @(posedge clk)begin\n        if(reset)begin\n            state <= BYTE_FIRST;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n    \n    always @(*)begin\n        case(state)\n            BYTE_FIRST:begin\n                if(in[3])begin\n                    next_state = BYTE_SECOND;\n                end\n                else begin\n                    next_state = BYTE_FIRST;\n                end\n            end\n            BYTE_SECOND:begin\n                next_state = BYTE_THIRD;\n            end\n            BYTE_THIRD:begin\n                next_state = DONE;\n            end\n            DONE:begin\n                if(in[3])begin\n                    next_state = BYTE_SECOND;\n                end\n                else begin\n                    next_state = BYTE_FIRST;\n                end\n            end\n        endcase\n    end\n\n    always @(posedge clk)begin\n        if(next_state == BYTE_SECOND)begin\n            out_bytes_reg[23:16] <= in;\n        end\n        else if(next_state == BYTE_THIRD)begin\n            out_bytes_reg[15:8] <= in;\n        end\n        else if(next_state == DONE)begin\n            out_bytes_reg[7:0] <= in;\n        end\n        else begin\n            out_bytes_reg <= 24'd0;\n        end\n    end\n    // New: Datapath to store incoming bytes.\n    assign done = (state == DONE);\n    assign out_bytes = out_bytes_reg;\n\nendmodule\n```\n\n------\n\n## ç»“è¯­\n\nä»Šå¤©å°±å…ˆæ›´æ–°è¿™ä¸‰é¢˜å§ï¼Œè‹¥ä»£ç æœ‰é”™è¯¯å¸Œæœ›å¤§å®¶åŠæ—¶æŒ‡å‡ºï¼Œæˆ‘ä¼šå°½å¿«æ”¹æ­£ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(16)_Verilogæœ‰é™çŠ¶æ€æœº(3)","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(16)_Verilogæœ‰é™çŠ¶æ€æœº(3)/","content":"\n# Verilogæœ‰é™çŠ¶æ€æœº(3)\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©ç»§ç»­æ›´æ–°çŠ¶æ€æœºå°èŠ‚çš„ä¹ é¢˜ï¼Œæœ¬ç« ä¸»è¦ç¼–å†™Lemmings Gameéƒ¨åˆ†ã€‚\n\n------\n\n## é¢˜åº“\n\n**é¢˜ç›®æè¿°10ï¼š**\n\nGame Lemmings1ï¼šæœ‰ä¸ªå°äººå·¦å³èµ°ï¼Œå®ƒåªæœ‰ä¸¤ç§çŠ¶æ€ï¼šå‘å·¦èµ°å’Œå‘å³èµ°ï¼›å·¦è¾¹ç¢°åˆ°ä¸œè¥¿ä¹‹åå®ƒå°±å‘å³èµ°ï¼Œå³è¾¹ç¢°åˆ°ä¸œè¥¿ä¹‹åå®ƒå°±å‘å·¦èµ°ï¼Œä¸¤è¾¹éƒ½ç¢°åˆ°ä¸œè¥¿å°±è·Ÿå½“å‰æ–¹å‘çš„åæ–¹å‘èµ°ï¼›å¤ä½æ—¶å°äººå‘å·¦èµ°\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232201455.png)\n\n**Solution10ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input areset,    // Freshly brainwashed Lemmings walk left.\n    input bump_left,\n    input bump_right,\n    output walk_left,\n    output walk_right); //  \n\n    parameter LEFT=1'b0, RIGHT=1'b1;\n    reg state, next_state;\n    wire [1:0] bump;\n    assign bump = {bump_left,bump_right};\n\n    always @(*) begin\n        case(state)\n        \tLEFT:begin\n                if((bump == 2'b10) || (bump == 2'b11))begin\n                    next_state = RIGHT;\n                end\n                else begin\n                    next_state = LEFT;\n                end\n            end\n            RIGHT:begin\n                if((bump == 2'b01) || (bump == 2'b11))begin\n                    next_state = LEFT;\n                end\n                else begin\n                    next_state = RIGHT;\n                end\n            end\n        endcase\n    end\n\n    always @(posedge clk, posedge areset) begin\n        if(areset)begin\n            state <= LEFT;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n\n    // Output logic\n    assign walk_left = (state == LEFT);\n    assign walk_right = (state == RIGHT);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°11ï¼š**\n\nGame Lemmings2ï¼šæœ‰ä¸ªå°äººå·¦å³èµ°ï¼Œå®ƒåªæœ‰ä¸¤ç§çŠ¶æ€ï¼šå‘å·¦èµ°å’Œå‘å³èµ°ï¼›å·¦è¾¹ç¢°åˆ°ä¸œè¥¿ä¹‹åå®ƒå°±å‘å³èµ°ï¼Œå³è¾¹ç¢°åˆ°ä¸œè¥¿ä¹‹åå®ƒå°±å‘å·¦èµ°ï¼Œä¸¤è¾¹éƒ½ç¢°åˆ°ä¸œè¥¿å°±è·Ÿå½“å‰æ–¹å‘çš„åæ–¹å‘èµ°ï¼›å¤ä½æ—¶å°äººå‘å·¦èµ°ï¼›\n\næ·»åŠ groundä¿¡å·ï¼Œground=1æ—¶è§„åˆ™ä¸ä¸Šè¿°è§„åˆ™ç›¸åŒï¼›ground=0æ—¶ï¼Œè®°å½•å½“å‰èµ°çš„æ–¹å‘ï¼Œå¹¶å°†aaahä¿¡å·ç½®1ï¼Œç›´åˆ°ground=1æ—¶ï¼Œèµ°ä¸æ‰è½ä¹‹å‰ç›¸åŒçš„æ–¹å‘ã€‚\n\n**Solution11ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input areset,    // Freshly brainwashed Lemmings walk left.\n    input bump_left,\n    input bump_right,\n    input ground,\n    output walk_left,\n    output walk_right,\n    output aaah ); \n    \n    parameter LEFT = 2'b0;\n    parameter RIGHT = 2'b1;\n    parameter AH_LEFT = 2'b10;\n    parameter AH_RIGHT = 2'b11;\n    reg [1:0] state,next_state;\n    wire [1:0] bump;\n    assign bump = {bump_left,bump_right};\n    \n    always @(*)begin\n        case(state)\n        \tLEFT:begin\n                if(ground == 1'b0)begin\n                \tnext_state = AH_LEFT;\n                end\n                else if((bump == 2'b10) || (bump == 2'b11))begin\n                    next_state = RIGHT;\n                end\n                else begin\n                    next_state = LEFT;\n                end\n            end\n            RIGHT:begin\n                if(ground == 1'b0)begin\n                    next_state = AH_RIGHT;\n                end\n                else if((bump == 2'b01) || (bump == 2'b11))begin\n                    next_state = LEFT;\n                end\n                else begin\n                \tnext_state = RIGHT;\n                end\n            end\n            AH_LEFT:begin\n                if(ground == 1'b0)begin\n                \tnext_state = AH_LEFT;\n                end\n                else begin\n                \tnext_state = LEFT;\n                end\n            end\n            AH_RIGHT:begin\n                if(ground == 1'b0)begin\n                \tnext_state = AH_RIGHT;\n                end\n                else begin\n                \tnext_state = RIGHT;\n                end\n            end\n        endcase\n    end\n    \n    always@(posedge clk,posedge areset)begin\n        if(areset)begin\n            state <= LEFT;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n    \n    assign walk_left = (state == LEFT);\n    assign walk_right = (state == RIGHT);\n    assign aaah = ((state == AH_LEFT) | (state == AH_RIGHT));\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°12ï¼š**\n\nGame Lemmings3ï¼šæœ‰ä¸ªå°äººå·¦å³èµ°ï¼Œå®ƒåªæœ‰ä¸¤ç§çŠ¶æ€ï¼šå‘å·¦èµ°å’Œå‘å³èµ°ï¼›å·¦è¾¹ç¢°åˆ°ä¸œè¥¿ä¹‹åå®ƒå°±å‘å³èµ°ï¼Œå³è¾¹ç¢°åˆ°ä¸œè¥¿ä¹‹åå®ƒå°±å‘å·¦èµ°ï¼Œä¸¤è¾¹éƒ½ç¢°åˆ°ä¸œè¥¿å°±è·Ÿå½“å‰æ–¹å‘çš„åæ–¹å‘èµ°ï¼›å¤ä½æ—¶å°äººå‘å·¦èµ°ï¼›\n\næ·»åŠ groundä¿¡å·ï¼Œground=1æ—¶è§„åˆ™ä¸ä¸Šè¿°è§„åˆ™ç›¸åŒï¼›ground=0æ—¶ï¼Œè®°å½•å½“å‰èµ°çš„æ–¹å‘ï¼Œå¹¶å°†aaahä¿¡å·ç½®1ï¼Œç›´åˆ°ground=1æ—¶ï¼Œèµ°ä¸æ‰è½ä¹‹å‰ç›¸åŒçš„æ–¹å‘ã€‚\n\næ·»åŠ digä¿¡å·ï¼Œground=1æ—¶ä¸€ç›´æŒ–ï¼Œground=0æ—¶ï¼Œè¿›å…¥aaahçŠ¶æ€ï¼Œç›´åˆ°groundå†æ¬¡ä¸º1ï¼Œæ–¹å‘ä¸digå¼€å§‹çš„æ–¹å‘ç›¸åŒã€‚\n\nä¼˜å…ˆçº§ï¼šfall>dig>switch direction\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232201905.png)\n\n**Solution12ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input areset,    // Freshly brainwashed Lemmings walk left.\n    input bump_left,\n    input bump_right,\n    input ground,\n    input dig,\n    output walk_left,\n    output walk_right,\n    output aaah,\n    output digging ); \n\n    parameter LEFT = 3'b0;\n    parameter RIGHT = 3'b1;\n    parameter DIG_LEFT = 3'b10;\n    parameter DIG_RIGHT = 3'b11;\n    parameter FALL_LEFT = 3'b100;\n    parameter FALL_RIGHT = 3'b101;\n    \n    reg [2:0] state,next_state;\n    wire [1:0] bump;\n    assign bump = {bump_left,bump_right};\n    \n    always @(*)begin\n        case(state)\n            LEFT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_LEFT;\n                end\n                else if(dig == 1'b1)begin\n                    next_state = DIG_LEFT;\n                end\n                else if((bump == 2'b10) || (bump == 2'b11))begin\n                    next_state = RIGHT;\n                end\n                else begin\n                \tnext_state = LEFT;\n                end\n            end\n            RIGHT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_RIGHT;\n                end\n                else if(dig == 1'b1)begin\n                    next_state = DIG_RIGHT;\n                end\n                else if((bump == 2'b01) || (bump == 2'b11))begin\n                    next_state = LEFT;\n                end\n                else begin\n                \tnext_state = RIGHT;\n                end\n            end\n            DIG_LEFT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_LEFT;\n                end\n                else begin\n                    next_state = DIG_LEFT;\n                end\n            end\n            DIG_RIGHT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_RIGHT;\n                end\n                else begin\n                    next_state = DIG_RIGHT;\n                end\n            end\n            FALL_LEFT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_LEFT;\n                end\n                else begin\n                    next_state = LEFT;\n                end\n            end\n            FALL_RIGHT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_RIGHT;\n                end\n                else begin\n                    next_state = RIGHT;\n                end\n            end\n        endcase\n    end\n    \n    always @(posedge clk,posedge areset)begin\n        if(areset)begin\n            state <= LEFT;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n    \n    assign walk_left = (state == LEFT);\n    assign walk_right = (state == RIGHT);\n    assign digging = ((state == DIG_LEFT) | (state == DIG_RIGHT));\n    assign aaah = ((state == FALL_LEFT) | (state == FALL_RIGHT));\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°13ï¼š**\n\nGame Lemmings4ï¼šå°äººè¡ŒåŠ¨è§„åˆ™ä¸ä¸Šè¿°è§„åˆ™ç›¸åŒï¼Œæ·»åŠ å°äººä¼šdieçš„è§„åˆ™ï¼š\n\nå¦‚æœå°äººfallè¶…è¿‡20cyclesï¼Œåˆ™å½“å…¶æ¥è§¦åœ°é¢æ—¶ç›´æ¥dieï¼ˆæœªæ¥è§¦åœ°é¢æ—¶ä¸ä¼šdieï¼‰ã€‚digï¼Œfallï¼Œleftå’Œrightè¾“å‡ºå…¨éƒ¨ç½®é›¶ï¼Œç›´åˆ°resetä¿¡å·æ¥ä¸´ã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232201725.png)\n\næ‰‹ç»˜çŠ¶æ€è½¬ç§»å›¾ï¼š(DeadçŠ¶æ€å°‘ä¸ªè‡ªå·±åˆ°è‡ªå·±çš„çŠ¶æ€)\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232201610.png)\n\n**Solution13ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input areset,    // Freshly brainwashed Lemmings walk left.\n    input bump_left,\n    input bump_right,\n    input ground,\n    input dig,\n    output walk_left,\n    output walk_right,\n    output aaah,\n    output digging ); \n    \n    parameter LEFT = 3'b0;\n    parameter RIGHT = 3'b1;\n    parameter DIG_LEFT = 3'b10;\n    parameter DIG_RIGHT = 3'b11;\n    parameter FALL_LEFT = 3'b100;\n    parameter FALL_RIGHT = 3'b101;\n    parameter DEAD = 3'b110;\n    parameter SPLATTER = 3'b111;\n    \n    reg [2:0] state,next_state;\n    reg [4:0] Cycle_Count;\n    \n    wire [1:0] bump;\n    assign bump = {bump_left,bump_right};\n    \n    always @(*)begin\n        case(state)\n            LEFT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_LEFT;\n                end\n                else if(dig == 1'b1)begin\n                    next_state = DIG_LEFT;\n                end\n                else if((bump == 2'b10) || (bump == 2'b11))begin\n                    next_state = RIGHT;\n                end\n                else begin\n                    next_state = LEFT;\n                end\n            end\n            \n            RIGHT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_RIGHT;\n                end\n                else if(dig == 1'b1)begin\n                    next_state = DIG_RIGHT;\n                end\n                else if((bump == 2'b01) || (bump == 2'b11))begin\n                    next_state = LEFT;\n                end\n                else begin\n                    next_state = RIGHT;\n                end\n            end\n            \n            DIG_LEFT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_LEFT;\n                end\n                else begin\n                    next_state = DIG_LEFT;\n                end\n            end\n            \n            DIG_RIGHT:begin\n                if(ground == 1'b0)begin\n                    next_state = FALL_RIGHT;\n                end\n                else begin\n                    next_state = DIG_RIGHT;\n                end\n            end\n            \n            FALL_LEFT:begin\n                if((ground == 1'b0) && (Cycle_Count < 5'd20))begin\n                    next_state = FALL_LEFT;\n                end\n                else if((ground == 1'b0) && (Cycle_Count >= 5'd20))begin\n                    next_state = SPLATTER;\n                end\n                else begin\n                    next_state = LEFT;\n                end\n            end\n            \n            FALL_RIGHT:begin\n                if((ground == 1'b0) && (Cycle_Count < 5'd20))begin\n                    next_state = FALL_RIGHT;\n                end\n                else if((ground == 1'b0) && (Cycle_Count >= 5'd20))begin\n                    next_state = SPLATTER;\n                end\n                else begin\n                    next_state = RIGHT;\n                end\n            end\n            \n            SPLATTER:begin\n                if(ground == 1'b1)begin\n                    next_state = DEAD;\n                end\n                else begin\n                    next_state = SPLATTER;\n                end\n            end\n            \n            DEAD:begin\n                next_state = DEAD;\n            end\n            \n        endcase\n    end\n    \n    always @(posedge clk,posedge areset)begin\n        if(areset)begin\n            state <= LEFT;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n    \n    always @(posedge clk,posedge areset)begin\n        if(areset)begin\n            Cycle_Count <= 5'd0;\n        end\n        else if((next_state == FALL_LEFT) || (next_state == FALL_RIGHT)) begin\n            Cycle_Count <= Cycle_Count + 1'b1;\n        end\n        else begin\n            Cycle_Count <= 5'd0;\n        end\n    end\n    \n    assign walk_left = (state == LEFT);\n    assign walk_right = (state == RIGHT);\n    assign aaah = ((state == FALL_LEFT) || (state == FALL_RIGHT) || (state == SPLATTER));\n    assign digging = ((state == DIG_LEFT) || (state == DIG_RIGHT));\n\nendmodule\n```\n\n------\n\n## ç»“è¯­\n\nä»Šå¤©æ›´æ–°çš„å‡ é“æ—…é¼ é¢˜éå¸¸æœ‰æ„æ€ï¼Œå¤§å®¶å¯ä»¥å…ˆè‡ªå·±å°è¯•ã€‚ä»£ç è‹¥æœ‰é—®é¢˜çš„è¯å¯ä»¥ä¸æˆ‘äº¤æµã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(15)_Verilogæœ‰é™çŠ¶æ€æœº(2)","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(15)_Verilogæœ‰é™çŠ¶æ€æœº(2)/","content":"\n\n\n# Verilogæœ‰é™çŠ¶æ€æœº(2)\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nç»§ç»­æ›´æ–°çŠ¶æ€æœºå°èŠ‚çš„ä¹ é¢˜ã€‚\n\n------\n\n## é¢˜åº“\n\n**é¢˜ç›®æè¿°6ï¼š**\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232200542.png)\n\n**Solution6ï¼š**\n\n```verilog\nmodule top_module(\n    input in,\n    input [3:0] state,\n    output [3:0] next_state,\n    output out); //\n\n    parameter A=0, B=1, C=2, D=3;\n\n    // State transition logic: Derive an equation for each state flip-flop.\n    assign next_state[A] = (state[A]&~in) | (state[C] & ~in);\n    assign next_state[B] = (state[A]&in) | (state[D]&in) | (state[B]&in);\n    assign next_state[C] = (state[B]&~in) | (state[D]&~in);\n    assign next_state[D] = (state[C]&in);\n\n    // Output logic: \n    assign out = (state[D]);\n\nendmodule\n```\n\næœ¬é¢˜ä¸­ä½œè€…æƒ³è®©æˆ‘ä»¬ä»¥one-hot(ç‹¬çƒ­ç )çš„ç¼–ç é€»è¾‘æ¥å®Œæˆã€‚ä¸€èˆ¬çŠ¶æ€æœºä¸ºäº†æ–¹ä¾¿ç¼–ç éƒ½æ˜¯è®¾ç½®ä¸ºäºŒè¿›åˆ¶ï¼›ä½†è‹¥çŠ¶æ€è½¬ç§»æ˜¯**æŒ‰é¡ºåºè¿›è¡Œè½¬ç§»**çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨**æ ¼é›·ç **ï¼Œå› ä¸ºä¸¤ç›¸é‚»çŠ¶æ€ä¹‹é—´åªå˜åŒ–1bitï¼Œè¿™æ ·å¯ä»¥èŠ‚çº¦åŠŸè€—ï¼›è‹¥æƒ³**æå‡é€Ÿåº¦**ï¼Œå¯ä»¥ä½¿ç”¨**one-hotç¼–ç **ï¼Œå› ä¸ºæ¯æ¬¡ä»…éœ€åˆ¤æ–­ä¸€ä½ï¼Œè¿™æ˜¯ç”¨**å¯„å­˜å™¨èµ„æºæ¢ç»„åˆé€»è¾‘èµ„æº**ï¼Œä»¥è¾¾åˆ°**æ›´é«˜çš„é€Ÿåº¦**ã€‚\n\n**é¢˜ç›®æè¿°7ï¼š**\n\né¢˜ç›®ä¸ä¸Šé¢˜ç›¸åŒï¼ŒåŒºåˆ«ä¸ºå¼‚æ­¥å¤ä½ï¼Œå¤ä½è‡³çŠ¶æ€Aã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232200918.png)\n\n**Solution7ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input in,\n    input areset,\n    output out); //\n\n    parameter A=2'd0,B=2'd1,C=2'd2,D=2'd3;\n    reg [1:0] state,next_state;\n    \n    always @(*)begin\n        case(state)\n            A:begin\n                if(in == 0)begin\n                    next_state = A;\n                end\n                else begin\n                    next_state = B;\n                end\n            end\n            B:begin\n            \tif(in == 0)begin\n                    next_state = C;\n                end\n                else begin\n                    next_state = B;\n                end\n            end\n            C:begin\n            \tif(in == 0)begin\n                    next_state = A;\n                end\n                else begin\n                    next_state = D;\n                end\n            end\n            D:begin\n                if(in == 0)begin\n                    next_state = C;\n                end\n                else begin\n                    next_state = B;\n                end\n            end\n        endcase\n    end\n\n    always @(posedge clk,posedge areset)begin\n        if(areset)begin\n            state <= A;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n\n    assign out = (state == D);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°8ï¼š**\n\né¢˜ç›®åŒä¸Šé¢˜ï¼Œå°†å¤ä½æ”¹ä¸ºåŒæ­¥å¤ä½ã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232200315.png)\n\n**Solution8ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input in,\n    input reset,\n    output out); //\n\nparameter A=2'd0,B=2'd1,C=2'd2,D=2'd3;\n    reg [1:0] state,next_state;\n    \n    always @(*)begin\n        case(state)\n            A:begin\n                if(in == 0)begin\n                    next_state = A;\n                end\n                else begin\n                    next_state = B;\n                end\n            end\n            B:begin\n            \tif(in == 0)begin\n                    next_state = C;\n                end\n                else begin\n                    next_state = B;\n                end\n            end\n            C:begin\n            \tif(in == 0)begin\n                    next_state = A;\n                end\n                else begin\n                    next_state = D;\n                end\n            end\n            D:begin\n                if(in == 0)begin\n                    next_state = C;\n                end\n                else begin\n                    next_state = B;\n                end\n            end\n        endcase\n    end\n\n    always @(posedge clk)begin\n        if(reset)begin\n            state <= A;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n\n    assign out = (state == D);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°9ï¼š**\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232201397.png)\n\n**Solution9ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,\n    input [3:1] s,\n    output fr3,\n    output fr2,\n    output fr1,\n    output dfr\n); \n    \n    parameter A2=3'd0,B1=3'd1,B2=3'd2,C1=3'd3,C2=3'd4,D1=3'd5;\n    reg [2:0] state,next_state;\n    \n    always @(*)begin\n        case(state)\n            A2:next_state = s[1]?B1:A2;\n            B1:next_state = s[2]?C1:(s[1]?B1:A2);\n            B2:next_state = s[2]?C1:(s[1]?B2:A2);\n            C1:next_state = s[3]?D1:(s[2]?C1:B2);\n            C2:next_state = s[3]?D1:(s[2]?C2:B2);\n            D1:next_state = s[3]?D1:C2;\n            default:next_state = 'x;\n        endcase\n    end\n    \n    always @(posedge clk)begin\n        if(reset)begin\n        \tstate <= A2;\n        end\n        else begin\n        \tstate <= next_state;\n        end\n    end\n    \n    always @(*)begin\n        case(state)\n            A2:{fr3,fr2,fr1,dfr} = 4'b1111;\n            B1:{fr3,fr2,fr1,dfr} = 4'b0110;\n            B2:{fr3,fr2,fr1,dfr} = 4'b0111;\n            C1:{fr3,fr2,fr1,dfr} = 4'b0010;\n            C2:{fr3,fr2,fr1,dfr} = 4'b0011;\n            D1:{fr3,fr2,fr1,dfr} = 4'b0000;\n            default:{fr3,fr2,fr1,dfr} = 'x;\n        endcase\n    end\n\nendmodule\n```\n\n------\n\n## å°ç»“\n\nä»Šå¤©å…ˆæ›´æ–°è¿™å‡ é“é¢˜ç›®ï¼Œé‡ç‚¹æ˜¯one-hotç¼–ç éƒ¨åˆ†ï¼Œäº†è§£å…¶ä¸æ ¼é›·ç çš„ä¼˜ç¼ºç‚¹ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(14)_Verilogæœ‰é™çŠ¶æ€æœº(1)","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(14)_Verilogæœ‰é™çŠ¶æ€æœº(1)/","content":"\n\n\n# Verilogæœ‰é™çŠ¶æ€æœº(1)\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©æ¥åˆ°äº†é‡è¦çš„éƒ¨åˆ†ï¼šçŠ¶æ€æœºã€‚å¯¹è¯¥éƒ¨åˆ†å†…å®¹ï¼Œå¯èƒ½ä¸ä¼šä¸€æ¬¡æ›´æ–°ä¸€ä¸ªå°èŠ‚ï¼›ä¸€æ–¹é¢æ˜¯é¢˜ç›®éš¾åº¦ï¼Œå¦ä¸€æ–¹é¢æ˜¯ä»£ç é‡è¿‡å¤§ï¼›æ‰€ä»¥è¯¥èŠ‚ä¼šåˆ†æ‰¹æ›´æ–°ï¼Œå¤§å®¶è§è°…ã€‚\n\n------\n\n## é¢˜åº“\n\n**é¢˜ç›®æè¿°1ï¼š**\n\nå®ç°ä¸‹å›¾æ‰€ç¤ºçš„æ‘©å°”çŠ¶æ€æœºï¼Œå¤ä½ä¸ºå¼‚æ­¥å¤ä½ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232159453.png)\n\n**Solution1ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input areset,    // Asynchronous reset to state B\n    input in,\n    output out);//  \n\n    parameter A=0, B=1; \n    reg state, next_state;\n\n    always @(*) begin    // This is a combinational always block\n        case(state)\n            A:begin\n                if(in == 1'b1)begin\n                    next_state = A;\n                end\n                else begin\n                    next_state = B;\n                end\n            end\n            B:begin\n                if(in == 1'b1)begin\n                    next_state = B;\n                end\n                else begin\n                    next_state = A;\n                end\n            end\n        endcase\n    end\n\n    always @(posedge clk, posedge areset) begin    // This is a sequential always block\n        if(areset)begin\n            state <= B;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n\n    // Output logic\n    assign out = (state == B);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°2ï¼š**\n\nå®ç°ä¸‹å›¾æ‰€ç¤ºçš„æ‘©å°”çŠ¶æ€æœºï¼Œå¤ä½ä¸ºåŒæ­¥å¤ä½ã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232159568.png)\n\n**Solution2ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input reset,    // Asynchronous reset to state B\n    input in,\n    output out);//  \n\n    parameter A=0, B=1; \n    reg state, next_state;\n\n    always @(*) begin    // This is a combinational always block\n        case(state)\n            A:begin\n                if(in == 1'b1)begin\n                    next_state = A;\n                end\n                else begin\n                    next_state = B;\n                end\n            end\n            B:begin\n                if(in == 1'b1)begin\n                    next_state = B;\n                end\n                else begin\n                    next_state = A;\n                end\n            end\n        endcase\n    end\n\n    always @(posedge clk) begin    // This is a sequential always block\n        if(reset)begin\n            state <= B;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n\n    // Output logic\n    assign out = (state == B);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°3ï¼š**\n\n2ä¸ªè¾“å…¥1ä¸ªè¾“å‡ºï¼Œå¼‚æ­¥å¤ä½çŠ¶æ€æœºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232200570.png)\n\n**Solution3ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input areset,    // Asynchronous reset to OFF\n    input j,\n    input k,\n    output out); //  \n\n    parameter OFF=0, ON=1; \n    reg state, next_state;\n\n    always @(*) begin\n        case(state)\n            OFF:begin\n                if(j == 0)begin\n                    next_state = OFF;\n                end\n                else begin\n                    next_state = ON;\n                end\n            end\n            ON:begin\n                if(k == 0)begin\n                    next_state = ON;\n                end\n                else begin\n                    next_state = OFF;\n                end\n            end\n        endcase\n    end\n\n    always @(posedge clk, posedge areset) begin\n        if(areset)begin\n            state <= OFF;\n        end\n        else begin\n        \tstate <= next_state;\n        end\n    end\n\n    // Output logic\n    assign out = (state == ON);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°4ï¼š**\n\n2ä¸ªè¾“å…¥1ä¸ªè¾“å‡ºï¼ŒåŒæ­¥å¤ä½çŠ¶æ€æœºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232200594.png)\n\n**Solution4ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input reset,    // Synchronous reset to OFF\n    input j,\n    input k,\n    output out); //  \n\n    parameter OFF=0, ON=1; \n    reg state, next_state;\n\n    always @(*) begin\n        case(state)\n            OFF:begin\n                if(j == 0)begin\n                    next_state = OFF;\n                end\n                else begin\n                \tnext_state = ON;\n                end\n            end\n            ON:begin\n                if(k == 0)begin\n                    next_state = ON;\n                end\n                else begin\n                \tnext_state = OFF;\n                end\n            end\n        endcase\n    end\n\n    always @(posedge clk) begin\n        if(reset)begin\n            state <= OFF;\n        end\n        else begin\n            state <= next_state;\n        end\n    end\n\n    // Output logic\n    assign out = (state == ON);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°5ï¼š**\n\nå®ç°ä¸‹é¢çš„æ‘©å°”çŠ¶æ€æœºï¼Œä¸‹è¡¨æ˜¯çŠ¶æ€è½¬ç§»å›¾ï¼Œ1è¾“å…¥1è¾“å‡º4çŠ¶æ€ã€‚\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232200717.png)\n\n**Solution5ï¼š**\n\n```verilog\nmodule top_module(\n    input in,\n    input [1:0] state,\n    output [1:0] next_state,\n    output out); //\n\n    parameter A=0, B=1, C=2, D=3;\n\n    always @(*)begin\n        case(state)\n            A:begin\n                if(in == 0)begin\n                \tnext_state = A;\n                end\n                else begin\n                \tnext_state = B;\n                end\n            end\n            B:begin\n                if(in == 0)begin\n                \tnext_state = C;\n                end\n                else begin\n                \tnext_state = B;\n                end\n            end\n            C:begin\n                if(in == 0)begin\n                \tnext_state = A;\n                end\n                else begin\n                \tnext_state = D;\n                end\n            end\n            D:begin\n                if(in == 0)begin\n                \tnext_state = C;\n                end\n                else begin\n                \tnext_state = B;\n                end\n            end\n        endcase\n    end\n\n    assign out = (state == D);\n\nendmodule\n```\n\n------\n\n## å°ç»“\n\nä»Šå¤©å…ˆæ›´æ–°è¿™äº”é“é¢˜ï¼Œä¸»è¦æ˜¯ç†Ÿæ‚‰ä¸‰æ®µå¼çŠ¶æ€æœºçš„ç¼–å†™ã€‚\n\nè‹¥æ˜¯ä»£ç æœ‰è¯¯è¯·å¤§å®¶æé†’æˆ‘ï¼Œæˆ‘ä¸€å®šå°½å¿«æ”¹æ­£ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(13)_Verilogç§»ä½å¯„å­˜å™¨","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(13)_Verilogç§»ä½å¯„å­˜å™¨é™„åŠ é¢˜/","content":"\n\n\n# Verilogç§»ä½å¯„å­˜å™¨\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©æ›´æ–°ä¸€èŠ‚å†…å®¹ï¼Œè¯¥å°èŠ‚é¢˜ç›®ä¸å¤šï¼Œå…±ä¸‰é“ï¼Œä½†æŠ€å·§æ€§æŒºå¼ºã€‚\n\n------\n\n## é¢˜åº“\n\n**é¢˜ç›®æè¿°1ï¼š**å„å•å…ƒçš„ä¸‹ä¸€çŠ¶æ€æ˜¯æ­¤æ—¶å½“å‰å•å…ƒç›¸é‚»ä¸¤ä½çš„å¼‚æˆ–ã€‚\n\nåœ¨è¿™ä¸ªç”µè·¯ä¸­ï¼Œåˆ›å»ºä¸€ä¸ª512å•å…ƒç³»ç»Ÿ(q(511:0))ï¼Œå¹¶åœ¨æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸä¸­å‰è¿›ä¸€ä¸ªæ—¶é—´æ­¥é•¿ã€‚åŠ è½½(load)è¡¨æ˜ç³»ç»Ÿçš„çŠ¶æ€åº”è¯¥åŠ è½½data[511:0]è‡³qä¸­,å‡è®¾è¾¹ç•Œ(q[0]å’Œq[512])éƒ½ä¸ºé›¶ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232159622.png)\n\n**Solution1ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input load,\n    input [511:0] data,\n    output [511:0] q ); \n\n    always @(posedge clk)begin\n        if(load)begin\n            q <= data;\n        end\n        else begin\n            q <= {1'b0,q[511:1]}^{q[510:0],1'b0};\n        end\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°2ï¼š**\n\nä¸é¢˜ç›®ä¸€ç±»ä¼¼ï¼ŒçŠ¶æ€è½¬ç§»æ¡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232159099.png)\n\n**Solution2ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input load,\n    input [511:0] data,\n    output [511:0] q\n); \n\n    always @(posedge clk)begin\n        if(load)begin\n        \tq <= data;\n        end\n        else begin \n            q <= (~{1'b0,q[511:1]} & q) | (q & ~{q[510:0],1'b0}) | {~{1'b0,q[511:1]} & {q[510:0],1'b0}} | {~q & {q[510:0],1'b0}};\n        end\n    end\n    \nendmodule\n```\n\ntipsï¼šè¿›è¡Œå¡è¯ºå›¾åŒ–ç®€åå¯çœ‹æ‡‚qçŠ¶æ€è½¬ç§»çš„å«ä¹‰ã€‚\n\n**é¢˜ç›®æè¿°3ï¼š**\n\nä¸€ä¸ªä¸­å¿ƒç‚¹å‘¨å›´æœ‰8ä¸ªé‚»å±…ï¼Œå¦‚æœå‘¨å›´çš„é‚»å±…ä¸­1çš„æ•°ç›®ä¸º0-1ä¸ªï¼Œé‚£ä¹ˆä¸­å¿ƒç‚¹å˜ä¸º0ï¼›å¦‚æœå‘¨å›´é‚»å±…ä¸­1çš„æ•°ç›®ä¸º2ä¸ªï¼Œé‚£ä¹ˆä¸­å¿ƒç‚¹çŠ¶æ€ä¸å˜ï¼›å¦‚æœå‘¨å›´é‚»å±…ä¸­1çš„æ•°ç›®ä¸º3ä¸ªï¼Œä¸­å¿ƒç‚¹å˜ä¸º1ï¼›å¦‚æœå‘¨å›´é‚»å±…ä¸­1çš„æ•°ç›®å¤§äº3ä¸ªï¼Œä¸­å¿ƒç‚¹å˜ä¸º0ã€‚\n\næˆ‘ä»¬å¯ä»¥å°†å‘¨å›´çš„8ä¸ªé‚»å±…çš„å€¼éƒ½åŠ èµ·æ¥æ¥åˆ¤æ–­å‘¨å›´é‚»å±…ä¸­1çš„ä¸ªæ•°ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨**forä¸­ä½¿ç”¨äº†é˜»å¡èµ‹å€¼**ï¼Œå› éœ€è¦**å½“å‰æ‹ï¼ˆæœ¬å‘¨æœŸï¼‰å¾—åˆ°ç»“æœåœ¨å½“å‰æ‹ï¼ˆæœ¬å‘¨æœŸï¼‰å°±å»åˆ¤æ–­**ã€‚\n\nå»ºè®®å¤§å®¶åšè¯¥é¢˜çš„æ—¶å€™èŠ±ä¸€ä¸ª16*16çš„æ–¹é˜µï¼Œåˆ†æè¾¹ç•Œæ¡ä»¶ï¼Œè¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚\n\n*ç”Ÿå‘½æ¸¸æˆä¹‹çˆ¶çº¦ç¿°Â·åº·å¨å› æ„ŸæŸ“æ–°å† äº2020å¹´4æœˆ11æ—¥å»ä¸–ï¼Œäº«å¹´83å²ï¼Œåœ¨æ­¤è¡¨ç¤ºå“€æ‚¼ã€‚*\n\n**Solution3ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input load,\n    input [255:0] data,\n    output [255:0] q );\n    \n    reg [3:0] count[255:0];\n    integer i;\n    \n    always @(*) begin\n        for(i=0;i<256;i++)begin\n            if(i == 0)begin\n                count[i] = q[255] + q[240] + q[241] + q[15] + q[1] + q[31] + q[16] + q[17];\n            end\n            else if(i == 15)begin\n                count[i] = q[254] + q[255] + q[240] + q[14] + q[0] + q[30] + q[31] + q[16];\n            end\n            else if(i == 240)begin\n                count[i] = q[239] + q[224] + q[225] + q[255] + q[241] + q[15] + q[0] + q[1];\n            end\n            else if(i == 255)begin\n                count[i] = q[238] + q[239] + q[224] + q[254] + q[240] + q[15] + q[0] + q[14];\n            end\n            else if( i>0 && i<15)begin\n                count[i] = q[239+i]+q[240+i]+q[241+i]+q[i-1]+q[i+1]+q[i+15]+q[i+16]+q[i+17];\n            end\n            else if(i>240 && i<255)begin\n                count[i] = q[i-17]+q[i-16]+q[i-15]+q[i-1]+q[i+1]+q[i-239]+q[i-240]+q[i-241];\n            end\n            else if( i%16 == 0)begin\n                count[i] = q[i-1]+q[i-16]+q[i-15]+q[i+15]+q[i+1]+q[i+31]+q[i+16]+q[i+17];\n            end\n            else if(i % 16 == 15)begin\n                count[i] = q[i-17]+q[i-16]+q[i-31]+q[i-1]+q[i-15]+q[i+15]+q[i+16]+q[i+1];\n            end\n            else begin\n                count[i] = q[i-17]+q[i-16]+q[i-15]+q[i-1]+q[i+1]+q[i+15]+q[i+16]+q[i+17];\n            end\n        end\n    end\n    \n    always @(posedge clk)begin\n        if(load)begin\n        \tq <= data;\n        end\n        else begin\n            for(i=0;i<256;i++)begin\n                case(count[i])\n                    4'd2:q[i] <= q[i];\n                    4'd3:q[i] <= 1'b1;\n                    default:q[i] <= 1'b0;\n                endcase\n            end\n        end\n    end\n\nendmodule\n```\n\n------\n\n## å°ç»“\n\nå¸Œæœ›è‡ªå·±ä»¥åé‡åˆ°é—®é¢˜èƒ½å¤Ÿæ…¢æ…¢åˆ’åˆ†è§£å†³ï¼Œå¾å›¾ç¼“è¿›ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(12)_Verilogç§»ä½å¯„å­˜å™¨","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(12)_Verilogç§»ä½å¯„å­˜å™¨/","content":"\n# Verilogç§»ä½å¯„å­˜å™¨\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©æ›´æ–°ä¸€èŠ‚å¯„å­˜å™¨ç›¸å…³å†…å®¹ï¼Œå…¶ä¸­æ¶‰åŠCRCæ ¡éªŒçš„å†…å®¹æ˜¯ç”¨çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨æ­å»ºè€Œæˆçš„ã€‚\n\n------\n\n## é¢˜åº“\n\n**é¢˜ç›®æè¿°1ï¼š**\n\næ„å»ºä¸€ä¸ª4bitçš„ç§»ä½å¯„å­˜å™¨(å³ç§»)ï¼Œå«å¼‚æ­¥å¤ä½ã€åŒæ­¥åŠ è½½å’Œä½¿èƒ½\n\n- aresetï¼šè®©å¯„å­˜å™¨å¤ä½ä¸º0\n- loadï¼šåŠ è½½4bitæ•°æ®åˆ°ç§»ä½å¯„å­˜å™¨ä¸­ï¼Œä¸ç§»ä½\n- enaï¼šä½¿èƒ½å³ç§»\n- qï¼šç§»ä½å¯„å­˜å™¨ä¸­çš„å†…å®¹\n\n**Solution1ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input areset,  // async active-high reset to zero\n    input load,\n    input ena,\n    input [3:0] data,\n    output reg [3:0] q); \n    \n    always @(posedge clk or posedge areset)begin\n        if(areset)begin\n            q <= 4'b0;\n        end\n        else if(load) begin\n            q <= data;\n        end\n        else if(ena)begin\n            q <= {1'b0,q[3:1]};\n        end\n        else begin\n            q <= q;\n        end\n    end\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°2ï¼š**\n\næ„å»ºä¸€ä¸ª100ä½çš„å·¦å³æ—‹è½¬å™¨ï¼ŒåŒæ­¥loadï¼Œå·¦å³æ—‹è½¬éœ€ä½¿èƒ½ã€‚æ—‹è½¬å™¨ä»å¦ä¸€ç«¯è¾“å…¥ç§»ä½çš„ä½å…ƒï¼Œä¸åƒç§»ä½å™¨é‚£æ ·ä¸¢å¼ƒç§»ä½çš„ä½å…ƒè€Œä»¥é›¶ä½ç§»ä½ã€‚å¦‚æœå¯ç”¨ï¼Œæ—‹è½¬å™¨å°±ä¼šæ—‹è½¬è¿™äº›ä½ï¼Œè€Œä¸ä¼šä¿®æ”¹æˆ–ä¸¢å¼ƒå®ƒä»¬ã€‚\n\n- loadï¼šåŠ è½½100ä½çš„ç§»ä½å¯„å­˜å™¨æ•°æ®\n- ena[1:0]ï¼š2'b01 å³è½¬1bitï¼› 2'b10 å·¦è½¬1bitï¼›å…¶ä»–æƒ…å†µä¸è½¬\n- qï¼šæ—‹è½¬å™¨å†…å®¹\n\n**Solution2ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input load,\n    input [1:0] ena,\n    input [99:0] data,\n    output reg [99:0] q);\n    \n    always @(posedge clk) begin\n        if(load) begin\n            q <= data;\n        end\n        else begin\n            case (ena)\n                2'b01:q <= {q[0],q[99:1]};\n                2'b10:q <= {q[98:0],q[99]};\n                default:q <= q;\n            endcase\n        end\n    end\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°3ï¼š**\n\nå»ºç«‹ä¸€ä¸ª64ä½ç®—æœ¯ç§»ä½å¯„å­˜å™¨ï¼ŒåŒæ­¥åŠ è½½ã€‚ç§»ä½å™¨å¯ä»¥å·¦å³ç§»ä½ï¼Œå¹¶æŒ‰æ•°é‡é€‰æ‹©1ä½æˆ–8ä½çš„ç§»ä½ã€‚\n\n- loadï¼šåŠ è½½æ•°æ®\n- enaï¼šå†³å®šæ˜¯å¦ç§»ä½\n- amountï¼šå†³å®šç§»ä½æ–¹å‘ä¸æ•°é‡ï¼š2'b00ï¼šå·¦ç§»1ä½ï¼›2'b01ï¼šå·¦ç§»8ä½ï¼›2'b10ï¼šå³ç§»1ä½ï¼›2'b11ï¼šå³ç§»8ä½\n- qï¼šå¯„å­˜å™¨å†…å®¹ï¼ˆè¾“å‡ºï¼‰\n\n**Solution3ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input load,\n    input ena,\n    input [1:0] amount,\n    input [63:0] data,\n    output reg [63:0] q); \n    \n    always @(posedge clk)begin\n        if(load)begin\n            q <= data;\n        end\n        else begin\n            if(ena)begin\n                case(amount)\n                    2'b00: q <= {q[62:0],1'b0};\n                    2'b01: q <= {q[55:0],8'b0};\n                    2'b10: q <= {q[63],q[63:1]};\n                    2'b11: q <= {{8{q[63]}},q[63:8]};\n                endcase\n            end\n            else begin\n                q <= q;\n            end\n        end\n    end\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°4ï¼š**\n\næ„é€ çº¿æ€§ç§»ä½å¯„å­˜å™¨ï¼Œresetåº”å½“ä½¿LFSRå½’1ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232158306.png)\n\n**Solution4ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input reset,    // Active-high synchronous reset to 5'h1\n    output [4:0] q\n); \n    \n    always @(posedge clk)begin\n        if(reset)begin\n            q <= 5'h1;\n        end\n        else begin\n            q[4] <= 1'b0 ^ q[0];\n            q[3] <= q[4];\n            q[2] <= q[3] ^ q[0];\n            q[1] <= q[2];\n            q[0] <= q[1];\n        end\n    end\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°5ï¼š**\n\nä¸ºè¿™ä¸ªåºåˆ—ç”µè·¯ç¼–å†™Verilogä»£ç ã€‚å‡è®¾ä½ è¦åœ¨DE1-SoCæ¿ä¸Šå®ç°è¿™ä¸ªç”µè·¯ã€‚å°†Rè¾“å…¥è¿æ¥åˆ°SWå¼€å…³ï¼Œå°†æ—¶é’Ÿè¿æ¥åˆ°å¯†é’¥[0]ï¼Œå°†Lè¿æ¥åˆ°å¯†é’¥[1]ï¼Œå°†Qè¾“å‡ºè¿æ¥åˆ°çº¢ç¯LEDRä¸Šã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232158220.png)\n\n**Solution5ï¼š**\n\n```verilog\nmodule top_module (\n\tinput [2:0] SW,      // R\n\tinput [1:0] KEY,     // L and clk\n\toutput [2:0] LEDR);  // Q\n\n    wire clk;\n    assign clk = KEY[0];\n    \n    always @(posedge clk)begin\n        if(KEY[1])begin\n            LEDR[0] <= SW[0];\n            LEDR[1] <= SW[1];\n            LEDR[2] <= SW[2];\n        end\n        else begin\n            LEDR[0] <= LEDR[2];\n            LEDR[1] <= LEDR[0];\n            LEDR[2] <= LEDR[2] ^ LEDR[1];\n        end\n    end\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°5ï¼š**\n\næ„å»ºä¸€ä¸ª32ä½çš„Galois LFSRï¼Œå…¶tapsä½ç½®ä¸º32ã€22ã€2å’Œ1ã€‚\n\n**Solution5ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input reset,    // Active-high synchronous reset to 32'h1\n    output [31:0] q\n); \n    integer i;\n    always @(posedge clk)begin\n        if(reset)begin\n            q <= 32'h1;\n        end\n        else begin\n            for(i=0;i<32;i++)begin\n                if((i==21)||(i==1)||(i==0))begin\n                    q[i] <= q[i+1] ^ q[0];\n                end\n                else if(i==31)begin\n                    q[31] <= 1'b0 ^ q[0];\n                end\n                else begin\n                    q[i] <= q[i+1];\n                end  \n            end\n        end\n    end\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°6ï¼š**å®ç°å¦‚ä¸‹ç”µè·¯å›¾\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232158765.png)\n\n**Solution6ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input resetn,   // synchronous reset\n    input in,\n    output out);\n\n    reg [3:0] tmp;\n    assign out = tmp[3];\n    \n    always @(posedge clk)begin\n        if(!resetn)begin\n            tmp <= 4'h0;\n        end\n        else begin\n            tmp <= {tmp[2:0],in};\n        end\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°7ï¼š**å®ç°å¦‚ä¸‹ç”µè·¯å›¾\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232159971.png)\n\n- Connect the *R* inputs to the *SW* switches,\n- *clk* to *KEY[0]*,\n- *E* to *KEY[1]*,\n- *L* to *KEY[2]*, and\n- *w* to *KEY[3]*.\n- Connect the outputs to the red lights *LEDR[3:0]*.\n\n**Solution7ï¼š**\n\n```verilog\nmodule top_module (\n    input [3:0] SW,\n    input [3:0] KEY,\n    output [3:0] LEDR\n); \n    \n    MUXDFF u1(.clk(KEY[0]),\n               .w(KEY[3]),\n               .R(SW[3]),\n               .E(KEY[1]),\n               .L(KEY[2]),\n               .Q(LEDR[3]));\n    \n    MUXDFF u2(.clk(KEY[0]),\n               .w(LEDR[3]),\n               .R(SW[2]),\n               .E(KEY[1]),\n               .L(KEY[2]),\n               .Q(LEDR[2]));\n    \n    MUXDFF u3(.clk(KEY[0]),\n               .w(LEDR[2]),\n               .R(SW[1]),\n               .E(KEY[1]),\n               .L(KEY[2]),\n               .Q(LEDR[1]));\n    \n    MUXDFF u4(.clk(KEY[0]),\n               .w(LEDR[1]),\n               .R(SW[0]),\n               .E(KEY[1]),\n               .L(KEY[2]),\n               .Q(LEDR[0]));\n    \nendmodule\n\nmodule MUXDFF (\n    input clk,\n    input w,R,E,L,\n    output Q\n);\n    wire tmp;\n    assign tmp = E ? w : Q;\n    always @(posedge clk)begin\n        Q <= L? R : tmp;\n    end\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°8ï¼š**\n\nåœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œä½ å°†ä¸ºä¸€ä¸ª8x1å­˜å‚¨å™¨è®¾è®¡ä¸€ä¸ªç”µè·¯ï¼Œåœ¨è¿™ä¸ªç”µè·¯ä¸­ï¼Œå†™å…¥åˆ°å­˜å‚¨å™¨æ˜¯é€šè¿‡ç§»ä½æ¥å®Œæˆçš„ï¼Œè€Œè¯»å–æ˜¯â€œéšæœºè®¿é—®â€ï¼Œå°±åƒåœ¨ä¸€ä¸ªå…¸å‹çš„RAMä¸­ä¸€æ ·ã€‚ç„¶åæ‚¨å°†ä½¿ç”¨è¯¥ç”µè·¯å®ç°ä¸€ä¸ª3è¾“å…¥é€»è¾‘åŠŸèƒ½ã€‚\n\né¦–å…ˆï¼Œç”¨8ä¸ªdç±»å‹è§¦å‘å™¨åˆ›å»ºä¸€ä¸ª8ä½ç§»ä½å¯„å­˜å™¨ã€‚æ ‡è®°ä¸ºQ[0]åˆ°Q[7]ã€‚ç§»ä½å¯„å­˜å™¨è¾“å…¥ç§°ä¸ºSï¼Œè¾“å…¥Q[0] (MSBå…ˆç§»ä½)ã€‚ä½¿èƒ½è¾“å…¥enableæ§åˆ¶æ˜¯å¦ç§»ä½ï¼Œæ‰©å±•ç”µè·¯ä½¿å…¶æœ‰3ä¸ªé¢å¤–çš„è¾“å…¥A,B,Cå’Œä¸€ä¸ªè¾“å‡ºZã€‚ç”µè·¯çš„è¡Œä¸ºåº”è¯¥å¦‚ä¸‹:å½“ABCä¸º000æ—¶ï¼ŒZ=Q[0]ï¼Œå½“ABCä¸º001æ—¶ï¼ŒZ=Q[1]ï¼Œä»¥æ­¤ç±»æ¨ã€‚ä½ çš„ç”µè·¯åº”è¯¥åªåŒ…å«8ä½ç§»ä½å¯„å­˜å™¨å’Œå¤šè·¯å¤ç”¨å™¨ã€‚(è¿™ä¸ªç”µè·¯ç§°ä¸º3è¾“å…¥æŸ¥æ‰¾è¡¨(LUT))ã€‚\n\n**Solution8ï¼š**\n\n```Verilog\nmodule top_module (\n    input clk,\n    input enable,\n    input S,\n    input A, B, C,\n    output Z ); \n    \n    reg [7:0] Q;\n    always @(posedge clk)begin\n        if(enable)begin\n            Q <= {Q[6:0],S};\n        end\n        else begin\n            Q <= Q;\n        end\n    end\n    \n    assign Z = Q[{A,B,C}];\n\nendmodule\n```\n\n------\n\n## å°ç»“\n\nä»Šå¤©æ›´æ–°äº†éƒ¨åˆ†ç§»ä½å¯„å­˜å™¨éƒ¨åˆ†çš„ç­”æ¡ˆï¼Œæ³¨æ„æœ€åä¸€é¢˜ç”¨äº†ä¸€äº›æŠ€å·§æ¥ç®€åŒ–ä»£ç ä¹¦å†™ï¼Œä½†å®ç°æ—¶ç”µè·¯å¹¶æ— å·®å¼‚ï¼Œä½“ç°äº†HDLä¸­Describeçš„ç‰¹æ€§ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(11)_Verilogè®¡æ•°å™¨","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(11)_Verilogè®¡æ•°å™¨/","content":"\n# Verilogè®¡æ•°å™¨\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‰è¨€\n\nä»Šå¤©æ›´æ–°ä¸€ä¸ªå°èŠ‚å†…å®¹ï¼šè®¡æ•°å™¨ã€‚è®¡æ•°å™¨å¯ä»¥è¯´æ˜¯æˆ‘ä»¬æ¥è§¦æ•°å­—ç”µè·¯ä»¥åç”¨çš„æœ€é¢‘ç¹çš„æ¨¡å—ä¹‹ä¸€äº†ï¼Œæ— è®ºæ˜¯é¡¹ç›®ã€åº”è˜è¿˜æ˜¯å°†æ¥çš„å·¥ä½œï¼Œè®¡æ•°å™¨éƒ½æ— å¤„ä¸åœ¨ã€‚\n\n------\n\n## é¢˜åº“\n\n**é¢˜ç›®æè¿°1ï¼š**\n\næ„å»ºä¸€ä¸ªä»0åˆ°15çš„4ä½äºŒè¿›åˆ¶è®¡æ•°å™¨ï¼Œå‘¨æœŸä¸º16ã€‚åŒæ­¥å¤ä½ï¼Œå¤ä½åº”è¯¥å°†è®¡æ•°å™¨é‡ç½®ä¸º0ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232156509.png)\n\n**Solution1ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,      // Synchronous active-high reset\n    output [3:0] q);\n\n    always @(posedge clk)begin\n        if(reset)begin\n            q<=4'b0;\n        end\n        else begin\n            q<=q+1'b1;\n        end\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°2ï¼š**\n\næ„å»ºä¸€ä¸ªä»0åˆ°9(åŒ…æ‹¬9)çš„åè¿›åˆ¶è®¡æ•°å™¨ï¼Œå…¶å‘¨æœŸä¸º10ã€‚åŒæ­¥å¤ä½ï¼Œå¤ä½åº”è¯¥å°†è®¡æ•°å™¨é‡ç½®ä¸º0ã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232156617.png)\n\n**Solution2ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,        // Synchronous active-high reset\n    output [3:0] q);\n\n    always @(posedge clk)begin\n        if(reset || q >= 4'd9)begin\n            q<=4'b0;\n        end\n        else begin\n            q<=q+1'b1;\n        end\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°3ï¼š**\n\nåˆ¶ä½œä¸€ä¸ªä»1åˆ°10çš„10è¿›åˆ¶è®¡æ•°å™¨ã€‚åŒæ­¥å¤ä½ï¼Œå¤ä½åº”è¯¥å°†è®¡æ•°å™¨å¤ä½ä¸º1ã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232156406.png)\n\n**Solution3ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,\n    output [3:0] q);\n\n    always @(posedge clk)begin\n        if(reset || q>=4'd10)begin\n            q<=4'b1;\n        end\n        else begin\n            q<=q+1'b1;\n        end\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°4ï¼š**\n\næ„å»ºä¸€ä¸ªä»0åˆ°9(åŒ…æ‹¬9)çš„åè¿›åˆ¶è®¡æ•°å™¨ï¼Œå…¶å‘¨æœŸä¸º10ã€‚åŒæ­¥å¤ä½ï¼Œå¤ä½åº”è¯¥å°†è®¡æ•°å™¨é‡ç½®ä¸º0ã€‚æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿæš‚åœè®¡æ•°å™¨ï¼Œè€Œä¸æ˜¯æ€»æ˜¯åœ¨æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸä¸­é€’å¢ï¼Œå› æ­¤`slowena`è¾“å…¥æŒ‡ç¤ºè®¡æ•°å™¨åº”è¯¥ä½•æ—¶é€’å¢ã€‚\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232156120.png)\n\n**Solution4:**\n\n```verilog\nmodule top_module (\n    input clk,\n    input slowena,\n    input reset,\n    output [3:0] q);\n\n    always @(posedge clk)begin\n        if(reset)begin\n            q<=4'b0;\n        end\n        else if(slowena)begin\n            if(q==4'd9)begin\n                q<=4'b0;\n            end\n            else begin\n                q<=q+1'b1;\n            end\n        end\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°4ï¼š**\n\nè®¾è®¡ä¸€ä¸ª1-12è®¡æ•°å™¨\n\n**Solution4ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,\n    input enable,\n    output [3:0] Q,\n    output c_enable,\n    output c_load,\n    output [3:0] c_d\n); \n    \n    assign c_enable = enable;\n    assign c_load = reset | ((Q == 4'd12) && (enable == 1'b1));\n    assign c_d = c_load ? 4'd1 : 4'd0;\n    \n    count4 the_counter (clk, c_enable, c_load, c_d , Q);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°5ï¼š**\n\nä¾‹åŒ–BCDæ¨¡å—å®ç°é™é¢‘æ“ä½œï¼Œ1kHz->1Hzã€‚\n\n**Solution5ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,\n    output OneHertz,\n    output [2:0] c_enable\n); //\n\twire[3:0]\tone, ten, hundred;\n    assign c_enable = {one == 4'd9 && ten == 4'd9, one == 4'd9, 1'b1};\n    assign OneHertz = (one == 4'd9 && ten == 4'd9 && hundred == 4'd9);\n    \n    bcdcount counter0 (clk, reset, c_enable[0], one);\n    bcdcount counter1 (clk, reset, c_enable[1], ten);\n    bcdcount counter2 (clk, reset, c_enable[2], hundred);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°6ï¼š**\n\næ„å»ºä¸€ä¸ª4ä½BCD(äºŒè¿›åˆ¶ç¼–ç çš„åè¿›åˆ¶)è®¡æ•°å™¨ã€‚æ¯ä¸ªåè¿›åˆ¶æ•°å­—ä½¿ç”¨4ä½è¿›è¡Œç¼–ç :q[3:0]æ˜¯ä¸ªä½ï¼Œq[7:4]æ˜¯åä½ï¼Œä»¥æ­¤ç±»æ¨ã€‚å„è¿›åˆ¶ä¸Šçš„è¿›ä½æ—¶ä¹Ÿéœ€è¾“å‡ºä¸€ä¸ªä½¿èƒ½ä¿¡å·ï¼ŒæŒ‡ç¤ºä¸‰ä½æ•°å­—ä½•æ—¶åº”è¯¥å¢åŠ ã€‚\n\n**Solution6ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,   // Synchronous active-high reset\n    output [3:1] ena,\n    output [15:0] q);\n    \n    reg [3:0] ones;\n    reg [3:0] tens;\n    reg [3:0] hundreds;\n    reg [3:0] thousands;\n    \n    always @(posedge clk) begin\n        if(reset)begin\n            ones <= 4'b0;\n        end\n        else if(ones == 4'd9)begin\n            ones <=4'b0;\n        end\n        else begin\n            ones <= ones + 4'd1;\n        end\n    end\n    \n    always @(posedge clk)begin\n        if(reset)begin\n            tens <= 4'b0;\n        end\n        else if(tens == 4'd9 && ones == 4'd9)begin\n            tens <= 4'b0;\n        end\n        else if(ones == 4'd9)begin\n            tens <= tens + 4'd1;\n        end\n    end\n    \n    always @(posedge clk)begin\n        if(reset)begin\n            hundreds <= 4'b0;\n        end\n        else if(hundreds == 4'd9 && tens == 4'd9 && ones == 4'd9)begin\n            hundreds <= 4'b0;\n        end\n        else if(tens == 4'd9 && ones == 4'd9) begin\n            hundreds <= hundreds + 4'd1;\n        end\n    end\n    \n    always @(posedge clk)begin\n        if(reset)begin\n            thousands <= 4'b0;\n        end\n        else if(thousands == 4'd9 && hundreds == 4'd9 && tens == 4'd9 && ones == 4'd9)begin\n            thousands <= 4'b0;\n        end\n        else if(hundreds == 4'd9 && tens == 4'd9 && ones == 4'd9)begin\n            thousands <= thousands + 4'd1;\n        end\n    end\n    \n    assign q = {thousands,hundreds,tens,ones};\n    assign ena[1] = (ones == 4'd9) ? 1'b1 : 1'b0;\n    assign ena[2] = ((ones == 4'd9) && (tens == 4'd9)) ? 1'b1 : 1'b0;\n    assign ena[3] = ((ones == 4'd9) && (tens == 4'd9) && (hundreds == 4'd9)) ? 1'b1 : 1'b0;\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°7ï¼š**\n\nåˆ›å»ºä¸€ç»„é€‚åˆä½œä¸º12å°æ—¶çš„æ—¶é’Ÿä½¿ç”¨çš„è®¡æ•°å™¨(å¸¦æœ‰am/pmæŒ‡ç¤ºå™¨)ã€‚ä½ çš„è®¡æ•°å™¨æ˜¯ç”±ä¸€ä¸ªå¿«é€Ÿè¿è¡Œçš„clké©±åŠ¨ï¼Œæ¯æ¬¡æ—¶é’Ÿå¢åŠ æ—¶enaå¿…é¡»ä¸º1ã€‚resetå°†æ—¶é’Ÿé‡ç½®åˆ°ä¸­åˆ12ç‚¹ã€‚ä¸Šåˆæ—¶pm=0ï¼Œä¸‹åˆæ—¶pm=0ã€‚hhï¼Œmmå’Œssåˆ†åˆ«æ˜¯å°æ—¶(01-12)ã€åˆ†é’Ÿ(00-59)å’Œç§’(00-59)çš„ä¸¤ä¸ªBCD(äºŒè¿›åˆ¶ç¼–ç çš„åè¿›åˆ¶)æ•°å­—ã€‚\n\nResetæ¯”enableå…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œå¹¶ä¸”å³ä½¿åœ¨æ²¡æœ‰å¯ç”¨æ—¶ä¹Ÿä¼šå‘ç”Ÿã€‚\n\nä¸‹é¢çš„æ—¶åºå›¾æ˜¾ç¤ºäº†ä»11:59:59 AMåˆ°12:00:00 PMçš„ç¿»è½¬è¡Œä¸ºä»¥åŠåŒæ­¥çš„Resetå’Œenableè¡Œä¸ºã€‚\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232158544.png)\n\n**Solution7ï¼š**\n\n```verilog\nmodule top_module(\n    input clk,\n    input reset,\n    input ena,\n    output pm,\n    output [7:0] hh,\n    output [7:0] mm,\n    output [7:0] ss); \n    \n    reg pm_temp;\n    reg [3:0] ss_ones;\n    reg [3:0] ss_tens;\n    reg [3:0] mm_ones;\n    reg [3:0] mm_tens;\n    reg [3:0] hh_ones;\n    reg [3:0] hh_tens;\n    \n    wire\t\tadd_ss_ones;\n    wire\t\tend_ss_ones;\n    wire\t\tadd_ss_tens;\n    wire\t\tend_ss_tens;\n    wire\t\tadd_mm_ones;\n    wire\t\tend_mm_ones;\n    wire\t\tadd_mm_tens;\n    wire\t\tend_mm_tens;\n    wire\t\tadd_hh_ones;\n    wire\t\tend_hh_ones_0;\n    wire\t\tend_hh_ones_1;\n    wire\t\tadd_hh_tens;\n    wire\t\tend_hh_tens_0;\n    wire\t\tend_hh_tens_1;\n    wire\t\tpm_ding;\n    \n    assign add_ss_ones = ena;\n    assign end_ss_ones = add_ss_ones && (ss_ones == 4'd9);\n    always @(posedge clk)begin\n        if(reset)begin\n            ss_ones <= 4'b0;\n        end\n        else if(add_ss_ones)begin\n            if(end_ss_ones)begin\n                ss_ones <= 4'b0;\n            end\n            else begin\n                ss_ones <= ss_ones + 4'b1;\n            end\n        end\n    end\n    \n    assign add_ss_tens = end_ss_ones;\n    assign end_ss_tens = add_ss_tens && (ss_tens == 4'd5);\n    always @(posedge clk)begin\n        if(reset)begin\n            ss_tens <= 4'b0;\n        end\n        else if(add_ss_tens)begin\n            if(end_ss_tens)begin\n                ss_tens <= 4'b0;\n            end\n            else begin\n                ss_tens <= ss_tens + 4'b1;\n            end\n        end\n    end\n    \n    assign add_mm_ones = end_ss_tens;\n    assign end_mm_ones = add_mm_ones && (mm_ones == 4'd9);\n    always @(posedge clk)begin\n        if(reset)begin\n            mm_ones <= 4'b0;\n        end\n        else if(add_mm_ones)begin\n            if(end_mm_ones)begin\n                mm_ones <= 4'b0;\n            end\n            else begin\n                mm_ones <= mm_ones + 4'b1;\n            end\n        end\n    end\n    \n    assign add_mm_tens = end_mm_ones;\n    assign end_mm_tens = add_mm_tens && (mm_tens == 4'd5);\n\talways @(posedge clk)begin\n        if(reset)begin\n            mm_tens <= 4'b0;\n        end\n        else if(add_mm_tens)begin\n            if(end_mm_tens)begin\n                mm_tens <= 4'b0;\n            end\n            else begin\n                mm_tens <= mm_tens + 4'b1;\n            end\n        end\n    end\n    \n    assign add_hh_ones = end_mm_tens;\n    assign end_hh_ones_0 = add_hh_ones && (hh_ones == 4'd9);\n    assign end_hh_ones_1 = add_hh_ones && ((hh_ones == 4'd2) && (hh_tens == 4'd1));\n    always @(posedge clk)begin\n        if(reset)begin\n            hh_ones <= 4'd2;\n        end\n        else if(add_hh_ones)begin\n            if(end_hh_ones_0)begin\n                hh_ones <= 4'b0;\n            end\n            else if(end_hh_ones_1)begin\n                hh_ones <= 4'b1;\n            end\n            else begin\n                hh_ones <= hh_ones+4'b1;\n            end\n        end\n    end\n\n    assign add_hh_tens = end_mm_tens;\n    assign end_hh_tens_0 = add_hh_tens && end_hh_ones_1;\n    assign end_hh_tens_1 = add_hh_tens && end_hh_ones_0;\n    always @(posedge clk)begin\n        if(reset)begin\n            hh_tens <= 4'b1;\n        end\n        else if(add_hh_tens)begin\n            if(end_hh_tens_0)begin\n                hh_tens <= 4'b0;\n            end\n            else if(end_hh_tens_1)begin\n                hh_tens <= hh_tens + 4'b1;\n            end\n        end\n    end\n    \n    always@(posedge clk)begin\n        if(reset)begin\n            pm_temp <= 1'b0;\n        end\n        else if(pm_ding)begin\n            pm_temp <= ~pm_temp;\n        end\n    end\n    \n    assign pm_ding = hh_tens == 4'd1 && hh_ones == 4'd1 && end_mm_tens;\n    \n    assign ss = {ss_tens, ss_ones};\n    assign mm = {mm_tens, mm_ones};\n    assign hh = {hh_tens, hh_ones};\n    assign pm = pm_temp;\n    \nendmodule\n```\n\n------\n\n## æ€»ç»“\n\n- ç†Ÿæ‚‰äº†åŸºæœ¬è®¡æ•°å™¨çš„ä»£ç ç¼–å†™ã€‚\n- æ—¶é’Ÿçš„è¿›ä½æ¡ä»¶åº”å•ç‹¬ç”¨assignåˆ—å‡ºï¼Œè¿™æ ·å±‚æ¬¡æ„Ÿæ›´åŠ æ¸…æ™°ã€‚\n\n","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(10)_å¡è¯ºå›¾ä¸æœ€ç®€SOPå¼","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(10)_Dè§¦å‘å™¨ã€åŒæ­¥ä¸å¼‚æ­¥å¤ä½ã€è„‰å†²è¾¹æ²¿æ£€æµ‹/","content":"\n# Dè§¦å‘å™¨ã€åŒæ­¥ä¸å¼‚æ­¥å¤ä½ã€è„‰å†²è¾¹æ²¿æ£€æµ‹\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## Dè§¦å‘å™¨\n\n**å®šä¹‰ï¼š**\n\nDè§¦å‘å™¨æ˜¯ä¸€ä¸ªå…·æœ‰è®°å¿†åŠŸèƒ½çš„ï¼Œå…·æœ‰ä¸¤ä¸ªç¨³å®šçŠ¶æ€çš„ä¿¡æ¯å­˜å‚¨å™¨ä»¶ï¼Œè§¦å‘å™¨å…·æœ‰ä¸¤ä¸ªç¨³å®šçŠ¶æ€ï¼Œå³\"0\"å’Œ\"1\"ï¼Œåœ¨ä¸€å®šçš„å¤–ç•Œä¿¡å·ä½œç”¨ä¸‹ï¼Œå¯ä»¥ä»ä¸€ä¸ªç¨³å®šçŠ¶æ€ç¿»è½¬åˆ°å¦ä¸€ä¸ªç¨³å®šçŠ¶æ€ã€‚åœ¨è¿™é‡Œè§£é‡Šè¾¹æ²¿è§¦å‘çš„Dè§¦å‘å™¨ï¼ŒDè§¦å‘å™¨åœ¨æ—¶é’Ÿè„‰å†²CPçš„å‰æ²¿ï¼ˆæ­£è·³å˜0â†’1ï¼‰å‘ç”Ÿç¿»è½¬ï¼Œè§¦å‘å™¨çš„æ¬¡æ€ï¼ˆä¸‹ä¸€ä¸ªçŠ¶æ€ï¼‰å–å†³äºCPçš„è„‰å†²ä¸Šå‡æ²¿åˆ°æ¥ä¹‹å‰Dç«¯çš„çŠ¶æ€ï¼Œå³æ¬¡æ€Q=Dã€‚å› æ­¤ï¼Œå®ƒå…·æœ‰ç½®0ã€ç½®1ä¸¤ç§åŠŸèƒ½ã€‚ç”±äºåœ¨CP=1æœŸé—´ç”µè·¯å…·æœ‰ç»´æŒé˜»å¡ä½œç”¨ï¼ˆå³è§¦å‘å™¨çš„è¾“å‡ºä¸å˜ï¼‰ï¼Œæ‰€ä»¥åœ¨CP=1æœŸé—´ï¼ŒDç«¯çš„æ•°æ®çŠ¶æ€å˜åŒ–ï¼Œä¸ä¼šå½±å“è§¦å‘å™¨çš„è¾“å‡ºçŠ¶æ€ï¼Œæ•…è¾¹æ²¿Dè§¦å‘å™¨å—å¹²æ‰°çš„å¯èƒ½æ€§å°±é™ä½äº†ã€‚\n\n**åŠŸèƒ½è¡¨ï¼š**\n\n|  D   |    CLK     |   Q    |   QN    |\n| :--: | :--------: | :----: | :-----: |\n|  0   | æ—¶é’Ÿä¸Šå‡æ²¿ |   0    |    1    |\n|  1   | æ—¶é’Ÿä¸Šå‡æ²¿ |   1    |    0    |\n|  Ã—   |     0      | last Q | last QN |\n|  Ã—   |     1      | last Q | last QN |\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232154055.png)\n\n------\n\n## åŒæ­¥å¤ä½ä¸å¼‚æ­¥å¤ä½\n\n**åŒæ­¥å¤ä½ï¼š**\n\né¡¾åæ€ä¹‰ï¼ŒåŒæ­¥å¤ä½å°±æ˜¯æŒ‡å¤ä½ä¿¡å·åªæœ‰åœ¨æ—¶é’Ÿä¸Šå‡æ²¿åˆ°æ¥æ—¶ï¼Œæ‰èƒ½æœ‰æ•ˆã€‚å¦åˆ™ï¼Œæ— æ³•å®Œæˆå¯¹ç³»ç»Ÿçš„å¤ä½å·¥ä½œã€‚ç”¨Verilogæè¿°å¦‚ä¸‹ï¼š\n\n```verilog\nalways @ (posedge clk) begin\n\tif (!Rst_n)\n\t\t...\nend\n```\n\n**å¼‚æ­¥å¤ä½ï¼š**\n\næŒ‡æ— è®ºæ—¶é’Ÿæ²¿æ˜¯å¦åˆ°æ¥ï¼Œåªè¦å¤ä½ä¿¡å·æœ‰æ•ˆï¼Œå°±å¯¹ç³»ç»Ÿè¿›è¡Œå¤ä½ã€‚ç”¨Verilogæè¿°å¦‚ä¸‹ï¼š\n\n```verilog\nalways @ (posedge clk or negedge Rst_n) begin\n\tif (!Rst_n)\n\t\t...\nend\n```\n\n------\n\n## Dè§¦å‘å™¨å·©å›ºç»ƒä¹ \n\n**é¢˜ç›®æè¿°1**ï¼š\n\nåˆ›å»ºä¸€ä¸ªDè§¦å‘å™¨ã€‚\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,    \n    input d,\n    output reg q );\n\n    always @(posedge clk) begin\n        q <= d;\n    end\n\nendmodule\n```\n\ntipsï¼šæ—¶åºçš„alwayså—ä½¿ç”¨éé˜»å¡èµ‹å€¼ã€‚\n\n**é¢˜ç›®æè¿°2**ï¼š\n\nåˆ›å»º8ä¸ªDè§¦å‘å™¨ï¼Œæ¯ä¸ªéƒ½ç”±æ—¶é’Ÿçš„ä¸Šå‡æ²¿è§¦å‘ã€‚\n\n**Solution2**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input [7:0] d,\n    output [7:0] q\n);\n\n    always @(posedge clk) begin\n        q <= d;\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°3**ï¼š\n\nåˆ›å»º8ä¸ªdè§¦å‘å™¨ä¸ä¸»åŠ¨é«˜åŒæ­¥å¤ä½ã€‚æ‰€æœ‰Dè§¦å‘å™¨ç”±clkçš„ä¸Šå‡æ²¿è§¦å‘ã€‚\n\n**Solution3**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,            // Synchronous reset\n    input [7:0] d,\n    output [7:0] q\n);\n\n    always @(posedge clk) begin\n        if(reset)\n            q <=8'd0;\n        else\n            q <= d;\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°4**ï¼š\n\nåˆ›å»º8ä¸ªDè§¦å‘å™¨ä¸ä¸»åŠ¨é«˜åŒæ­¥å¤ä½ã€‚è§¦å‘å™¨å¿…é¡»è¢«é‡ç½®ä¸º0x34ï¼Œè€Œä¸æ˜¯0ã€‚æ‰€æœ‰Dè§¦å‘å™¨åº”ç”±clkçš„ä¸‹é™æ²¿è§¦å‘ã€‚\n\n**Solution4ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,\n    input [7:0] d,\n    output [7:0] q\n);\n\n    always @(negedge clk) begin\n        if(reset)\n            q <= 8'h0x34;\n        else\n            q <= d;\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°5**ï¼š\n\nåˆ›å»º8ä¸ªDè§¦å‘å™¨ä¸ä¸»åŠ¨é«˜å¼‚æ­¥å¤ä½ã€‚æ‰€æœ‰Dè§¦å‘å™¨åº”ç”±clkçš„ä¸Šå‡æ²¿è§¦å‘ã€‚\n\n**Solution5**:\n\n```verilog\nmodule top_module (\n    input clk,\n    input areset,   // active high asynchronous reset\n    input [7:0] d,\n    output [7:0] q\n);\n\n    always @(posedge clk or posedge areset) begin\n        if(areset) begin\n            q <= 8'd0;\n        end\n        else begin\n            q <= d;\n        end\n    end\n    \nendmodule\n```\n\ntipsï¼šä½¿ç”¨`posedge areset`æ—¶ï¼Œåªèƒ½ä½¿ç”¨`if(areset)`é¦–å…ˆè¿›è¡Œåˆ¤æ–­è€Œä¸èƒ½ç”¨`if(!areset)`ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n\n**é¢˜ç›®æè¿°6**ï¼š\n\nåˆ›å»ºä¸€ä¸ª16Dè§¦å‘å™¨ï¼Œæœ‰æ—¶æˆ‘ä»¬ä»…éœ€è¦ä¿®æ”¹éƒ¨åˆ†è§¦å‘å™¨ä¸­çš„å€¼ã€‚å­—èŠ‚ä½¿èƒ½ä¿¡å·æ§åˆ¶å½“å‰æ—¶é’Ÿå‘¨æœŸä¸­16ä¸ªå¯„å­˜å™¨ä¸­å“ªä¸ªå­—èŠ‚éœ€è¢«ä¿®æ”¹ã€‚`byteena[1]`æ§åˆ¶é«˜å­—èŠ‚`d[15:8]`ï¼Œè€Œ`byteena[0]`æ§åˆ¶ä½å­—èŠ‚d[7:0]ã€‚\n\n`resetn`æ˜¯ä¸€ä¸ªåŒæ­¥ï¼Œä½å¤ä½ä¿¡å·ã€‚\n\næ‰€æœ‰çš„Dè§¦å‘å™¨ç”±æ—¶é’Ÿçš„ä¸Šå‡æ²¿è§¦å‘ã€‚\n\n**Solution6**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input resetn,\n    input [1:0] byteena,\n    input [15:0] d,\n    output [15:0] q\n);\n\n    always @(posedge clk) begin\n        if(!resetn) begin\n            q <= 16'd0;\n        end\n        else begin\n            if(byteena[1])\n                q[15:8] <= d[15:8];\n            if(byteena[0])\n                q[7:0] <= d[7:0];\n        end\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°7ï¼š**\n\nå®ç°ä¸‹é¢çš„ç”µè·¯(é”å­˜å™¨)\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232154514.png)\n\n**Solution7**ï¼š\n\n```verilog\nmodule top_module (\n    input d, \n    input ena,\n    output q);\n    \n    always@(*)begin\n        if(ena)begin\n            q = d;\n        end\n    end\n \nendmodule\n```\n\n**é¢˜ç›®æè¿°8ï¼š**\n\nå®ç°ä¸‹é¢çš„ç”µè·¯\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232154371.png)\n\n**Solution8**ï¼š\n\n```verilog\nmodule top_module (\n    input clk,\n    input d, \n    input ar,   // asynchronous reset\n    output q);\n\n    always @(posedge clk or posedge ar) begin\n        if(ar) begin\n            q<=1'b0;\n        end\n        else begin\n            q<=d;\n        end\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°9ï¼š**\n\nå®ç°ä¸‹é¢çš„ç”µè·¯\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232154954.png)\n\n**Solution9ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input d, \n    input r,   // synchronous reset\n    output q);\n\n    always @(posedge clk) begin\n        if(r) begin\n            q<=1'b0;\n        end\n        else begin\n            q<=d;\n        end\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°10ï¼š**\n\nå®ç°ä¸‹é¢çš„ç”µè·¯\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232154405.png)\n\n**Solution10ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input in, \n    output out);\n\n    always @(posedge clk) begin\n        out <= (in ^ out);\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°11ï¼š**\n\nè€ƒè™‘ä¸‹å›¾çš„ç”µè·¯ï¼š\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232154377.png)\n\nå‡è®¾è¦ä¸ºè¿™ä¸ªç”µè·¯å®ç°åˆ†å±‚çš„Verilogä»£ç ï¼Œä½¿ç”¨ä¸€ä¸ªå­æ¨¡å—çš„ä¸‰ä¸ªå®ä¾‹ï¼Œè¯¥å­æ¨¡å—ä¸­æœ‰ä¸€ä¸ªè§¦å‘å™¨å’Œå¤šè·¯é€‰æ‹©å™¨ã€‚ä¸ºè¿™ä¸ªå­æ¨¡å—ç¼–å†™ä¸€ä¸ªåä¸ºtop_moduleçš„Verilogæ¨¡å—(åŒ…å«ä¸€ä¸ªè§¦å‘å™¨å’Œå¤šè·¯é€‰æ‹©å™¨)\n\n**Solution11**ï¼š\n\n```verilog\nmodule top_module (\n\tinput clk,\n\tinput L,\n\tinput r_in,\n\tinput q_in,\n\toutput reg Q);\n    \n    always @(posedge clk) begin\n        Q <= L ? r_in : q_in;\n    end\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°12ï¼š**\n\nè€ƒè™‘ä¸‹å›¾çš„n-bitç§»ä½å¯„å­˜å™¨\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232155901.png)\n\nä¸ºè¯¥ç”µè·¯çš„ä¸€ä¸ªé˜¶æ®µç¼–å†™ä¸€ä¸ªVerilogæ¨¡å—é¡¶å±‚æ¨¡å—ï¼ŒåŒ…æ‹¬è§¦å‘å™¨å’Œå¤šè·¯é€‰æ‹©å™¨ã€‚\n\n**Solution12ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input w, R, E, L,\n    output Q\n);\n\n    always @(posedge clk) begin\n        case({E,L})\n            2'b00:Q<=Q;\n            2'b01:Q<=R;\n            2'b10:Q<=w;\n            2'b11:Q<=R;\n        endcase\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°13ï¼š**\n\nç»™å®šå¦‚å›¾æ‰€ç¤ºçš„æœ‰é™çŠ¶æ€æœºç”µè·¯ï¼Œå‡è®¾Dè§¦å‘å™¨åœ¨æœºå™¨å¼€å§‹ä¹‹å‰è¢«åˆå§‹é‡ç½®ä¸ºé›¶\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232155110.png)\n\n**Solution13ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input x,\n    output z\n); \n\n    reg Q1,Q2,Q3;\n    always @(posedge clk) begin\n        Q1 <= (x ^ Q1);\n        Q2 <= (x & ~Q2);\n        Q3 <= (x | ~Q3);\n    end\n    \n    assign z = ~(Q1|Q2|Q3);\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°14ï¼š**\n\nJKè§¦å‘å™¨æœ‰ä¸‹é¢çš„çœŸå€¼è¡¨ã€‚åªä½¿ç”¨Dè§¦å‘å™¨å’Œé€»è¾‘é—¨å®ç°JKè§¦å‘å™¨ã€‚æ³¨:Qoldæ˜¯æ—¶é’Ÿä¸Šå‡æ²¿å‰çš„Dè§¦å‘å™¨çš„è¾“å‡ºã€‚\n\n|  J   |  K   |   Q   |\n| :--: | :--: | :---: |\n|  0   |  0   | Qold  |\n|  0   |  1   |   0   |\n|  1   |  0   |   1   |\n|  1   |  1   | ~Qold |\n\n**Solution14:**\n\n```verilog\nmodule top_module (\n    input clk,\n    input j,\n    input k,\n    output Q); \n\n    always @(posedge clk) begin\n        case({j,k})\n            2'b00:Q<=Q;\n            2'b01:Q<=1'b0;\n            2'b10:Q<=1'b1;\n            2'b11:Q<=~Q;\n        endcase\n    end\n    \nendmodule\n```\n\n------\n\n## è„‰å†²è¾¹æ²¿æ£€æµ‹\n\n**åŸç†ï¼š**\n\nè„‰å†²è¾¹æ²¿çš„ç‰¹æ€§ï¼š**ä¸¤ä¾§ç”µå¹³å‘ç”Ÿäº†å˜åŒ–**ã€‚\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232155355.png)\n\nè‹¥æ£€æµ‹çš„æ˜¯ä¸‹é™æ²¿ï¼Œé‚£å°±æ˜¯é«˜ç”µå¹³å˜ä½ç”µå¹³ã€‚\n\nè‹¥æ£€æµ‹çš„æ˜¯ä¸Šå‡æ²¿ï¼Œé‚£å°±æ˜¯ä½ç”µå¹³å˜é«˜ç”µå¹³ã€‚\n\nè‹¥æ£€æµ‹è„‰å†²è¾¹æ²¿ï¼Œåªéœ€å°†å‰åè¿›æ¥çš„ä¿¡å·åšå¼‚æˆ–è¿ç®—ï¼Œå³ä¸¤ä¸ªç”µå¹³ä¸ç›¸åŒåˆ™æ˜¯å‘ç”Ÿè¾¹æ²¿ã€‚\n\n**æ€è·¯ï¼š**\n\nè®¾è®¡å¯„å­˜å™¨ç”¨æ¥æ¥æ”¶è¢«æ£€æµ‹çš„ä¿¡å·ï¼›è‹¥`{å…ˆè¿›regï¼Œåè¿›reg}=2'b10`ï¼Œåˆ™æ˜¯ä¸‹é™æ²¿ï¼›\n\nè‹¥`{å…ˆè¿›regï¼Œåè¿›reg}=2'b01`ï¼Œåˆ™ä¸ºä¸Šå‡æ²¿ã€‚\n\næ³¨ï¼šä½¿ç”¨å¤šä¸ªå¯„å­˜å™¨å¯ä»¥æ›´å¥½çš„æ£€æµ‹è¾¹æ²¿ï¼Œé˜²æ­¢å¹²æ‰°è„‰å†²ã€‚å…·ä½“çœ‹ä¸‹ä¾‹ï¼š\n\n```verilog\nalways @ (posedge clk or negedge rst_n) begin\n    if(!rst_n) begin\n        rs232_rx0 <= 1'b0;\n        rs232_rx1 <= 1'b0;\n        rs232_rx2 <= 1'b0;\n        rs232_rx3 <= 1'b0;\n\tend\n    else begin\n        rs232_rx0 <= rs232_rx;\n        rs232_rx1 <= rs232_rx0;\n        rs232_rx2 <= rs232_rx1;\n        rs232_rx3 <= rs232_rx2;\n    end\nend\n//è¿™ç§æ–¹æ³•å¯ä»¥æ»¤é™¤æ¯›åˆº\nassign neg_rs232_rx = rs232_rx3 & rs232_rx2 & ~rs232_rx1 & ~rs232_rx0;\n```\n\næ˜“åˆ†æï¼Œä¿¡å·`rs232_rx0`ï¼Œ`rs232_rx1`ï¼Œå¿…é¡»éƒ½ä¸º0ï¼Œä¸”ä¿¡å·`rs232_rx3` ï¼Œ`rs232_rx2`éƒ½å¿…é¡»ä¸º1ï¼Œ`neg_rs232_rx` æ‰ä¼šä¸º1ã€‚æ­¤æ—¶åˆ¤æ–­ä¸ºä¸‹é™æ²¿ã€‚\n\n------\n\n## è¾¹æ²¿æ£€æµ‹å·©å›ºç»ƒä¹ \n\n**é¢˜ç›®æè¿°1ï¼š**\n\nå¯¹äº8ä½å‘é‡ä¸­çš„æ¯ä¸€ä½ï¼Œæ£€æµ‹è¾“å…¥ä¿¡å·ä½•æ—¶ä»ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„0å˜åŒ–åˆ°ä¸‹ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„1(æ­£è¾¹ç¼˜æ£€æµ‹)ã€‚è¾“å‡ºä½åº”è¯¥åœ¨å‘ç”Ÿ0åˆ°1è½¬æ¢åçš„å‘¨æœŸï¼Œå¦‚ä¸‹ç¤ºæ„å›¾æ‰€ç¤ºï¼š\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232155061.png)\n\n**Solution1ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input [7:0] in,\n    output [7:0] pedge\n);\n\n    reg [7:0] temp_in;\n    \n    always @(posedge clk) begin\n        temp_in <= in;\n        pedge <= ~temp_in & in;\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°2ï¼š**\n\nå¯¹äº8ä½å‘é‡ä¸­çš„æ¯ä¸€ä½ï¼Œæ£€æµ‹è¾“å…¥ä¿¡å·ä½•æ—¶ä»ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå˜åŒ–åˆ°ä¸‹ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸ(æ£€æµ‹è„‰å†²è¾¹æ²¿)ã€‚è¾“å‡ºä½åº”è¯¥åœ¨å‘ç”Ÿè½¬æ¢åçš„å‘¨æœŸã€‚\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232155289.png)\n\n**Solution2ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input [7:0] in,\n    output [7:0] anyedge\n);\n\n    reg [7:0] temp_in;\n    always @(posedge clk) begin\n        temp_in <= in;\n        anyedge <= temp_in ^ in;\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°3ï¼š**\n\nå¯¹äº32ä½å‘é‡ä¸­çš„æ¯ä¸€ä½ï¼Œå½“è¾“å…¥ä¿¡å·ä»ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„1å˜åŒ–åˆ°ä¸‹ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„0æ—¶æ•è·(æ•æ‰ä¸‹é™æ²¿)ï¼Œâ€œæ•è·â€æ„å‘³ç€è¾“å‡ºå°†ä¿æŒ1ç›´åˆ°è¢«reset(åŒæ­¥é‡ç½®)ã€‚\n\næ¯ä¸ªè¾“å‡ºä½çš„è¡Œä¸ºå°±åƒä¸€ä¸ªSRè§¦å‘å™¨:è¾“å‡ºä½åº”è¯¥åœ¨å‘ç”Ÿ1åˆ°0è½¬æ¢åçš„å‘¨æœŸè¢«è®¾ç½®(ä¸º1)ã€‚å½“å¤ä½ä¸ºé«˜æ—¶ï¼Œè¾“å‡ºä½åº”è¯¥åœ¨æ­£æ—¶é’Ÿè¾¹ç¼˜å¤ä½(ä¸º0)ã€‚å¦‚æœä¸Šè¿°ä¸¤ä¸ªäº‹ä»¶åŒæ—¶å‘ç”Ÿï¼Œåˆ™resetå…·æœ‰ä¼˜å…ˆçº§ã€‚\n\nåœ¨ä¸‹é¢ç¤ºä¾‹æ³¢å½¢çš„æœ€å4ä¸ªå‘¨æœŸä¸­ï¼Œâ€œresetâ€äº‹ä»¶æ¯”â€œsetâ€äº‹ä»¶æ—©ä¸€ä¸ªå‘¨æœŸå‘ç”Ÿï¼Œå› æ­¤è¿™é‡Œä¸å­˜åœ¨å†²çªã€‚\n\n![12](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232155112.png)\n\n**Solution3(1)ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,\n    input [31:0] in,\n    output [31:0] out\n);\n\n    reg [31:0] temp_in;\n    reg [31:0] state;\n    integer i;\n    \n    always @(posedge clk) begin\n        temp_in <= in;\n        for(i=0;i<32;i++) begin\n            case({temp_in[i] & ~in[i],reset})\n                2'b10:out[i]<=1'b1;\n                2'b11:out[i]<=1'b0;\n                2'b01:out[i]<=1'b0;\n                default:out[i]<=out[i];\n            endcase\n        end\n    end\n    \nendmodule\n```\n\n**Solution3(2)ï¼š**\n\n```verilog\nmodule top_module (\n    input clk,\n    input reset,\n    input [31:0] in,\n    output [31:0] out\n);\n\n    reg [31:0] temp_in;\n    \n    always @(posedge clk) begin\n        temp_in <= in;\n    end\n    \n    always @(posedge clk) begin\n        if(reset)begin\n            out<=32'b0;\n        end\n        else begin\n            out<=temp_in & ~in | out;\n        end\n    end\n     \nendmodule\n```\n\n**é¢˜ç›®æè¿°4ï¼š**\n\næ—¶é’ŸåŒæ²¿è§¦å‘å™¨\n\n~~`always @(posedge clk or negedge clk)`~~\n\n**Solution4(1):**\n\n```verilog\nmodule top_module (\n    input clk,\n    input d,\n    output q\n);\n\n    reg q1,q2;\n    \n    always @(posedge clk) begin\n        q1<=d;\n    end\n    \n    always @(negedge clk) begin\n        q2<=d;\n    end\n    \n    assign q = clk?q1:q2; \n        \nendmodule\n```\n\n**Solution4(2):**\n\n```verilog\nmodule top_module (\n    input clk,\n    input d,\n    output q\n);\n\n    reg q1,q2;\n    \n    always @(posedge clk) begin\n        q1<= d ^ q2;\n    end\n    \n    always @(negedge clk) begin\n        q2<= d ^ q1;\n    end\n    \n    assign q = q1 ^ q2; \n        \nendmodule\n```\n\næˆ‘ä»¬çŸ¥é“ä»»ä½•ä¸€ä¸ªæ•°å¼‚æˆ–ä¸€ä¸ªæ•°å†å¼‚æˆ–åŒä¸€ä¸ªæ•°ï¼Œå°†å¾—åˆ°æœ¬èº«ã€‚è¿™å°±æ˜¯æœ€ç®€å•çš„åŠ å¯†ä¸è§£å¯†åŸç†ã€‚\n\nSolution2ç›¸è¾ƒäºSolution1å°‘äº†ä½¿ç”¨clkä¿¡å·è¿›è¡Œé€‰æ‹©ï¼Œ**å¯ä»¥é¿å…äº§ç”Ÿæ¯›åˆº**ã€‚æ¨èä½¿ç”¨Solution2è¿›è¡ŒåŒè¾¹æ£€æµ‹ã€‚\n\n------\n\n## æ€»ç»“\n\n- å­¦ä¹ äº†Dè§¦å‘å™¨ä¸åŒæ­¥å¼‚æ­¥å¤ä½çš„æ¦‚å¿µ\n- å­¦ä¼šäº†å®é™…å·¥ç¨‹ä¸­å¸¸ç”¨çš„è¾¹æ²¿æ£€æµ‹ç”µè·¯","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(9)_å¡è¯ºå›¾ä¸æœ€ç®€SOPå¼","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(9)_å¡è¯ºå›¾ä¸æœ€ç®€SOPå¼/","content":"\n# å¡è¯ºå›¾ä¸æœ€ç®€SOPå¼\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## çœŸå€¼è¡¨\n\n### å®šä¹‰\n\nçœŸå€¼è¡¨æ˜¯è¡¨å¾é€»è¾‘äº‹ä»¶è¾“å…¥å’Œè¾“å‡ºä¹‹é—´å…¨éƒ¨å¯èƒ½çŠ¶æ€çš„è¡¨æ ¼ã€‚ä»¥1è¡¨ç¤ºçœŸï¼Œ0è¡¨ç¤ºå‡ã€‚\n\n### ä»çœŸå€¼è¡¨åˆ°æ ‡å‡†å¼\n\n- **SOPæ ‡å‡†å¼**ï¼šæ‰¾å‡ºçœŸå€¼è¡¨ä¸­æ‰€æœ‰è¾“å‡ºä¸º1çš„è¡¨é¡¹ï¼ŒæŒ‰ç…§è¾“å…¥çš„æƒ…å†µï¼Œä¸º1ç”¨å˜é‡è¡¨ç¤ºï¼Œä¸º0åˆ™ç”¨åå˜é‡è¡¨ç¤ºï¼Œå¾—å‡ºè‹¥å¹²ä¹˜ç§¯é¡¹ï¼Œç„¶åæ±‚å’Œã€‚\n- **POSæ ‡å‡†å¼**ï¼šæ‰¾å‡ºçœŸå€¼è¡¨ä¸­æ‰€æœ‰è¾“å‡ºä¸º0çš„è¡¨é¡¹ï¼ŒæŒ‰ç…§è¾“å…¥çš„æƒ…å†µï¼Œä¸º1ç”¨åå˜é‡è¡¨ç¤ºï¼Œä¸º0åˆ™ç”¨åŸå˜é‡è¡¨ç¤ºï¼Œå¾—å‡ºè‹¥å¹²æ±‚å’Œé¡¹ï¼Œç„¶åæ±‚ç§¯ã€‚\n\n**ä¸¾ä¾‹è¯´æ˜**\n\næœ‰å¦‚ä¸‹çœŸå€¼è¡¨\n\n|  A   |  B   |  C   |  D   |\n| :--: | :--: | :--: | :--: |\n|  0   |  0   |  0   |  0   |\n|  0   |  0   |  1   |  0   |\n|  0   |  1   |  0   |  0   |\n|  0   |  1   |  1   |  1   |\n|  1   |  0   |  0   |  1   |\n|  1   |  0   |  1   |  0   |\n|  1   |  1   |  0   |  1   |\n|  1   |  1   |  1   |  1   |\n\nè‹¥é’ˆå¯¹æ‰€æœ‰F=1çš„è¡¨é¡¹ï¼Œå¯è½»æ¾å†™å‡º**SOPæ ‡å‡†å¼**å¦‚ä¸‹ï¼š\n\nF=ABC+AB<u>C</u>+A<u>BC</u>+<u>A</u>BC\n\nè‹¥é’ˆå¯¹æ‰€æœ‰F=0çš„è¡¨é¡¹ï¼Œå¯è½»æ¾å†™å‡º**POSæ ‡å‡†å¼**å¦‚ä¸‹ï¼š\n\nF=(<u>A</u>+B+<u>C</u>)(A+<u>B</u>+C)(A+B+<u>C</u>)(A+B+C)\n\n### ä»æ ‡å‡†SOPå¼åˆ°æœ€ç®€SOPå¼\n\næ ‡å‡†è¡¨è¾¾å¼å¹¶éæœ€ç®€è¡¨è¾¾å¼ï¼Œä»æ ‡å‡†SOPå¼åˆ°æœ€ç®€SOPå¼ä¸ºä¸€ä¸ªæ ‡å‡†çš„é€»è¾‘åŒ–ç®€çš„è¿‡ç¨‹ã€‚\n\næ­¤æ—¶å¯ä»¥å¼•å…¥å¡è¯ºå›¾ï¼Œæ¥å¯»æ‰¾æœ€å°é¡¹çš„åˆå¹¶è§„å¾‹ï¼Œä»è€Œå¯ä»¥è½»æ˜“çš„è¿›è¡ŒåŒ–ç®€å·¥ä½œï¼Œæ­¤å¤„ä»…ä»‹ç»ç³»ç»ŸåŒ–ç®€æ³•ã€‚\n\n**1ã€æ±‚å‡ºå‡½æ•°çš„SOPæ ‡å‡†å¼**\n\nä¾‹å¦‚ï¼Œå¯¹äºå‡½æ•°ï¼š\n\nF=ABC+AB<u>C</u>+D+<u>A</u>BCD\n\nå¯å†™å‡ºå…¶æ ‡å‡†çš„SOPå¼ä¸º\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232152139.png)\n\n**2ã€æ±‚å‡ºå‡½æ•°çš„å…¨éƒ¨ä¸»è¦é¡¹**\n\né¦–å…ˆï¼Œå°†æœ€å°é¡¹æŒ‰å…¶å†…éƒ¨åŒ…å«1çš„ä¸ªæ•°å¤šå°‘è¿›è¡Œæ’åˆ—ã€åˆ†ç»„ï¼Œå¯å¾—ä¸‹è¡¨ï¼š\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232152239.png)\n\nå…¶æ¬¡ï¼Œæ ¹æ®è¯¥è¡¨ï¼Œå¯ä»¥å‘ç°èƒ½åˆå¹¶çš„ä¸¤ä¸ªæœ€å°é¡¹å¿…å®šä½äºç›¸é‚»çš„ä¸¤ç»„ï¼Œå› æ­¤ä»æœ€ä½ç»„å¼€å§‹ï¼Œå’Œç›¸é‚»é«˜ä½ç»„é€ä¸ªè¿ç®—åˆå¹¶ï¼Œå¹¶æŒ‰ä¹˜ç§¯é¡¹ä¸­1çš„ä¸ªæ•°è¿›è¡Œæ’åˆ—å¾—åˆ°çš„æ–°è¡¨å¦‚ä¸‹ï¼š(æ³¨ï¼š1ã€åœ¨åˆå¹¶çš„åŒæ—¶ï¼Œéœ€åœ¨ä¹‹å‰çš„è¡¨ä¸­ç”¨å‹¾æ ‡æ³¨å‡ºè¢«ä½¿ç”¨è¿‡çš„æœ€å°é¡¹ï¼›2ã€å¦‚æœåˆå¹¶ç»“æœä¸ä¹‹å‰æŸæ¬¡ä¸€æ ·ï¼Œåˆ™æ— éœ€åˆ—å‡ºã€‚)\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232152034.png)\n\nç¬¬ä¸‰ï¼Œå‚è€ƒå‰ä¸¤ä¸ªæ­¥éª¤ï¼Œç»§ç»­å¯¹è¡¨é¡¹åˆå¹¶ï¼Œç›´è‡³æ— æ³•åˆå¹¶ä¸ºæ­¢ã€‚ä¹‹åçš„åˆå¹¶è¿‡ç¨‹éœ€æ³¨æ„çš„æ˜¯â€œâ€”â€çš„ä½ç½®è¦ç›¸åŒï¼Œç»§ç»­åˆå¹¶çš„ç»“æœå¦‚ä¸‹ï¼š\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232152177.png)\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232152682.png)\n\nç¬¬å››ï¼Œä¸Šè¿°å„è¡¨ä¸­ï¼Œå‡¡æ˜¯æ²¡è¢«â€œâˆšâ€æ ‡è®°çš„åˆå¹¶é¡¹ï¼Œå°±æ˜¯ä¸»è¦é¡¹ã€‚å¯¹äºè¯¥ä¾‹ï¼Œä¸»è¦é¡¹å°±æ˜¯ï¼šP0=ABå’ŒP1=Dã€‚\n\n**3ã€æ±‚å‡ºå¿…è¦é¡¹ã€åˆ—å‡ºåŒ–ç®€ç»“æœ**\n\nå¦‚æœæŸä¸€ä¸ªä¸»è¦é¡¹ä¸­ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ªå…¶ä»–é¡¹ä¸åŒ…å«çš„æœ€å°é¡¹ï¼Œåˆ™å®ƒå¿…ç„¶æ˜¯å¿…è¦é¡¹ã€‚\n\nå¾—åˆ°ä¸»è¦é¡¹åå†è¿›è¡ŒéªŒè¯æ˜¯å¦å­˜åœ¨ç­‰ä»·ä¸»è¦é¡¹ï¼Œå¹¶å°†å…¶åˆ é™¤ã€‚\n\n------\n\n## å·©å›ºç»ƒä¹ \n\n**é¢˜ç›®æè¿°1**ï¼š\n\nå®ç°ä¸‹é¢å¡è¯ºå›¾æ‰€æè¿°çš„ç”µè·¯ã€‚\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232152506.png)\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module(\n    input a,\n    input b,\n    input c,\n    output out  ); \n    assign out = ~((~a)&(~b)&(~c));\nendmodule\n```\n\n**é¢˜ç›®æè¿°2**ï¼š\n\nå®ç°ä¸‹é¢å¡è¯ºå›¾æ‰€æè¿°çš„ç”µè·¯ã€‚\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232153201.png)\n\n**Solution2**ï¼š\n\n```verilog\nmodule top_module(\n    input a,\n    input b,\n    input c,\n    input d,\n    output out  ); \n\n    assign out = ~a & ~d | ~b & ~c | b & c & d | a & c & d;\n    \nendmodule\n\n```\n\n**é¢˜ç›®æè¿°3**ï¼š\n\nå®ç°ä¸‹é¢å¡è¯ºå›¾æ‰€æè¿°çš„ç”µè·¯ã€‚\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232153035.png)\n\ntipsï¼šdå¯ä»¥æ ¹æ®åŒ–ç®€éœ€æ±‚è‡ªå·±åˆ¶å®šä¸º0æˆ–æ˜¯1ã€‚\n\n**Solution3**ï¼š\n\n```verilog\nmodule top_module(\n    input a,\n    input b,\n    input c,\n    input d,\n    output out  ); \n\n    assign out =  a | (~a&~b&c);\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°4**ï¼š\n\nå®ç°ä¸‹é¢å¡è¯ºå›¾æ‰€æè¿°çš„ç”µè·¯ã€‚\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232153111.png)\n\n**Solution4**ï¼š\n\n```verilog\nmodule top_module(\n    input a,\n    input b,\n    input c,\n    input d,\n    output out  ); \n\n    assign out = a ^ b ^ c ^ d;\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°5**ï¼š\n\nå®ç°ä¸€ä¸ªæœ‰å››è¾“å…¥(a.b,c,d)çš„å•è¾“å‡ºæ•°å­—ç³»ç»Ÿï¼Œå½“2ã€7æˆ–15å‡ºç°åœ¨è¾“å…¥ç«¯æ—¶ï¼Œç”Ÿæˆé€»è¾‘1ï¼Œå½“0ã€1ã€4ã€5ã€6ã€9ã€10 13æˆ–14å‡ºç°æ—¶ï¼Œç”Ÿæˆé€»è¾‘0ã€‚æ•°å­—3ã€8ã€11å’Œ12çš„è¾“å…¥ä¸ä¼šå‡ºç°åœ¨è¿™ä¸ªç³»ç»Ÿä¸­ã€‚ä¾‹å¦‚ï¼Œ7å¯¹åº”äºaå’Œbã€‚c,dåˆ†åˆ«è¢«è®¾ä¸º0,1,1,1ã€‚\n\nç¡®å®šæœ€å°SOPæ ¼å¼çš„è¾“å‡ºout_sopå’Œæœ€å°POSæ ¼å¼çš„è¾“å‡ºout_posã€‚\n\n**Solution5**ï¼š\n\n```verilog\nmodule top_module (\n    input a,\n    input b,\n    input c,\n    input d,\n    output out_sop,\n    output out_pos\n); \n\n    assign out_sop = c & d | ~a & ~b & c;\n    assign out_pos = ~((~c | ~d) & (a | b | ~c));\n    \nendmodule\n```\n\ntipsï¼šè¿™é“é¢˜æ˜¯æœ€å¤§é¡¹å’Œæœ€å°é¡¹çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ˜¯æœ€å°é¡¹ï¼Œä¹Ÿå°±æ˜¯ç§¯ä¹‹å’Œï¼Œä½†æ˜¯æœ€å¤§é¡¹ä¹Ÿéœ€è¦äº†è§£ä¸€ä¸‹ï¼Œä¸€èˆ¬ä½¿ç”¨æœ€å°é¡¹å°±å¥½äº†ã€‚\n\n**é¢˜ç›®æè¿°6**ï¼š\n\nå®ç°ä¸‹é¢å¡è¯ºå›¾æ‰€æè¿°çš„ç”µè·¯ã€‚\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232153758.png)\n\n**Solution6**ï¼š\n\n```verilog\nmodule top_module (\n    input [4:1] x, \n    output f );\n\n    assign f = ~x[1]&x[3] | x[2]&x[4];\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°7**ï¼š\n\nå®ç°ä¸‹é¢å¡è¯ºå›¾æ‰€æè¿°çš„ç”µè·¯ã€‚\n\n![11](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232153102.png)\n\n**Solution7**ï¼š\n\n```verilog\nmodule top_module (\n    input [4:1] x,\n    output f\n); \n\n    assign f = ~x[2]&~x[4] | ~x[1]&x[3] | x[2]&x[3]&x[4];\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°8**ï¼š\n\nå¯¹äºä¸‹é¢çš„å¡è¯ºå›¾ï¼Œç”¨ä¸€ä¸ª4-1å¤šè·¯é€‰æ‹©å™¨å’Œä¸é™çš„2-1å¤šè·¯é€‰æ‹©å™¨ï¼Œä½†2-1å¤šè·¯é€‰æ‹©å™¨çš„ä½¿ç”¨è¦å°½å¯èƒ½å°‘ã€‚ä½ ä¸å…è®¸ä½¿ç”¨ä»»ä½•å…¶ä»–é€»è¾‘é—¨ï¼Œä½ å¿…é¡»ä½¿ç”¨aå’Œbä½œä¸ºå¤šè·¯å¤ç”¨å™¨é€‰æ‹©å™¨çš„è¾“å…¥ï¼Œå¦‚ä¸‹é¢çš„4- 1å¤šè·¯å¤ç”¨å™¨æ‰€ç¤ºã€‚\n\n![12](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232153765.png)\n\n**Solution8**ï¼š\n\n```verilog\nmodule top_module (\n    input c,\n    input d,\n    output [3:0] mux_in\n);\n    \n    always @(*) begin\n        case({c,d})\n            2'b0:\n                mux_in = 4'b0100;\n            2'b1:\n                mux_in = 4'b0001;\n            2'b11:\n                mux_in = 4'b1001;\n            default:\n                mux_in = 4'b0101;\n        endcase\n    end\n\nendmodule\n```\n\n------\n\n## æ€»ç»“\n\n- ç†Ÿæ‚‰äº†å¡è¯ºå›¾å’ŒåŸºæœ¬çš„è®¡ç®—å•å…ƒ\n- ç†Ÿæ‚‰äº†å¡è¯ºå›¾çš„åŒ–ç®€æ–¹å¼ï¼Œäº†è§£äº†SOPå’ŒPOSçš„åŒºåˆ«ä¸è”ç³»ï¼Œä»¥åŠå¦‚ä½•æ±‚å¾—SOPæœ€ç®€å¼ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(8)_åŠåŠ å™¨ã€å…¨åŠ å™¨å’Œè¡Œæ³¢è¿›ä½åŠ æ³•å™¨åŸç†ä¸è®¾è®¡","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(8)_VerilogåŠåŠ å™¨ã€å…¨åŠ å™¨å’Œè¡Œæ³¢è¿›ä½åŠ æ³•å™¨åŸç†ä¸è®¾è®¡/","content":"\n# åŠåŠ å™¨ã€å…¨åŠ å™¨å’Œè¡Œæ³¢è¿›ä½åŠ æ³•å™¨åŸç†ä¸è®¾è®¡\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## åŠåŠ å™¨\n\n**å®šä¹‰**ï¼š\n\nåŠåŠ å™¨ç”¨äºè®¡ç®—2ä¸ªå•æ¯”ç‰¹äºŒè¿›åˆ¶æ•°aä¸bçš„å’Œï¼Œè¾“å‡ºç»“æœsumï¼ˆsï¼‰å’Œè¿›ä½carryï¼ˆcï¼‰ã€‚åœ¨å¤šæ¯”ç‰¹æ•°çš„è®¡ç®—ä¸­ï¼Œè¿›ä½cå°†ä½œä¸ºä¸‹ä¸€ç›¸é‚»æ¯”ç‰¹çš„åŠ æ³•è¿ç®—ä¸­ã€‚å…¶çœŸå€¼è¡¨å¦‚ä¸‹æ‰€ç¤ºã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232150420.png)\n\n**é¢˜ç›®æè¿°**ï¼šå®ç°ä¸€ä¸ªåŠåŠ å™¨ã€‚åŠåŠ å™¨å°†ä¸¤ä½æ¯”ç‰¹ç›¸åŠ (ä¸å¸¦è¿›ä½)å¹¶äº§ç”Ÿä¸€ä¸ª1bitç»“æœå’Œä¸€ä¸ªè¿›ä½ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module( \n    input a, b,\n    output cout, sum );\n    assign {cout,sum} = a + b;\nendmodule\n\n```\n\n------\n\n## å…¨åŠ å™¨\n\n**å®šä¹‰**ï¼š\n\nå…¨åŠ å™¨ä¸åŒäºåŠåŠ å™¨çš„åœ°æ–¹æ˜¯ï¼Œå…¨åŠ å™¨å¸¦æœ‰è¿›ä½cinã€‚è¾“å…¥ä¸ºa,b,cin, è¾“å‡ºä¸ºsumï¼ˆsï¼‰å’Œcarry*ï¼ˆcoutï¼‰ï¼Œå‡æ˜¯å•æ¯”ç‰¹ä¿¡å·ã€‚sä¸ºa,b,cinä¸‰ä¸ªå•æ¯”ç‰¹æ•°çš„å’Œï¼Œcoutä¸ºa,b,cinä¸‰ä¸ªæ•°è¶…è¿‡2åçš„è¿›ä½ã€‚\n\n**é¢˜ç›®æè¿°**ï¼šå®ç°ä¸€ä¸ªå…¨åŠ å™¨ã€‚å…¨åŠ å™¨å°†ä¸¤ä½æ¯”ç‰¹ç›¸åŠ (å¸¦è¿›ä½)å¹¶äº§ç”Ÿä¸€ä¸ª1bitç»“æœå’Œä¸€ä¸ªè¿›ä½ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module( \n    input a, b, cin,\n    output cout, sum );\n    assign {cout,sum} = a + b + cin;\nendmodule\n```\n\n------\n\n## è¡Œæ³¢è¿›ä½åŠ æ³•å™¨\n\n**å®šä¹‰**ï¼šN-bitåŠ æ³•å™¨å¯ä»¥æ ¹æ®1-bitå…¨åŠ å™¨ç»„åˆè€Œæˆã€‚æ¯ä¸ªå…¨åŠ å™¨çš„è¾“å‡ºè¿›ä½coutä½œä¸ºä¸‹ä¸€ä¸ªå…¨åŠ å™¨çš„è¾“å…¥è¿›ä½cinï¼Œè¿™ç§åŠ æ³•å™¨ç§°ä¸ºè¡Œæ³¢è¿›ä½åŠ æ³•å™¨(Ripple-carry adderï¼Œç®€ç§°RCA)ã€‚\n\n**é¢˜ç›®æè¿°**ï¼šç°åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•å®ç°ä¸€ä¸ªå…¨åŠ å™¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒçš„3ä¸ªå®ä¾‹æ¥åˆ›å»ºä¸€ä¸ª3ä½äºŒè¿›åˆ¶çš„è¡Œæ³¢è¿›ä½åŠ æ³•å™¨ã€‚\n\nè¡Œæ³¢è¿›ä½åŠ æ³•å™¨å°†ä¸¤ä¸ª3ä½æ•°å­—å’Œä¸€ä¸ªè¿›ä½ç›¸åŠ ä»¥äº§ç”Ÿä¸€ä¸ª3ä½ç»“æœå’Œä¸€ä¸ªè¿›ä½è¾“å‡ºã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module( \n    input [2:0] a, b,\n    input cin,\n    output [2:0] cout,\n    output [2:0] sum );\n    assign {cout[0],sum[0]} = a[0] + b[0] +cin;\n    assign {cout[1],sum[1]} = a[1] + b[1] +cout[0];\n    assign {cout[2],sum[2]} = a[2] + b[2] +cout[1];\nendmodule\n```\n\n------\n\n## å·©å›ºç»ƒä¹ \n\n**é¢˜ç›®æè¿°1**ï¼šå®ç°ä¸‹å›¾æ‰€ç¤ºç”µè·¯ï¼Œå…¶ä¸­â€œFAâ€æŒ‡å…¨åŠ å™¨(Full Adder)ã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232151524.png)\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module (\n    input [3:0] x,\n    input [3:0] y, \n    output [4:0] sum);\n    \n    wire [2:0] cout;\n    \n    assign {cout[0],sum[0]} = x[0] + y[0];\n    assign {cout[1],sum[1]} = x[1] + y[1] + cout[0];\n    assign {cout[2],sum[2]} = x[2] + y[2] + cout[1];\n    assign {sum[4],sum[3]} = x[3] + y[3] + cout[2];\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°2**ï¼š\n\nå‡è®¾æœ‰ä¸¤ä¸ª8ä½æ•°å­—çš„è¡¥ç ï¼Œa[7:0]å’Œb[7:0]ã€‚è¿™ä¿©æ•°å­—ç›¸åŠ äº§ç”Ÿs[7:0]ã€‚æ¨¡å—ä¸­éœ€è®¡ç®—æ˜¯å¦å‘ç”Ÿäº†(æœ‰ç¬¦å·çš„)æº¢å‡ºã€‚\n\ntipsï¼šå½“ä¸¤ä¸ªæ­£æ•°ç›¸åŠ äº§ç”Ÿä¸€ä¸ªè´Ÿç»“æœï¼Œæˆ–ä¸¤ä¸ªè´Ÿæ•°ç›¸åŠ äº§ç”Ÿä¸€ä¸ªæ­£ç»“æœæ—¶ï¼Œä¼šå‘ç”Ÿç¬¦å·æº¢å‡ºç°è±¡ã€‚æœ‰å‡ ç§æ£€æµ‹æº¢å‡ºçš„æ–¹æ³•:å¯ä»¥é€šè¿‡æ¯”è¾ƒè¾“å…¥å’Œè¾“å‡ºæ•°å­—çš„ç¬¦å·æ¥è®¡ç®—æº¢å‡ºï¼Œæˆ–è€…ä»nä½å’Œn-1ä½çš„è¿›ä½æ¥åˆ¤æ–­æ˜¯å¦æº¢å‡ºã€‚\n\n**Solution2**ï¼š\n\n```verilog\nmodule top_module (\n    input [7:0] a,\n    input [7:0] b,\n    output [7:0] s,\n    output overflow\n); \n \n    assign s = a + b;\n    assign overflow = (a[7]&b[7]&~s[7]) | ((~a[7])&(~b[7])&s[7]);\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°3**ï¼šåˆ›å»ºä¸€ä¸ª100ä½çš„äºŒè¿›åˆ¶åŠ æ³•å™¨ã€‚åŠ æ³•å™¨å°†ä¸¤ä¸ª100ä½çš„æ•°å’Œä¸€ä¸ªè¿›ä½ç›¸åŠ äº§ç”Ÿä¸€ä¸ª100ä½çš„ç»“æœå’Œä¸€ä¸ªè¿›ä½ã€‚\n\n**Solution3**ï¼š\n\n```verilog\nmodule top_module( \n    input [99:0] a, b,\n    input cin,\n    output cout,\n    output [99:0] sum );\n    \n    assign {cout,sum[99:0]} = a + b + cin;\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°4**ï¼š\n\nå·²æœ‰ä¸€ä¸ªBCD(äºŒè¿›åˆ¶ç¼–ç çš„åè¿›åˆ¶)æ•°åŠ æ³•å™¨ï¼Œåä¸º`bcd_fadd`ï¼Œå®ƒå°†ä¸¤ä¸ªBCDæ•°å­—å’Œè¿›ä½ä¿¡å·ç›¸åŠ ï¼Œç”Ÿæˆç»“æœå’Œè¿›ä½ä¿¡å·ã€‚\n\n```verilog\nmodule bcd_fadd {\n    input [3:0] a,\n    input [3:0] b,\n    input     cin,\n    output   cout,\n    output [3:0] sum );\n```\n\nå®ä¾‹åŒ–`bcd_fadd`çš„4ä¸ªå‰¯æœ¬ï¼Œä»¥åˆ›å»ºä¸€ä¸ª4ä½BCDè¡Œæ³¢è¿›ä½åŠ æ³•å™¨ã€‚\n\n**Solution4**ï¼š\n\n```verilog\nmodule top_module( \n    input [15:0] a, b,\n    input cin,\n    output cout,\n    output [15:0] sum );\n    \n    wire [2:0] cout_temp;\n    \n    bcd_fadd bcd_1(a[3:0],b[3:0],cin,cout_temp[0],sum[3:0]);\n    bcd_fadd bcd_2(a[7:4],b[7:4],cout_temp[0],cout_temp[1],sum[7:4]);\n    bcd_fadd bcd_3(a[11:8],b[11:8],cout_temp[1],cout_temp[2],sum[11:8]);\n    bcd_fadd bcd_4(a[15:12],b[15:12],cout_temp[2],cout,sum[15:12]);\n\nendmodule\n```\n\n------\n\n## æ€»ç»“\n\n- å­¦ä¹ äº†å¸¸è§åŠ æ³•å™¨çš„åŸç†ä¸è®¾è®¡\n- å­¦ä¹ äº†å¸¦è¿›ä½åŠ æ³•å™¨çš„çº§è”","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(7)_Verilogå¤šè·¯é€‰æ‹©å™¨","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(7)_Verilogå¤šè·¯é€‰æ‹©å™¨/","content":"\n# Verilogå¤šè·¯é€‰æ‹©å™¨\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n## å®šä¹‰\n\nå¤šè·¯é€‰æ‹©å™¨(Multiplexer)ç®€ç§°å¤šè·¯å™¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¤šè¾“å…¥ã€å•è¾“å‡ºçš„ç»„åˆé€»è¾‘ç”µè·¯ï¼Œåœ¨æ•°å­—ç³»ç»Ÿä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚å®ƒå¯ä»¥æ ¹æ®åœ°å€ç (é€‰æ‹©ç )çš„ä¸åŒï¼Œä»å¤šä¸ªè¾“å…¥æ•°æ®æµä¸­é€‰å–ä¸€ä¸ªï¼Œè®©å…¶è¾“å‡ºåˆ°å…¬å…±çš„è¾“å‡ºç«¯ã€‚\n\n------\n\n## éƒ¨åˆ†ç»ƒä¹ é¢˜\n\n**é¢˜ç›®æè¿°1**ï¼šå®ç°ä¸€ä¸ªä½å®½ä¸º1çš„2-1çš„å¤šè·¯é€‰æ‹©å™¨ã€‚å½“sel=0ï¼Œé€‰æ‹©aï¼Œå½“sel=1ï¼Œé€‰æ‹©bã€‚\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module( \n    input a, b, sel,\n    output out ); \n\tassign out = sel ? b : a;\nendmodule\n```\n\n**é¢˜ç›®æè¿°2**ï¼šå®ç°ä¸€ä¸ªä½å®½ä¸º100çš„2-1çš„å¤šè·¯é€‰æ‹©å™¨ã€‚å½“sel=0ï¼Œé€‰æ‹©aï¼Œå½“sel=1ï¼Œé€‰æ‹©bã€‚\n\n**Solution2**ï¼š\n\n```verilog\nmodule top_module( \n    input [99:0] a, b,\n    input sel,\n    output [99:0] out );\n\tassign out = sel ? b : a;\nendmodule\n```\n\n**é¢˜ç›®æè¿°3**ï¼šåˆ›å»ºä¸€ä¸ªä½å®½ä¸º16çš„9-1çš„å¤šè·¯é€‰æ‹©å™¨ã€‚sel=0é€‰æ‹©a, sel=1é€‰æ‹©bï¼Œä»¥æ­¤ç±»æ¨ã€‚å¯¹äºæœªä½¿ç”¨çš„selå€¼(sel=9~15)ï¼Œå°†æ‰€æœ‰è¾“å‡ºä½è®¾ç½®ä¸º1ã€‚\n\n**Solution3**ï¼š\n\n```verilog\nmodule top_module( \n    input [15:0] a, b, c, d, e, f, g, h, i,\n    input [3:0] sel,\n    output [15:0] out );\n\n    always @(*) begin\n        case(sel)\n            4'd0: out = a;\n            4'd1: out = b;\n            4'd2: out = c;\n            4'd3: out = d;\n            4'd4: out = e;\n            4'd5: out = f;\n            4'd6: out = g;\n            4'd7: out = h;\n            4'd8: out = i;\n            default:out = 16'hffff;\n        endcase\n    end\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°4**ï¼šåˆ›å»ºä¸€ä¸ªä½å®½ä¸º1çš„256-1çš„å¤šè·¯é€‰æ‹©å™¨ã€‚256ä¸ªè¾“å…¥éƒ½è¢«æ‰“åŒ…æˆä¸€ä¸ª256ä½çš„è¾“å…¥å‘é‡ã€‚sel=0è¡¨ç¤ºé€‰æ‹©in[0]ï¼Œsel=1è¡¨ç¤ºé€‰æ‹©in[1]ï¼Œä»¥æ­¤ç±»æ¨ã€‚\n\n**Solution4**ï¼š\n\n```verilog\nmodule top_module( \n    input [255:0] in,\n    input [7:0] sel,\n    output out );\n    assign out = in[sel];\nendmodule\n```\n\n**é¢˜ç›®æè¿°5**ï¼šåˆ›å»ºä¸€ä¸ªä½å®½ä¸º4çš„256-1çš„å¤šè·¯é€‰æ‹©å™¨ã€‚256ä¸ª4ä½è¾“å…¥éƒ½è¢«æ‰“åŒ…æˆä¸€ä¸ª1024ä½çš„è¾“å…¥å‘é‡ã€‚sel=0é€‰æ‹©in[3:0]ï¼Œsel=1é€‰æ‹©in[7:4]ï¼Œsel=2é€‰æ‹©in[11:8]ï¼Œä»¥æ­¤ç±»æ¨ã€‚\n\n**Solution5**ï¼š\n\n```verilog\nmodule top_module( \n    input [1023:0] in,\n    input [7:0] sel,\n    output [3:0] out );\n    assign out = in[sel*4+3 -: 4];\nendmodule\n```\n\ntipsï¼š\n\n```verilog\ndata[0 +: 8]  <--ç­‰ä»·äº--> data[7:0]\ndata[15 +: 2] <--ç­‰ä»·äº--> data[16:15]\ndata[7 -: 8]  <--ç­‰ä»·äº--> data[7:0]\ndata[15 -: 2] <--ç­‰ä»·äº--> data[15:14]\n```\n\n------\n\n## æ€»ç»“\n\n- å­¦ä¹ äº†å¤šè·¯é€‰æ‹©å™¨çš„ç›¸å…³çŸ¥è¯†ã€‚\n- å­¦ä¹ äº†å¯ä»¥æ ¹æ®å‘é‡ç´¢å¼•è¿›è¡Œæ•°æ®çš„é€‰æ‹©ï¼Œè¦æ³¨æ„çš„æ˜¯è¢«é€‰å–æ•°æ®çš„ä½å®½æ˜¯å¦ä¸ºå¸¸æ•°ï¼Œåˆç†ä½¿ç”¨ +=ã€-=è¯­æ³•ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(6)_ç¡¬ä»¶æ¨¡å—è®¾è®¡çš„æ€è€ƒæ–¹å¼","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(6)_ç¡¬ä»¶æ¨¡å—è®¾è®¡çš„æ€è€ƒæ–¹å¼/","content":"\n# ç¡¬ä»¶æ¨¡å—è®¾è®¡çš„æ€è€ƒæ–¹å¼\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## åŸºæœ¬çš„é€»è¾‘é—¨æ“ä½œ\n\n**é¢˜ç›®æè¿°1**ï¼šå°†è¾“å…¥ç«¯å£inå’Œè¾“å‡ºç«¯å£outè¿æ¥ã€‚\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module (\n    input in,\n    output out);\n\tassign out = in;\nendmodule\n```\n\n**é¢˜ç›®æè¿°2**ï¼šå°†è¾“å‡ºoutæ¥åœ°ã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232148143.png)\n\n**Solution2**ï¼š\n\n```verilog\nmodule top_module (\n    output out);\n\tassign out = 1'b0;\nendmodule\n```\n\n**é¢˜ç›®æè¿°3**ï¼šå®ç°æˆ–éé—¨æ“ä½œã€‚\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232148889.png)\n\n**Solution3**ï¼š\n\n```verilog\nmodule top_module (\n    input in1,\n    input in2,\n    output out);\n    assign out =~(in1 | in2);\nendmodule\n```\n\n**é¢˜ç›®æè¿°4**ï¼šå®ç°ä¸‹å›¾æ‰€ç¤ºçš„é€»è¾‘æ“ä½œã€‚\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232148719.png)\n\n**Solution4**ï¼š\n\n```verilog\nmodule top_module (\n    input in1,\n    input in2,\n    output out);\n    assign out = in1 & (~in2);\nendmodule\n```\n\n**é¢˜ç›®æè¿°5**ï¼šå®ç°ä¸‹å›¾æ‰€ç¤ºçš„é€»è¾‘æ“ä½œã€‚\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232148746.png)\n\n**Solution5**ï¼š\n\n```verilog\nmodule top_module (\n    input in1,\n    input in2,\n    input in3,\n    output out);\n\twire temp;\n    assign temp = ~(in1^in2);\n    assign out = temp ^ in3;\nendmodule\n```\n\n**é¢˜ç›®æè¿°6**ï¼šå°è¯•åŒæ—¶å»ºç«‹å‡ ä¸ªé€»è¾‘é—¨ï¼Œå»ºç«‹ä¸€ä¸ªä¸¤è¾“å…¥çš„ç»„åˆç”µè·¯ã€‚\n\nå…±7ä¸ªè¾“å‡ºå¦‚ä¸‹ï¼š\n\n- out_and: a and b\n- out_or: a or b\n- out_xor: a xor b\n- out_nand: a nand b\n- out_nor: a nor b\n- out_xnor: a xnor b\n- out_anotb: a and-not b\n\n**Solution6**ï¼š\n\n```verilog\nmodule top_module( \n    input a, b,\n    output out_and,\n    output out_or,\n    output out_xor,\n    output out_nand,\n    output out_nor,\n    output out_xnor,\n    output out_anotb\n);\n\tassign out_and = a&b;\n    assign out_or = a|b;\n    assign out_xor = a^b;\n    assign out_nand = ~(a&b);\n    assign out_nor = ~(a|b);\n    assign out_xnor = ~(a^b);\n    assign out_anotb = a&(~b);\nendmodule\n```\n\n**é¢˜ç›®æè¿°7**ï¼š\n\n7400ç³»åˆ—é›†æˆç”µè·¯æ˜¯ä¸€ä¸ªæ•°å­—èŠ¯ç‰‡ç³»åˆ—ï¼Œæ¯ä¸ªéƒ½ç”±å‡ ä¸ªåŸºæœ¬çš„é€»è¾‘é—¨æ„æˆã€‚7420æ˜¯ä¸€ä¸ªå¸¦æœ‰ä¸¤ä¸ª4è¾“å…¥ä¸éé—¨çš„èŠ¯ç‰‡ã€‚\n\nå®ç°ä¸€ä¸ªå…·æœ‰ä¸7420èŠ¯ç‰‡ç›¸åŒåŠŸèƒ½çš„æ¨¡å—ï¼Œå…±8ä¸ªè¾“å…¥å’Œ2ä¸ªè¾“å‡ºã€‚\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232148054.png)\n\n**Solution7**ï¼š\n\n```verilog\nmodule top_module ( \n    input p1a, p1b, p1c, p1d,\n    output p1y,\n    input p2a, p2b, p2c, p2d,\n    output p2y );\n    assign p1y=~(p1a&p1b&p1c&p1d);\n    assign p2y=~(p2a&p2b&p2c&p2d);\nendmodule\n```\n\n------\n\n## çœŸå€¼è¡¨\n\nåœ¨å‰é¢çš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç®€å•çš„é€»è¾‘é—¨å’Œå‡ ä¸ªé€»è¾‘é—¨çš„ç»„åˆï¼Œè¿™äº›ç”µè·¯æ˜¯ç»„åˆç”µè·¯çš„ä¾‹å­ã€‚\n\n**ç»„åˆç”µè·¯çš„æ„æ€æ˜¯ç”µè·¯çš„è¾“å‡ºä»…å–å†³äºè¾“å…¥**ï¼Œè¿™æ„å‘³ç€å¯¹äºä»»ä½•ç»™å®šçš„è¾“å…¥å€¼ï¼Œåªæœ‰ä¸€ä¸ªå¯èƒ½çš„è¾“å‡ºå€¼ã€‚å› æ­¤ï¼Œæè¿°ç»„åˆå‡½æ•°è¡Œä¸ºçš„ä¸€ç§æ–¹æ³•æ˜¯æ˜ç¡®åœ°åˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„è¾“å…¥æ‰€å¯¹åº”çš„è¾“å‡ºå€¼ï¼Œå³çœŸå€¼è¡¨ã€‚\n\nå¯¹ä¸€ä¸ªæœ‰Nä¸ªè¾“å…¥çš„å¸ƒå°”å‡½æ•°è€Œè¨€ï¼Œæœ‰2^Nç§å¯èƒ½çš„è¾“å…¥ç»„åˆã€‚çœŸå€¼è¡¨çš„æ¯ä¸€è¡Œéƒ½åˆ—å‡ºäº†ä¸€ä¸ªè¾“å…¥ç»„åˆï¼Œå› æ­¤æ€»æœ‰2^Nè¡Œã€‚outputåˆ—æ˜¾ç¤ºäº†æ¯ä¸ªè¾“å…¥å€¼å¯¹åº”çš„è¾“å‡ºã€‚\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232149665.png)\n\né‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åªç”¨æ ‡å‡†é€»è¾‘é—¨æ¥å®ç°æŸ¥æ‰¾è¡¨çš„åŠŸèƒ½å‘¢ï¼Ÿ\n\nä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯å°†çœŸå€¼è¡¨ä¸­æ‰€æœ‰çš„çœŸå€¼å†™ä¸ºä¹˜ç§¯æ±‚å’Œé¡¹çš„å½¢å¼ã€‚**æ±‚å’Œå³ä¸ºæˆ–æ“ä½œï¼Œä¹˜ç§¯å³ä¸ºä¸æ“ä½œ**ã€‚å…ˆä½¿ç”¨ä¸€ä¸ªN-è¾“å…¥çš„ä¸é—¨æ¥å†³å®šæ˜¯å¦è¾“å…¥çš„å‘é‡ä¸çœŸå€¼è¡¨åŒ¹é…ï¼Œç„¶åå†ç”¨ä¸€ä¸ªæˆ–é—¨æ¥é€‰æ‹©æ»¡è¶³åŒ¹é…æ¡ä»¶çš„ç»“æœè¿›è¡Œè¾“å‡ºã€‚\n\n**é¢˜ç›®æè¿°**ï¼šæ„å»ºä¸€ä¸ªæ¨¡å—å®ç°ä¸Šè¿°çœŸå€¼è¡¨çš„åŠŸèƒ½ã€‚\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232150748.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module( \n    input x3,\n    input x2,\n    input x1,  // three inputs\n    output f   // one output\n);\n    assign f = (x1&x3)|(x2&~x3);\nendmodule\n```\n\n------\n\n## éƒ¨åˆ†è€ƒé¢˜\n\n**é¢˜ç›®æè¿°1**ï¼š\n\nåˆ›å»ºä¸€ä¸ªæœ‰ä¸¤ä¸ª2ä½è¾“å…¥A[1:0]å’ŒB[1:0]çš„ç”µè·¯ï¼Œäº§ç”Ÿä¸€ä¸ªè¾“å‡ºzã€‚è‹¥A=Bï¼Œåˆ™z=1ï¼Œå¦åˆ™z=0ã€‚\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module ( input [1:0] A, input [1:0] B, output z ); \n    assign z=(A==B)?1'b1:1'b0;\nendmodule\n```\n\n**é¢˜ç›®æè¿°2**ï¼š\n\næ„å»ºæ¨¡å—å®ç°å‡½æ•°`z = (x^y) & x`\n\n**Solution2**:\n\n```verilog\nmodule top_module (input x, input y, output z);\n    assign z=(x^y)&x;\nendmodule\n```\n\n**é¢˜ç›®æè¿°3**ï¼š\n\næ„å»ºæ¨¡å—å®ç°å¦‚ä¸‹æ³¢å½¢å›¾çš„è¾“å…¥è¾“å‡ºå…³ç³»\n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232150470.png)\n\n**Solution3**ï¼š\n\n```verilog\nmodule top_module ( input x, input y, output z );\n    assign z=~(x^y);\nendmodule\n```\n\n**é¢˜ç›®æè¿°4**ï¼š\n\nAæ¨¡å—å®ç°çš„åŠŸèƒ½å¦‚ä¸Šè¿°é¢˜äºŒæ‰€ç¤ºï¼ŒBæ¨¡å—å®ç°çš„åŠŸèƒ½å¦‚é¢˜ä¸‰æ‰€ç¤ºã€‚æ­å»ºæ¨¡å—å®ç°ä¸‹å›¾æ‰€ç¤ºåŠŸèƒ½ï¼š\n\n![9](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232150779.png)\n\n**Solution4**ï¼š\n\n```verilog\nmodule top_module (input x, input y, output z);\n\t\n    wire za;\n    wire zb;\n    \n    assign za = (x ^ y) & x;\n    assign zb = ~(x ^ y);\n    assign z = (za | zb) ^ (za & zb);\n    \nendmodule\n```\n\n------\n\n## ç¡¬ä»¶å·¥ç¨‹å¸ˆçš„æ€è€ƒæ–¹å¼\n\ntipsï¼šå½“è¿›è¡Œæ¨¡å—è®¾è®¡æ—¶ï¼Œæˆ‘ä»¬æœ€å¥½åå‘æ€è€ƒé—®é¢˜ï¼Œå¦‚ä½•ä»è¾“å‡ºåˆ°è¾“å…¥ã€‚è¿™ä¸æˆ‘ä»¬å¹³æ—¶é¡ºåºå¼åœ°æ€è€ƒç¼–ç¨‹é—®é¢˜ä¸åŒï¼Œåœ¨ç¼–ç¨‹æ—¶æˆ‘ä»¬ä¸€èˆ¬é¦–å…ˆçœ‹è¾“å…¥å¦‚ä½•å†³å®šè¾“å‡ºï¼Œå³è¾“å…¥ä¸ºXXæ—¶è¾“å‡ºä¸ºXXï¼›**å¯¹ç¡¬ä»¶å·¥ç¨‹å¸ˆè€Œè¨€ï¼Œé€šå¸¸çš„æ€è·¯ä¸ºè¾“å‡ºä¸ºXXæ—¶è¾“å…¥æ˜¯XX**ï¼Ÿ\n\nåœ¨ç¡¬ä»¶è®¾è®¡ä¸­ï¼Œåœ¨ä¸¤ç§æ€è·¯é—´æ€è€ƒä¸åˆ‡æ¢æ˜¯å¾ˆé‡è¦çš„æŠ€èƒ½ã€‚\n\n**é¢˜ç›®æè¿°1**ï¼šè®¾è®¡ä¸€ç§ç”µè·¯æ¥æ§åˆ¶æ‰‹æœºçš„é“ƒå£°å’ŒæŒ¯åŠ¨é©¬è¾¾ã€‚å½“æœ‰æ¥ç”µè¾“å…¥ä¿¡å·æ—¶(input **ring**)ï¼Œç”µè·¯å¿…é¡»æ‰“å¼€é“ƒå£°(output **ringer**= 1)æˆ–ç”µæœº(output **motor**= 1)ï¼Œä½†ä¸èƒ½åŒæ—¶æ‰“å¼€ã€‚å¦‚æœæ‰‹æœºå¤„äºæŒ¯åŠ¨æ¨¡å¼(input **vibrate_mode** = 1)ï¼Œæ‰“å¼€ç”µæœºã€‚å¦åˆ™æ‰“å¼€é“ƒå£°ã€‚\n\n![10](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232149798.png)\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module (\n    input ring,\n    input vibrate_mode,\n    output ringer,       // Make sound\n    output motor         // Vibrate\n);\n    assign ringer = ring & (~vibrate_mode);\n    assign motor = ring & vibrate_mode;\nendmodule\n```\n\n**é¢˜ç›®æè¿°2**ï¼šåŠ çƒ­/å†·å´æ’æ¸©å™¨åŒæ—¶æ§åˆ¶åŠ çƒ­å™¨(å†¬å­£)å’Œç©ºè°ƒ(å¤å­£)ã€‚è®¾è®¡ä¸€ä¸ªç”µè·¯ï¼Œæ ¹æ®éœ€è¦æ‰“å¼€æˆ–å…³é—­åŠ çƒ­å™¨ã€ç©ºè°ƒå’Œé¼“é£æœºã€‚\n\næ’æ¸©å™¨æœ‰ä¸¤ç§æ¨¡å¼:åŠ çƒ­æ¨¡å¼(mode= 1)å’Œå†·å´æ¨¡å¼(mode= 0)ã€‚åœ¨åŠ çƒ­æ¨¡å¼ä¸‹ï¼Œå½“æ¸©åº¦è¿‡ä½æ—¶æ‰“å¼€åŠ çƒ­å™¨(too_cold = 1)ä½†æ˜¯ä¸è¦ä½¿ç”¨ç©ºè°ƒã€‚åœ¨å†·å´æ¨¡å¼ä¸‹ï¼Œå½“æ¸©åº¦å¤ªé«˜(too_hot= 1)æ—¶æ‰“å¼€ç©ºè°ƒï¼Œä½†ä¸è¦æ‰“å¼€åŠ çƒ­å™¨ã€‚\n\nå½“æš–æ°”æˆ–ç©ºè°ƒæ‰“å¼€æ—¶ã€‚åŒæ—¶æ‰“å¼€é£æ‰‡è®©ç©ºæ°”æµé€šã€‚æ­¤å¤–ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥ä»…è¦æ±‚é£æ‰‡æ‰“å¼€(fan_on = 1)ï¼Œå³ä½¿åŠ çƒ­å™¨å’Œç©ºè°ƒå…³é—­ã€‚\n\n**Solution2**ï¼š\n\n```verilog\nmodule top_module (\n    input too_cold,\n    input too_hot,\n    input mode,\n    input fan_on,\n    output heater,\n    output aircon,\n    output fan\n); \n\tassign heater = mode & too_cold;\n    assign aircon = (~mode) & too_hot;\n    assign fan = (mode & too_cold) | ((~mode) & too_hot) | fan_on;\nendmodule\n```\n\n------\n\n## å¯¹å•å‘é‡çš„å„bitè¿›è¡Œæ“ä½œ\n\n**é¢˜ç›®æè¿°1**ï¼šä¸º3ä½è¾“å…¥å‘é‡æ„é€ ä¸€ä¸ªæ•°1çš„è®¡æ•°ç”µè·¯ã€‚\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module( \n    input [2:0] in,\n    output [1:0] out );\n    integer i;\n    always @(*) begin\n        out = 2'b0;\n        for(i=0;i<3;i++) begin\n            out = out + in[i];\n        end\n    end\nendmodule\n```\n\n**é¢˜ç›®æè¿°2**ï¼šè¾“å…¥ä¸€ä¸ª4ä½çš„è¾“å…¥å‘é‡in[3:0]ï¼Œè¾“å‡ºæ¯ä¸ªæ¯”ç‰¹å’Œå®ƒç›¸é‚»æ¯”ç‰¹ä¹‹é—´çš„ä¸€äº›å…³ç³»:\n\n- out_both:è¿™ä¸ªè¾“å‡ºå‘é‡çš„æ¯ä¸€ä½åº”è¯¥è¡¨ç¤ºå¯¹åº”çš„è¾“å…¥ä½å’Œå®ƒå·¦è¾¹çš„æ¯”ç‰¹ä½(å·¦è¾¹æ¯”ç‰¹å…·æœ‰æ›´é«˜çš„ç´¢å¼•)**æ˜¯å¦å‡ä¸ºâ€œ1â€**ã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œout_both[2]åº”è¯¥æŒ‡ç¤ºå‡ºin[2]å’Œin[3]æ˜¯å¦å‡ä¸º1ã€‚\n- out_any:è¿™ä¸ªè¾“å‡ºå‘é‡çš„æ¯ä¸€ä½éƒ½åº”è¯¥è¡¨ç¤ºç›¸åº”çš„è¾“å…¥ä½å’Œå®ƒå³è¾¹çš„æ¯”ç‰¹ä½**æ˜¯å¦å­˜åœ¨â€œ1â€**ã€‚\n- out_different:è¿™ä¸ªè¾“å‡ºå‘é‡çš„æ¯ä¸€ä½éƒ½åº”è¯¥è¡¨æ˜ç›¸åº”çš„è¾“å…¥ä½æ˜¯å¦ä¸å…¶å·¦è¾¹çš„æ¯”ç‰¹ä½**ä¸åŒ**ã€‚\n\n**Solution2**ï¼š\n\næ€è·¯ä¸€ï¼š\n\n```verilog\nmodule top_module( \n    input [3:0] in,\n    output [2:0] out_both,\n    output [3:1] out_any,\n    output [3:0] out_different );\n    \n\tinteger i;\n    \n    always @(*) begin\n        for(i=0;i<3;i++) begin\n            out_both[i] = in[i] & in[i+1];\n            out_any[i+1] = in[i+1] | in[i];\n            out_different[i] = in[i] ^ in[i+1];\n        end\n        out_different[3] = in[0] ^ in[3];\n    end\n    \nendmodule\n```\n\næ€è·¯äºŒï¼š\n\n```verilog\nmodule top_module( \n    input [3:0] in,\n    output [2:0] out_both,\n    output [3:1] out_any,\n    output [3:0] out_different );\n\n    assign out_both = in[2:0] & in[3:1];\n    assign out_any = in[3:1] | in[2:0];\n    assign out_different = in[3:0] ^ {in[0],in[3:1]};\n    \nendmodule\n```\n\n**é¢˜ç›®æè¿°3**ï¼šé¢˜ç›®åŒä¸Šï¼Œä½†è¾“å…¥å‘é‡å˜ä¸º100ä½ã€‚\n\n**Solution3**ï¼š\n\næ€è·¯ä¸€ï¼š\n\n```verilog\nmodule top_module( \n    input [99:0] in,\n    output [98:0] out_both,\n    output [99:1] out_any,\n    output [99:0] out_different );\n\n\tinteger i;\n    \n    always @(*) begin\n        for(i=0;i<99;i++) begin\n            out_both[i] = in[i] & in[i+1];\n            out_any[i+1] = in[i+1] | in[i];\n            out_different[i] = in[i] ^ in[i+1];\n        end\n        out_different[99] = in[0] ^ in[99];\n    end\n    \nendmodule\n```\n\næ€è·¯äºŒï¼š\n\n```verilog\nmodule top_module( \n    input [99:0] in,\n    output [98:0] out_both,\n    output [99:1] out_any,\n    output [99:0] out_different );\n\n    assign out_both = in[98:0] & in[99:1];\n    assign out_any = in[99:1] | in[98:0];\n    assign out_different = in[99:0] ^ {in[0],in[99:1]};\n    \nendmodule\n```\n\n------\n\n## æ€»ç»“\n\n- ç†Ÿæ‚‰äº†åŸºæœ¬çš„é€»è¾‘é—¨æ“ä½œã€‚\n- å­¦ä¹ äº†ç¡¬ä»¶å·¥ç¨‹å¸ˆçš„è®¾è®¡æ€ç»´ï¼šç”±è¾“å‡ºåˆ°è¾“å…¥ã€‚\n- å­¦ä¹ äº†ç”¨æ ‡å‡†çš„é€»è¾‘é—¨å®ç°æŸ¥æ‰¾è¡¨çš„åŠŸèƒ½ã€‚\n- åˆç†ä½¿ç”¨assignæˆ–forå¾ªç¯å¯¹å‘é‡çš„å„bitä½è¿›è¡Œæ“ä½œã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(5)_Generateå®ä¾‹åŒ–æ¨¡å—","url":"/2022/09/12/IC/HDLBits/HDLBitsç­”æ¡ˆ(5)_Generateå®ä¾‹åŒ–æ¨¡å—/","content":"\n# Generateå®ä¾‹åŒ–æ¨¡å—\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## ä¸‰ç›®è¿ç®—ç¬¦(å½¢å¼ï¼šcondition ? if_true : if_false)\n\nverilogä¸­æœ‰è·Ÿcè¯­è¨€ç±»ä¼¼çš„ä¸‰ç›®è¿ç®—ç¬¦ï¼Œè¿™å¯ä»¥ç”¨äº**åœ¨ä¸€è¡Œä¸­**æ ¹æ®æ¡ä»¶é€‰æ‹©ä¸¤ä¸ªå€¼ä¸­çš„ä¸€ä¸ªï¼Œè€Œä¸ç”¨åœ¨ç»„åˆalwayså—ä¸­ä½¿ç”¨if-thenã€‚ä¸‹é¢ç»™å‡ºä¸€äº›ç¤ºä¾‹ï¼š\n\n```verilog\n(0 ? 3 : 5)     // This is 5 because the condition is false.\n(sel ? b : a)   // A 2-to-1 multiplexer between a and b selected by sel.\n\nalways @(posedge clk)         // A T-flip-flop.\n  q <= toggle ? ~q : q;\n\nalways @(*)                   // State transition logic for a one-input FSM\n  case (state)\n    A: next = w ? B : A;\n    B: next = w ? A : B;\n  endcase\n\nassign out = ena ? q : 1'bz;  // A tri-state buffer\n\n((sel[1:0] == 2'h0) ? a :     // A 3-to-1 mux\n (sel[1:0] == 2'h1) ? b :\n                      c )\n```\n\n**é¢˜ç›®æè¿°**ï¼š\n\nç»™å®š4ä¸ªæ— ç¬¦å·æ•°ï¼Œæ±‚æœ€å°å€¼ã€‚æ— ç¬¦å·æ•°å¯ä»¥ç”¨æ¯”è¾ƒè¿ç®—ç¬¦(a <b)è¿›è¡Œæ¯”è¾ƒã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [7:0] a, b, c, d,\n    output [7:0] min);\n\n    wire [7:0] mintemp1;\n    wire [7:0] mintemp2;\n    assign mintemp1 = (a<b)? a:b;\n    assign mintemp2 = (c<mintemp1)?c:mintemp1;\n    assign min = (d<mintemp2)?d:mintemp2;\n\nendmodule\n```\n\n------\n\n## ç¼©ä½è¿ç®—ç¬¦\n\nç¼©ä½è¿ç®—ç¬¦å¯ä»¥å¯¹å‘é‡çš„å„ä¸ªä½è¿›è¡Œå’Œã€æˆ–å’Œå¼‚æˆ–æ“ä½œï¼Œäº§ç”Ÿ1ä½çš„è¾“å‡º:\n\n```verilog\n& a[3:0]     // AND: a[3]&a[2]&a[1]&a[0]. Equivalent to (a[3:0] == 4'hf)\n| b[3:0]     // OR:  b[3]|b[2]|b[1]|b[0]. Equivalent to (b[3:0] != 4'h0)\n^ c[2:0]     // XOR: c[2]^c[1]^c[0]\n```\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡ç¿»è½¬ä¸Šè¿°ç¼©ä½è¿ç®—çš„è¾“å‡ºæ¥è·å¾—NANDã€NORå’ŒXNORç¼©ä½è¿ç®—çš„è¾“å‡ºã€‚\n\n**é¢˜ç›®æè¿°1**ï¼šå¥‡å¶æ ¡éªŒç»å¸¸è¢«ç”¨ä½œä¼ è¾“æ•°æ®æ—¶æ£€æµ‹é”™è¯¯çš„ç®€å•æ–¹æ³•ã€‚åˆ›å»ºä¸€ä¸ªç”µè·¯ï¼Œä¸ºä¸€ä¸ª8ä½å­—èŠ‚è®¡ç®—ä¸€ä¸ªå¥‡å¶æ ¡éªŒä½(å®ƒå°†åœ¨1ä¸ªå­—èŠ‚çš„åŸºç¡€ä¸Šå¢åŠ 1ä½)ã€‚æˆ‘ä»¬å°†ä½¿ç”¨â€œå¶æ•°â€å¥‡å¶æ ¡éªŒï¼Œå…¶ä¸­å¥‡å¶æ ¡éªŒä½åªæ˜¯æ‰€æœ‰8ä½æ•°æ®ä½çš„å¼‚æˆ–ã€‚\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module (\n    input [7:0] in,\n    output parity); \n\tassign parity = ^ in;\nendmodule\n```\n\n**é¢˜ç›®æè¿°2**ï¼šæ„å»ºä¸€ä¸ªç»„åˆç”µè·¯ï¼ŒåŒ…æ‹¬100ä¸ªè¾“å…¥ï¼Œin[99:0]ï¼›\n\n3ä¸ªè¾“å‡ºï¼š\n\n- out_andï¼š100ä¸ªä¸é—¨çš„è¾“å‡º\n- out_orï¼š100ä¸ªæˆ–é—¨çš„è¾“å‡º\n- out_xorï¼š100ä¸ªå¼‚æˆ–é—¨çš„è¾“å‡º\n\n**Solution2**ï¼š\n\n```verilog\nmodule top_module( \n    input [99:0] in,\n    output out_and,\n    output out_or,\n    output out_xor \n);\n\tassign out_and = &in;\n    assign out_or = |in;\n    assign out_xor = ^in;\nendmodule\n```\n\n------\n\n## forå¾ªç¯çš„ç»„åˆé€»è¾‘ï¼šå‘é‡é¡ºåºç¿»è½¬\n\n**é¢˜ç›®æè¿°**ï¼š\n\nç»™å®šä¸€ä¸ª100ä½çš„è¾“å…¥å‘é‡ï¼Œç¿»è½¬å®ƒçš„ä½é¡ºåºã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module( \n    input [99:0] in,\n    output [99:0] out\n);\n    integer i;\n    always @(*) begin\n        for(i=0;i<100;i++) begin\n            out[i]=in[99-i];\n        end\n    end\nendmodule\n```\n\n------\n\n## forå¾ªç¯çš„ç»„åˆé€»è¾‘ï¼š255bitçš„æ•°1æ“ä½œ\n\n**é¢˜ç›®æè¿°**ï¼š\n\nâ€œè®¡æ•°â€ç”µè·¯å¯¹è¾“å…¥å‘é‡ä¸­çš„1è¿›è¡Œè®¡æ•°ã€‚ä¸ºä¸€ä¸ª255ä½è¾“å…¥å‘é‡å»ºç«‹ä¸€ä¸ªâ€œè®¡æ•°â€ç”µè·¯ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module( \n    input [254:0] in,\n    output [7:0] out );\n    \n    integer i;\n    always @(*) begin\n        out = 8'd0;\n        for(i=0;i<255;i++) begin\n            out = out + in[i];\n        end\n    end\nendmodule\n```\n\né”å­˜å™¨ä¼šå¯¹ç”µè·¯äº§ç”Ÿå“ªäº›å½±å“å‘¢ï¼Ÿ\n\n1. é”å­˜å™¨å¯¹æ¯›åˆºæ•æ„Ÿï¼Œæ— å¼‚æ­¥å¤ä½ç«¯ï¼Œä¸èƒ½è®©èŠ¯ç‰‡åœ¨ä¸Šç”µæ—¶å¤„åœ¨ç¡®å®šçš„çŠ¶æ€ï¼›\n2. é”å­˜å™¨ä¼šä½¿é™æ€æ—¶åºåˆ†æå˜å¾—å¾ˆå¤æ‚ï¼Œä¸åˆ©äºè®¾è®¡çš„å¯é‡ç”¨ã€‚\n\næ‰€ä»¥ï¼Œåœ¨ASICè®¾è®¡ä¸­ï¼Œé™¤äº†CPUé«˜é€Ÿç”µè·¯ï¼Œæˆ–è€…RAMè¿™ç§å¯¹é¢ç§¯å¾ˆæ•æ„Ÿçš„ç”µè·¯ï¼Œä¸€èˆ¬ä¸æå€¡ç”¨é”å­˜å™¨ã€‚\n\n------\n\n## å¾ªç¯ç”Ÿæˆè¯­å¥\n\ntipsï¼šVerilogä¸­çš„generateè¯­å¥å¸¸ç”¨äºç¼–å†™å¯é…ç½®çš„ã€å¯ç»¼åˆçš„RTLçš„è®¾è®¡ç»“æ„ã€‚å®ƒå¯ç”¨äºåˆ›å»ºæ¨¡å—çš„å¤šä¸ªå®ä¾‹åŒ–ï¼Œæˆ–è€…æœ‰æ¡ä»¶çš„å®ä¾‹åŒ–ä»£ç å—ã€‚\n\ngenerateå¾ªç¯çš„è¯­æ³•ä¸forå¾ªç¯è¯­å¥çš„è¯­æ³•å¾ˆç›¸ä¼¼ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨æ—¶å¿…é¡»å…ˆåœ¨**genvar**å£°æ˜ä¸­å£°æ˜å¾ªç¯ä¸­ä½¿ç”¨çš„ç´¢å¼•å˜é‡åï¼Œç„¶åæ‰èƒ½ä½¿ç”¨å®ƒã€‚**genvar**å£°æ˜çš„ç´¢å¼•å˜é‡è¢«ç”¨ä½œæ•´æ•°ç”¨æ¥åˆ¤æ–­generateå¾ªç¯ã€‚**genvar**å£°æ˜å¯ä»¥æ˜¯generateç»“æ„çš„å†…éƒ¨æˆ–å¤–éƒ¨åŒºåŸŸï¼Œå¹¶ä¸”ç›¸åŒçš„å¾ªç¯ç´¢å¼•å˜é‡å¯ä»¥åœ¨å¤šä¸ªgenerateå¾ªç¯ä¸­ï¼Œåªè¦è¿™äº›ç¯ä¸åµŒå¥—ã€‚genvaråªæœ‰åœ¨å»ºæ¨¡çš„æ—¶å€™æ‰ä¼šå‡ºç°ï¼Œåœ¨ä»¿çœŸæ—¶å°±å·²ç»æ¶ˆå¤±äº†ã€‚\n\nVerilogä¸­generateå¾ªç¯ä¸­çš„generateå—å¯ä»¥å‘½åä¹Ÿå¯ä»¥ä¸å‘½åã€‚å¦‚æœå·²å‘½åï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªgenerateå—å®ä¾‹æ•°ç»„ã€‚å¦‚æœæœªå‘½åï¼Œåˆ™æœ‰äº›ä»¿çœŸå·¥å…·ä¼šå‡ºç°è­¦å‘Šï¼Œå› æ­¤ï¼Œ**æœ€å¥½å§‹ç»ˆå¯¹å®ƒä»¬è¿›è¡Œå‘½åã€‚**\n\n**é¢˜ç›®æè¿°1**ï¼š\n\né€šè¿‡å®ä¾‹åŒ–100ä¸ªå…¨åŠ æ³•å™¨ï¼Œåˆ›å»ºä¸€ä¸ª100ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨ã€‚\n\n**Solution1**ï¼š\n\n```verilog\nmodule top_module( \n    input [99:0] a, b,\n    input cin,\n    output [99:0] cout,\n    output [99:0] sum );\n\tgenvar i;\n    generate\n        for(i=0;i<100;i++) begin:adder\n            if(i==0)\n                assign{cout[0],sum[0]}=a[0]+b[0]+cin;\n            else\n                assign{cout[i],sum[i]}=a[i]+b[i]+cout[i-1];\n        end           \n    endgenerate\nendmodule\n```\n\n**é¢˜ç›®æè¿°2**ï¼š\n\nä¸ºæ‚¨æä¾›äº†ä¸€ä¸ªåä¸ºbcd_faddçš„BCDä¸€ä½åŠ æ³•å™¨ï¼Œå®ƒçš„è¾“å…¥ä¸ºä¸¤ä¸ªBCDæ•°å­—å’Œè¿›ä½è¾“å…¥ä¿¡å·ï¼Œå¹¶ç”Ÿæˆæ±‚å’Œè¾“å‡ºå’Œè¿›ä½è¾“å‡ºä¿¡å·ã€‚\n\n```verilog\nmodule bcd_fadd {\n    input [3:0] a,\n    input [3:0] b,\n    input     cin,\n    output   cout,\n    output [3:0] sum );\n```\n\nå®ä¾‹åŒ–bcd_faddçš„100ä¸ªå‰¯æœ¬ï¼Œä»¥åˆ›å»ºä¸€ä¸ª100ä½çš„BCDè¡Œæ³¢è¿›ä½åŠ æ³•å™¨ã€‚\n\n**Solution2**ï¼š\n\n```verilog\nmodule top_module( \n    input [399:0] a, b,\n    input cin,\n    output cout,\n    output [399:0] sum );\n    wire [99:0] cout_temp;\n\tgenvar i;\n    generate\n        for(i=0;i<100;i++) begin:bcd_fadd\n            if(i == 0)\n                bcd_fadd bcd_inst(a[3:0],b[3:0],cin,cout_temp[0],sum[3:0]);\n            else\n                bcd_fadd bcd_inst(a[4*i+3:4*i],b[4*i+3:4*i],cout_temp[i-1],cout_temp[i],sum[4*i+3:4*i]);\n        end\n        assign cout=cout_temp[99];\n    endgenerate\nendmodule\n```\n\n------\n\n## æ€»ç»“\n\næœ¬èŠ‚è®¾è®¡å¤§é‡çš„è®¾è®¡æŠ€å·§ï¼Œå¦‚forå¾ªç¯çš„å·§ç”¨ï¼Œæ‰¹é‡è¿›è¡Œä¾‹ç¨‹çš„ä¾‹åŒ–ï¼Œè¿™äº›å¯ä»¥åœ¨è®¾è®¡è¿‡ç¨‹ä¸­ç®€åŒ–å·¥ä½œé‡ã€‚\n\n","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(4)_å¦‚ä½•é¿å…ç”Ÿæˆé”å­˜å™¨","url":"/2022/09/03/IC/HDLBits/HDLBitsç­”æ¡ˆ(4)_å¦‚ä½•é¿å…ç”Ÿæˆé”å­˜å™¨/","content":"\n# HDLBits_Verilog Language_Procedures\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## ç»„åˆé€»è¾‘çš„alwayså—\n\ntipsï¼šè€ƒè™‘åˆ°ç¡¬ä»¶çš„å¯ç»¼åˆæ€§ï¼Œæœ‰ä¸¤ç§alwayså—æ˜¯æœ‰æ„ä¹‰çš„ï¼š\n\n- ç»„åˆï¼š`always @(*)`\n- æ—¶åºï¼š`always @(posedge clk)`\n\nç»„åˆé€»è¾‘çš„alwayså—å’Œassignèµ‹å€¼æ˜¯ç­‰ä»·çš„ï¼Œä½¿ç”¨å“ªä¸€ç§å®Œå…¨çœ‹å“ªä¸€ç§æ›´æ–¹ä¾¿ã€‚alwayså—å†…å¯æœ‰æ›´ä¸°å¯Œçš„çŠ¶æ€ï¼Œå¦‚if-thenï¼Œcaseç­‰ï¼Œä½†ä¸èƒ½æœ‰è¿ç»­èµ‹å€¼è¯­å¥assignã€‚\n\nå¦‚æœåœ¨alwayså—å†…æŒ‡å®šäº†ç‰¹å®šçš„ä¿¡å·ï¼Œä½†æ²¡æœ‰çš„è¯ï¼Œå’Œalways(*)ç»¼åˆç»“æœç›¸åŒï¼Œæ­¤æ—¶åŠŸèƒ½ä»¿çœŸç»“æœå’Œç¡¬ä»¶ç»“æœå°±æœ‰æ‰€å·®å¼‚ã€‚\n\nassignèµ‹å€¼è¯­å¥çš„å·¦è¾¹ä¸€èˆ¬ä¸ºwireç±»å‹ï¼Œalwayså—ä¸­å·¦è¾¹çš„å˜é‡ä¸€èˆ¬ä¸ºregç±»å‹ã€‚<u>è¿™äº›ç±»å‹ä¸ç¡¬ä»¶ç»¼åˆæ— å…³ï¼Œä»…æ˜¯verilogè¯­æ³•çš„è¦æ±‚ã€‚</u>\n\n**é¢˜ç›®æè¿°**ï¼š\n\nä½¿ç”¨èµ‹å€¼è¯­å¥å’Œç»„åˆalwayså—ä¸¤ç§æ–¹å¼æ„å»ºä¸é—¨ã€‚\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module(\n    input a, \n    input b,\n    output wire out_assign,\n    output reg out_alwaysblock\n);\n    assign out_assign = a & b;\n    always @(*) begin\n        out_alwaysblock = a & b; \n    end\nendmodule\n```\n\n------\n\n## æ—¶åºé€»è¾‘çš„alwayså—\n\ntipsï¼šæ—¶åºalwayså—å¯åƒç»„åˆalwayså—é‚£æ ·ç”Ÿæˆç”µè·¯ï¼ŒåŒæ—¶ä¹Ÿä¼šç”Ÿæˆä¸€ç³»åˆ—çš„è§¦å‘å™¨ï¼Œå¯„å­˜å™¨ç­‰ï¼Œå› ä¸ºè¾“å‡ºè¦ç­‰åˆ°ä¸‹ä¸ªæ—¶é’Ÿå»¶æ‰èƒ½è¾“å‡ºã€‚\n\n**é˜»å¡èµ‹å€¼ vs éé˜»å¡èµ‹å€¼**\n\nverilogä¸­æœ‰ä¸‰ç§èµ‹å€¼æ–¹å¼ï¼š\n\n- è¿ç»­èµ‹å€¼(assign x=y;)ï¼Œåªèƒ½åœ¨alwayså—å¤–ä½¿ç”¨ã€‚\n- é˜»å¡èµ‹å€¼(x=y;)ï¼Œåªèƒ½åœ¨alwayså—å†…ä½¿ç”¨ã€‚\n- éé˜»å¡èµ‹å€¼(x<=y;)åªèƒ½åœ¨alwayså—å†…ä½¿ç”¨ã€‚\n\nåœ¨**ç»„åˆé€»è¾‘**çš„alwayså—ä¸­(always @(*))ä½¿ç”¨**é˜»å¡èµ‹å€¼**è¯­å¥ï¼›\n\nåœ¨**æ—¶åºé€»è¾‘**çš„alwayså—ä¸­(always @(posedge clk))ä½¿ç”¨**éé˜»å¡èµ‹å€¼**è¯­å¥ã€‚\n\n**é¢˜ç›®æè¿°**ï¼š\n\nä½¿ç”¨èµ‹å€¼è¯­å¥ã€ç»„åˆalwayså—å’Œæ—¶åºalwayså—ä¸‰ç§æ–¹å¼æ„å»ºä¸€ä¸ªå¼‚æˆ–é—¨ã€‚\n\n**Solution**:\n\n```verilog\nmodule top_module(\n    input clk,\n    input a,\n    input b,\n    output wire out_assign,\n    output reg out_always_comb,\n    output reg out_always_ff   );\n\tassign out_assign = a ^ b;\n    always @(*) begin\n        out_always_comb = a ^ b;\n    end\n    always @(posedge clk) begin\n        out_always_ff <= a ^ b;\n    end\nendmodule\n```\n\n------\n\n## IFé€‰æ‹©å™¨\n\ntipsï¼šä¸€ä¸ªifè¯­å¥ä¼šäº§ç”Ÿä¸€ä¸ª2é€‰1çš„æ•°æ®é€‰æ‹©å™¨ï¼Œéœ€æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯ifé€‰æ‹©çš„é‚£è·¯æ•°æ®æ‰è¢«å®ç°æˆç”µè·¯æ¨¡å¼ï¼Œè€Œæ˜¯ifå’Œelseä¸¤è·¯éƒ½è¢«å®ç°ä¸ºç”µè·¯å½¢å¼ç„¶åç”¨é€‰æ‹©å™¨é€‰æ‹©è¾“å‡ºã€‚\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232147733.png)\n\nifçš„ä¸¤ç§æ–¹å¼ï¼š\n\n```verilog\nalways @(*) begin\n    if (condition) begin\n        out = x;\n    end\n    else begin\n        out = y;\n    end\nend\n```\n\n```verilog\nassign out = (condition) ? x : y;\n```\n\n**é¢˜ç›®æè¿°**ï¼š\n\n2-1é€‰æ‹©å™¨\n\n| sel_b1 | sel_b2 | out_assign/out_always |\n| :----: | :----: | :-------------------: |\n|   0    |   0    |           a           |\n|   0    |   1    |           a           |\n|   1    |   0    |           a           |\n|   1    |   1    |           b           |\n\n**Solution**:\n\n```verilog\nmodule top_module(\n    input a,\n    input b,\n    input sel_b1,\n    input sel_b2,\n    output wire out_assign,\n    output reg out_always   ); \n    assign out_assign=(sel_b1&sel_b2)?b:a;\n    always @(*) begin\n        if(sel_b2&sel_b1) begin\n            out_always = b;\n        end\n        else begin\n            out_always = a;\n        end\n    end\nendmodule\n```\n\n------\n\n## IFä¸­é”å­˜å™¨é—®é¢˜\n\ntipsï¼šå¦‚ä½•é¿å…åœ¨ä½¿ç”¨ifè¯­å¥æ—¶ç”Ÿæˆé”å­˜å™¨ï¼Ÿ\n\n**tip**ï¼šé”å­˜å™¨ä¸è§¦å‘å™¨çš„åŒºåˆ«ï¼Ÿ\n\n- **é”å­˜å™¨æ˜¯ä¸€ç§å¯¹è„‰å†²ç”µå¹³ï¼ˆä¹Ÿå°±æ˜¯0æˆ–è€…1ï¼‰æ•æ„Ÿçš„å­˜å‚¨å•å…ƒç”µè·¯ï¼Œè€Œè§¦å‘å™¨æ˜¯ä¸€ç§å¯¹è„‰å†²è¾¹æ²¿ï¼ˆå³ä¸Šå‡æ²¿æˆ–è€…ä¸‹é™æ²¿ï¼‰æ•æ„Ÿçš„å­˜å‚¨ç”µè·¯ã€‚**\n\nå½“æˆ‘ä»¬åœ¨è®¾è®¡ç”µè·¯æ—¶ï¼Œä¸èƒ½ç›´æ¥å…ˆå†™æˆä»£ç ç„¶åæœŸæœ›å®ƒç›´æ¥ç”Ÿæˆä¸ºåˆé€‚çš„ç”µè·¯ï¼Œå¦‚ä¸‹å…¸å‹é”™è¯¯æ‰€ç¤ºï¼š\n\n- If (cpu_overheated) then shut_off_computer = 1;\n- If (~arrived) then keep_driving = ~gas_tank_empty;\n\nè¯­æ³•ä¸Šæ­£ç¡®çš„ä»£ç å¹¶ä¸æ„å‘³ç€è®¾è®¡æˆçš„ç”µè·¯ä¹Ÿæ˜¯åˆç†çš„ã€‚æˆ‘ä»¬æ¥æ€è€ƒè¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä¸Šå›¾çš„é”™è¯¯ç¤ºä¾‹ï¼Œå¦‚æœifæ¡ä»¶ä¸æ»¡è¶³ï¼Œè¾“å‡ºå¦‚ä½•å˜åŒ–å‘¢ï¼ŸVerilogç»™å‡ºçš„è§£å†³æ–¹æ³•æ˜¯ï¼šä¿æŒè¾“å‡ºä¸å˜ã€‚å› ä¸ºç»„åˆé€»è¾‘ç”µè·¯ä¸èƒ½è®°å½•å½“å‰çš„çŠ¶æ€ï¼Œæ‰€ä»¥å°±ä¼šç»¼åˆå‡ºé”å­˜å™¨ã€‚\n\næ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨ifè¯­å¥æˆ–è€…caseè¯­å¥æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»è€ƒè™‘åˆ°æ‰€æœ‰æƒ…å†µå¹¶ç»™å¯¹åº”æƒ…å†µçš„è¾“å‡ºè¿›è¡Œèµ‹å€¼ï¼Œå°±æ„å‘³ç€æˆ‘ä»¬è¦ä¸ºelseæˆ–è€…defaultä¸­çš„è¾“å‡ºèµ‹å€¼ã€‚\n\n**é¢˜ç›®æè¿°**ï¼šæ‰¾BUGï¼Œè§£å†³ä¸‹é¢çš„ä»£ç ä¸­åŒ…å«çš„åˆ›å»ºé”å­˜çš„ä¸æ­£ç¡®è¡Œä¸ºã€‚\n\n```verilog\nalways @(*) begin\n    if (cpu_overheated)\n       shut_off_computer = 1;\nend\n\nalways @(*) begin\n    if (~arrived)\n       keep_driving = ~gas_tank_empty;\nend\n```\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232148960.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input      cpu_overheated,\n    output reg shut_off_computer,\n    input      arrived,\n    input      gas_tank_empty,\n    output reg keep_driving  );\n\n    always @(*) begin\n        if (cpu_overheated) begin\n           shut_off_computer = 1;\n        end\n        else begin\n            shut_off_computer = 0;\n        end\n    end\n\n    always @(*) begin\n        if (~arrived) begin\n           keep_driving = ~gas_tank_empty;\n        end\n        else begin\n           keep_driving = 0;\n        end\n    end\n    \nendmodule\n```\n\n------\n\n## Caseè¯­å¥\n\ntipsï¼šåœ¨Verilogä¸­ï¼Œcaseè¯­å¥ä¸if-elseif-elseç›¸è¿‘ï¼Œä¸cè¯­è¨€ä¸­çš„switchå·®åˆ«è¾ƒå¤§ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š\n\n```verilog\nalways @(*) begin     // This is a combinational circuit\n    case (in)\n      1'b1: begin \n               out = 1'b1;  // begin-end if statement >1\n            end\n      1'b0: out = 1'b0;\n      default: out = 1'bx;\n    endcase\nend\n```\n\n- caseè¯­å¥ä»¥caseå¼€å§‹ï¼Œæ¯ä¸ªcaseçš„é€‰é¡¹ä»¥åˆ†å·ç»“æŸã€‚\n- æ¯ä¸ªcaseçš„é€‰é¡¹ä¸­åªèƒ½æ‰§è¡Œä¸€ä¸ªstatementï¼Œæ‰€ä»¥å°±æ— éœ€breakè¯­å¥ã€‚ä½†å¦‚æœæˆ‘ä»¬æƒ³åœ¨ä¸€ä¸ªcaseé€‰é¡¹ä¸­æ‰§è¡Œå¤šä¸ªstatementï¼Œå°±éœ€è¦ä½¿ç”¨`begin...end`\n- caseä¸­å¯ä»¥æœ‰é‡å¤çš„case itemï¼Œé¦–æ¬¡åŒ¹é…çš„å°†ä¼šè¢«æ‰§è¡Œã€‚\n\n**é¢˜ç›®æè¿°**ï¼š6-1æ•°æ®é€‰æ‹©å™¨\n\n*Be careful of inferring latchesï¼*(éœ€æ·»åŠ Default)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module ( \n    input [2:0] sel, \n    input [3:0] data0,\n    input [3:0] data1,\n    input [3:0] data2,\n    input [3:0] data3,\n    input [3:0] data4,\n    input [3:0] data5,\n    output reg [3:0] out   );//\n\n    always@(*) begin  // This is a combinational circuit\n        case(sel)\n            3'b000:out=data0;\n            3'b001:out=data1;\n            3'b010:out=data2;\n            3'b011:out=data3;\n            3'b100:out=data4;\n            3'b101:out=data5;\n            default:out=3'b0;\n        endcase\n    end\n\nendmodule\n```\n\n------\n\n## ä¼˜å…ˆç¼–ç å™¨\n\n**é¢˜ç›®æè¿°**ï¼šä¼˜å…ˆç¼–ç å™¨æ˜¯ä¸€ç§ç»„åˆç”µè·¯ï¼Œå½“ç»™å®šè¾“å…¥ä½å‘é‡æ—¶ï¼Œè¾“å‡ºè¯¥å‘é‡ä¸­ç¬¬ä¸€ä¸ª1çš„ä½ç½®ã€‚ ä¾‹å¦‚ï¼Œç»™å®šè¾“å…¥8'b10010000çš„8ä½ä¼˜å…ˆçº§ç¼–ç å™¨å°†è¾“å‡º3'd4ï¼Œå› ä¸ºbit [4]æ˜¯é«˜çš„ç¬¬ä¸€ä½ã€‚\n\næ„å»ºä¸€ä¸ª4ä½ä¼˜å…ˆçº§ç¼–ç å™¨ã€‚ å¯¹äºæ­¤é—®é¢˜ï¼Œå¦‚æœæ‰€æœ‰è¾“å…¥ä½éƒ½ä¸ä¸ºé«˜ï¼ˆå³è¾“å…¥ä¸ºé›¶ï¼‰ï¼Œåˆ™è¾“å‡ºé›¶ã€‚ è¯·æ³¨æ„ï¼Œä¸€ä¸ª4ä½æ•°å­—å…·æœ‰16ç§å¯èƒ½çš„ç»„åˆã€‚\n\n**Solution**ï¼š\n\n1ã€æ ¹æ®æƒ¯æ€§æ€ç»´ä½¿ç”¨caseè¯­æ³•ï¼Œåˆ—å‡ºæ¯ä¸€ç§æƒ…å†µï¼Œç„¶ååˆ—å‡ºå…¶å¯¹åº”çš„è¾“å‡ºã€‚\n\n```verilog\ncase(input)\n\n4'b0001: output = 1;\n\n.......\n\n4'b1111:output = 1;\n\ndefault: output = 0;\n\nendcase\n```\n\n2ã€å¦‚æœæŒ‰ä¸Šè¿°æ€è·¯æ¥å†™ï¼Œé‚£ä¹ˆæ›´å¤šä½çš„ä¼˜å…ˆç¼–ç å™¨å¦‚ä½•å®ç°å‘¢ï¼Ÿå…¶å®æœ‰æ›´ç®€å•çš„æ–¹æ³•ï¼Œç›®å‰æ—¢ä¸ç”¨casexä¹Ÿä¸ç”¨casezï¼Œè¿™ä¸¤ä½è¦åœ¨åé¢å‡ºåœºã€‚æ¥çœ‹å¦ä¸€ç§æ€è·¯ï¼š\n\n```verilog\nmodule top_module (\n    input [3:0] in,\n    output reg [1:0] pos  );\n    always @(*) begin\n        case(1)\n            in[0]:pos = 0;\n            in[1]:pos = 1;\n            in[2]:pos = 2;\n            in[3]:pos = 3;\n            default:pos = 0;\n        endcase\n    end\nendmodule\n```\n\næ ¹æ®ä¸Šé¢æ‰€è¯´çš„caseçš„æ€§è´¨ï¼Œcaseä¸­å¯ä»¥æœ‰é‡å¤çš„case itemï¼Œä½†é¦–æ¬¡åŒ¹é…çš„æ‰ä¼šè¢«æ‰§è¡Œã€‚å†çœ‹ä¸Šé¢çš„caseè¯­å¥ï¼Œå³ä»ä½åˆ°é«˜ä½å»æ¯”è¾ƒinä¸­æ˜¯å¦æœ‰æ•°æ®ä½ä¸º1ï¼Œä¸‹é¢å³ä½¿æœ‰é‡å¤ä¸º1çš„ä¹Ÿåªä¼šæ‰§è¡Œé¦–æ¬¡åŒ¹é…çš„æ“ä½œã€‚å¦‚æ­¤ï¼ŒNä½ä¼˜å…ˆç¼–ç å™¨åªéœ€è¦Nä¸ªcaseåˆ†æ”¯å³å¯ï¼Œå¤§å¤§ç®€åŒ–ä»£ç é‡ã€‚\n\n------\n\n## casezå®ç°ä¼˜å…ˆç¼–ç å™¨\n\n**é¢˜ç›®æè¿°**ï¼š\n\nä¸º8ä½è¾“å…¥æ„å»ºä¼˜å…ˆçº§ç¼–ç å™¨ã€‚å½“ç»™å®šè¾“å…¥ä½å‘é‡æ—¶ï¼Œè¾“å‡ºè¯¥å‘é‡ä¸­ç¬¬ä¸€ä¸ª1çš„ä½ç½®ã€‚å¦‚æœè¾“å…¥å‘é‡æ²¡æœ‰é«˜ä½ï¼Œåˆ™æŠ¥å‘Šä¸ºé›¶ã€‚ ä¾‹å¦‚ï¼Œç»™å®šè¾“å…¥8'b10010000çš„8ä½ä¼˜å…ˆçº§ç¼–ç å™¨å°†è¾“å‡º3'd4ï¼Œå› ä¸ºbit [4]æ˜¯é«˜çš„ç¬¬ä¸€ä½ã€‚\n\ntipsï¼šç”±ä¸Šä¸€ä¸ªç»ƒä¹ æˆ‘ä»¬çŸ¥é“ï¼Œcaseè¯­å¥ä¸­å°†æœ‰256ç§case itemï¼Œä½¿ç”¨casezä»¥åï¼Œæˆ‘ä»¬å¯ä»¥å‡å°‘éœ€æ¯”è¾ƒçš„case itemï¼Œè¿™å°±æ˜¯casezçš„ç›®çš„ï¼Œåœ¨æ¯”è¾ƒä¸­ï¼Œå°†å€¼zçš„ä½è§†ä½œæ— å…³ä½ã€‚\n\næ‰€ä»¥ä¸Šé¢˜çš„å¦ä¸€ç§è§£æ³•ä¸ºï¼š\n\n```verilog\nalways @(*) begin\n    casez (in[3:0])\n        4'bzzz1: out = 0;   // in[3:1] can be anything\n        4'bzz1z: out = 1;\n        4'bz1zz: out = 2;\n        4'b1zzz: out = 3;\n        default: out = 0;\n    endcase\nend\n```\n\ncaseè¯­å¥çš„è¡Œä¸ºå°±å¥½åƒæ˜¯æŒ‰é¡ºåºæ£€æŸ¥æ¯ä¸ªé¡¹ä¸€æ ·(å®é™…ä¸Šï¼Œå®ƒæ‰€åšçš„äº‹æƒ…æ›´åƒæ˜¯ç”Ÿæˆä¸€ä¸ªå·¨å¤§çš„çœŸå€¼è¡¨ï¼Œç„¶åè¿›è¡Œé—¨æ“ä½œ)ã€‚æ³¨æ„æŸäº›è¾“å…¥(ä¾‹å¦‚4â€™b1111)æ˜¯å¦‚ä½•åŒ¹é…å¤šä¸ªcaseé¡¹çš„ã€‚é€‰æ‹©ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹(å› æ­¤4'b1111åŒ¹é…ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œout = 0ï¼Œä½†ä¸åŒ¹é…åé¢çš„ä»»ä½•é¡¹ç›®)ã€‚\n\n- è¿˜æœ‰ç±»ä¼¼çš„`casex`ï¼Œå®ƒå°†xå’Œzå‡æ— è§†æ‰ã€‚\n- ç¬¦å·?æ˜¯zçš„åŒä¹‰è¯ï¼Œæ‰€ä»¥2â€˜bz0=2'b?0\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [7:0] in,\n    output reg [2:0] pos  );\n    always @(*) begin\n        casez(in)\n            8'bzzzzzzz1:pos=0;\n            8'bzzzzzz1z:pos=1;\n            8'bzzzzz1zz:pos=2;\n            8'bzzzz1zzz:pos=3;\n            8'bzzz1zzzz:pos=4;\n            8'bzz1zzzzz:pos=5;\n            8'bz1zzzzzz:pos=6;\n            8'b1zzzzzzz:pos=7;\n            default:pos=0;\n        endcase\n    end\nendmodule\n```\n\nè¯¥é¢˜ä¹Ÿå¯ä»¥æŒ‰Priority encoderä¸­çš„è§£æ³•2æ¥å†™ï¼Œå¤æ‚åº¦ç”šè‡³æ›´ä½ã€‚\n\n------\n\n## å»é”å­˜å™¨\n\n**é¢˜ç›®æè¿°**ï¼š\n\nå‡è®¾æ„å»ºä¸€ä¸ªç”µè·¯æ¥å¤„ç†æ¸¸æˆçš„PS/2é”®ç›˜ä¸Šçš„æ‰«æä»£ç ã€‚å¯¹äºæ”¶åˆ°çš„æœ€åä¸¤ä¸ªå­—èŠ‚çš„æ‰«æç ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡ç¤ºæ˜¯å¦æŒ‰ä¸‹äº†é”®ç›˜ä¸Šçš„ä¸€ä¸ªæ–¹å‘é”®ã€‚è¿™æ¶‰åŠåˆ°ä¸€ä¸ªç›¸å½“ç®€å•çš„æ˜ å°„ï¼Œå®ƒå¯ä»¥å®ç°ä¸ºä¸€ä¸ªcaseè¯­å¥(æˆ–if-elseif)ï¼ŒåŒ…å«å››ä¸ªcaseã€‚\n\nç”µè·¯æœ‰ä¸€ä¸ª16ä½è¾“å…¥å’Œå››ä¸ªè¾“å‡ºã€‚å»ºç«‹èƒ½è¯†åˆ«è¿™å››ç§æ‰«æç å¹¶æ­£ç¡®è¾“å‡ºçš„ç”µè·¯ã€‚\n\n| Scancode[15:0] |  Arrow key  |\n| :------------: | :---------: |\n|    16'he06b    | left arrow  |\n|    16'he072    | down arrow  |\n|    16'he074    | right arrow |\n|    16'he075    |  up arrow   |\n| Anything else  |    none     |\n\ntipsï¼šä¸ºé¿å…ç”Ÿæˆé”å­˜å™¨ï¼Œæ‰€æœ‰çš„è¾“å…¥æƒ…å†µå¿…é¡»è¦è¢«è€ƒè™‘åˆ°ã€‚ä½†ä»…æœ‰ä¸€ä¸ªç®€å•çš„defaultæ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨case itemå’Œdefaultä¸­ä¸º4ä¸ªè¾“å‡ºè¿›è¡Œèµ‹å€¼ï¼Œè¿™ä¼šå¯¼è‡´å¾ˆå¤šä¸å¿…è¦çš„ä»£ç ç¼–å†™ã€‚\n\nä¸€ç§ç®€å•çš„æ–¹å¼å°±æ˜¯**å¯¹è¾“å‡ºå…ˆè¿›è¡Œèµ‹åˆå€¼çš„æ“ä½œ**ï¼Œè¿™ç§ç±»å‹çš„ä»£ç ç¡®ä¿åœ¨æ‰€æœ‰å¯èƒ½çš„æƒ…å†µä¸‹è¾“å‡ºéƒ½è¢«èµ‹å€¼ï¼Œé™¤écaseè¯­å¥è¦†ç›–äº†èµ‹å€¼ã€‚è¿™ä¹Ÿæ„å‘³ç€ä¸å†éœ€è¦ç¼ºçœçš„defaulté¡¹ã€‚å¦‚ä¸‹é¢ç¤ºä¾‹ä»£ç ï¼š\n\n```verilog\nalways @(*) begin\n    up = 1'b0; down = 1'b0; left = 1'b0; right = 1'b0;\n    case (scancode)\n        ... // Set to 1 as necessary.\n    endcase\nend\n```\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [15:0] scancode,\n    output reg left,\n    output reg down,\n    output reg right,\n    output reg up  ); \n    always @(*) begin\n        left=0;down=0;right=0;up=0;\n        case(scancode)\n            16'he06b:left=1;\n            16'he072:down=1;\n            16'he074:right=1;\n            16'he075:up=1;\n        endcase\n    end\nendmodule\n```\n\n------\n\n## æ€»ç»“ï¼š\n\n- å­¦ä¹ äº†ç»„åˆå’Œæ—¶åºä¸¤ç§alwayså—ï¼Œå¹¶çŸ¥æ™“äº†ä¸¤ç§ç±»å‹çš„alwayså—ä¸­å˜é‡çš„ç±»å‹å³èµ‹å€¼æ–¹å¼ã€‚ä½•æ—¶ä½¿ç”¨wireä¸regï¼Œä½•æ—¶ç”¨é˜»å¡å’Œéé˜»å¡èµ‹å€¼ã€‚\n\n- å­¦ä¹ äº†å¦‚ä½•<u>åœ¨ç»„åˆé€»è¾‘ä¸­</u>ä½¿ç”¨ifå’Œcaseè¯­å¥æ—¶**é¿å…ç”Ÿæˆé”å­˜å™¨**ï¼š\n\n  å°†æ‰€æœ‰çŠ¶æ€å‡è€ƒè™‘åˆ°å¹¶ä¸ºå…¶è¾“å‡ºèµ‹å€¼ï¼Œè€ƒè™‘ä¸å…¨å¯ç”¨else/defaultã€‚\n\n  åœ¨caseä¹‹å‰ä¸ºæ‰€æœ‰è¾“å‡ºèµ‹åˆå€¼ï¼Œè¿™æ ·å¯ä»¥ä¸ç”¨ä½¿ç”¨defaultï¼Œé™¤éæ»¡è¶³case itemè¿›è¡Œè¦†ç›–èµ‹å€¼ï¼Œå¦åˆ™ä»ä¿æŒåˆå€¼ã€‚\n\n  <u>æ—¶åºé€»è¾‘ä¸‹ä¸ä¼šç”Ÿæˆé”å­˜å™¨ã€‚</u>\n\n- å­¦ä¹ äº†caseè¯­å¥çš„å¦™ç”¨ï¼Œä»¥åŠä½¿ç”¨casezå¿½ç•¥æ— å…³ä½ï¼Œæ›´ç®€ä¾¿çš„å®ç°ä¼˜å…ˆç¼–ç å™¨ã€‚\n\n\n\n","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(3)_Verilogæ¨¡å—çš„ä¾‹åŒ–ä¸è°ƒç”¨","url":"/2022/09/03/IC/HDLBits/HDLBitsç­”æ¡ˆ(3)_Verilogæ¨¡å—çš„ä¾‹åŒ–ä¸è°ƒç”¨/","content":"\n# HDLBits_Verilogæ¨¡å—çš„ä¾‹åŒ–ä¸è°ƒç”¨\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## æ¨¡å—\n\nåªè¦ä½¿ç”¨çš„æ‰€æœ‰æ¨¡å—éƒ½å±äºåŒä¸€ä¸ªé¡¹ç›®ï¼Œå°±å¯ä»¥é€šè¿‡åœ¨æ¨¡å—å†…éƒ¨å®ä¾‹åŒ–ä¸€ä¸ªæ¨¡å—æ¥åˆ›å»ºæ¨¡å—çš„å±‚æ¬¡ç»“æ„ã€‚ä¸€ä¸ªæ¨¡å—çš„ä»£ç ä¸èƒ½åœ¨å¦ä¸€ä¸ªæ¨¡å—çš„ä¸»ä½“ä¸­ç¼–å†™(ä¸åŒæ¨¡å—çš„ä»£ç ä¸æ˜¯åµŒå¥—çš„)ã€‚\n\næœ‰ä¸¤ç§å¸¸è§çš„æ–¹å¼å°†wireä¿¡å·è¿æ¥åˆ°ç«¯å£ä¸Šï¼Œåˆ†åˆ«æ˜¯æŒ‰ä½ç½®å’ŒæŒ‰åç§°è¿æ¥ã€‚\n\næŒ‰ä½ç½®ï¼š`mod_a instance1 ( wa, wb, wc );`\n\næŒ‰åç§°ï¼š`mod_a instance2 ( .out(wc), .in1(wa), .in2(wb) );`\n\n- By position:` mod_a instance1 ( wa, wb, wc );`\n\n  \n\n**é¢˜ç›®æè¿°**ï¼šå®Œæˆmod_aæ¨¡å—çš„è°ƒç”¨\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module ( input a, input b, output out );\n    mod_a david(.out(out),.in1(a),.in2(b));\nendmodule\n```\n\ntipsï¼šæ¨¡å—è°ƒç”¨ä¸¤ç§æ–¹å¼ï¼šæŒ‰ä½ç½®è°ƒ(ç®€æ´ä½†ä¸ç¨³ï¼Œé¡ºåºä¸å¯ä¹±)ï¼ŒæŒ‰åç§°è°ƒ(ç¹çä½†å¾ˆç¨³ï¼Œé¡ºåºå¯å˜)\n\n------\n\n## æŒ‰ä½ç½®è¿æ¥ç«¯å£\n\n**é¢˜ç›®æè¿°**ï¼š\n\nå·²æœ‰ä¸€ä¸ªåä¸ºmod_açš„æ¨¡å—ï¼Œå®ƒæœ‰2ä¸ªè¾“å‡ºå’Œ4ä¸ªè¾“å…¥ã€‚æ‚¨å¿…é¡»æŒ‰ä½ç½®å°†è¿™6ä¸ªç«¯å£è¿æ¥åˆ°é¡¶å±‚æ¨¡å—çš„ç«¯å£out1ã€out2ã€aã€bã€cå’Œdï¼Œå¹¶æŒ‰é¡ºåºè¿›è¡Œè¿æ¥ã€‚\n\nç»™å®šå¦‚ä¸‹çš„æ¨¡å—:\n\n```verilog\nmodule mod_a ( output, output, input, input, input, input );\n```\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232146270.png)\n\n**Solution**:\n\n```verilog\nmodule top_module ( \n    input a, \n    input b, \n    input c,\n    input d,\n    output out1,\n    output out2\n);\n    mod_a david(out1,out2,a,b,c,d);\nendmodule\n```\n\n------\n\n## æŒ‰åç§°è¿æ¥ç«¯å£\n\n**é¢˜ç›®æè¿°**ï¼šæŒ‰åç§°è°ƒæ¨¡å—mod_a\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232146990.png)\n\n```verilog\nmodule top_module ( \n    input a, \n    input b, \n    input c,\n    input d,\n    output out1,\n    output out2\n);\n    mod_a(.out1(out1),.out2(out2),.in1(a),.in2(b),.in3(c),.in4(d));\nendmodule\n```\n\n------\n\n## ä¸‰ä¸ªæ¨¡å—çš„è°ƒç”¨\n\n**é¢˜ç›®æè¿°**ï¼š\n\nå·²æœ‰ä¸€ä¸ªæ¨¡å—my_dffï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªè¾“å…¥å’Œä¸€ä¸ªè¾“å‡º(Dè§¦å‘å™¨)ã€‚å®ä¾‹åŒ–ä¸‰ä¸ªDè§¦å‘å™¨ç„¶åå°†å®ƒä»¬è¿æ¥åœ¨ä¸€èµ·ï¼Œå®ç°ä¸€ä¸ªé•¿åº¦ä¸º3çš„ç§»ä½å¯„å­˜å™¨ã€‚clkç«¯å£éœ€è¦è¿æ¥åˆ°æ‰€æœ‰my_dffå®ä¾‹ã€‚\n\nå·²æœ‰æ¨¡å—: `module my_dff ( input clk, input d, output q );`\n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232146559.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module ( input clk, input d, output q );\n\twire temp1;\n    wire temp2;\n    my_dff block1(clk,d,temp1);\n    my_dff block2(clk,temp1,temp2);\n    my_dff block3(clk,temp2,q);\nendmodule\n```\n\ntipsï¼šå†…éƒ¨è°ƒç”¨å¤šä¸ªæ¨¡å—æ—¶ï¼Œå®šä¹‰åˆç†çš„wireä¿¡å·è¿æ¥å†…éƒ¨çš„æ¨¡å—ã€‚\n\n------\n\n## æ¨¡å—è¾“å…¥ä¸ºå‘é‡\n\n**é¢˜ç›®æè¿°**ï¼š\n\nå·²æœ‰ä¸€ä¸ªæ¨¡å—my_dff8ï¼Œå®ƒå…·æœ‰ä¸¤ä¸ªè¾“å…¥å’Œä¸€ä¸ªè¾“å‡º(å®ç°ä¸€ç»„8ä½çš„Dè§¦å‘å™¨)ã€‚å®ä¾‹åŒ–å…¶ä¸­çš„ä¸‰ä¸ªï¼Œç„¶åå°†å®ƒä»¬è¿æ¥åœ¨ä¸€èµ·ï¼Œå®ç°ä¸€ä¸ªé•¿åº¦ä¸º3çš„8ä½å®½ç§»ä½å¯„å­˜å™¨ã€‚å¦å¤–ï¼Œæ„é€ ä¸€ä¸ª4-1å¤šè·¯é€‰æ‹©å™¨ï¼Œæ ¹æ®sel[1:0]é€‰æ‹©è¾“å‡ºå€¼ã€‚æœ¬è´¨ä¸Šï¼Œselé€‰æ‹©çš„æ˜¯å»¶è¿Ÿè¾“å…¥çš„å‘¨æœŸã€‚\n\nå·²æœ‰æ¨¡å—: `module my_dff8 ( input clk, input [7:0] d, output [7:0] q );`\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232147248.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module ( \n    input clk, \n    input [7:0] d, \n    input [1:0] sel, \n    output [7:0] q \n);\n    wire [7:0] out1;\n    wire [7:0] out2;\n    wire [7:0] out3;\n    \n    my_dff8 block1(clk,d,out1);\n    my_dff8 block2(clk,out1,out2);\n    my_dff8 block3(clk,out2,out3);\n    \n    always @(*) begin\n        case(sel)\n            2'b00:\n                q=d;\n            2'b01:\n                q=out1;                \n            2'b10:\n                q=out2;                \n            2'b11:\n                q=out3;                \n        endcase\n    end\nendmodule\n```\n\ntipsï¼šç»„åˆé€»è¾‘ç”¨éé˜»å¡èµ‹å€¼è¿æ¥å³å¯ã€‚\n\n------\n\n## åŠ æ³•å™¨æ¨¡å—1\n\n**é¢˜ç›®æè¿°**ï¼šç”¨ä¸¤ä¸ªå¸¦è¿›ä½çš„16bitåŠ æ³•å™¨ç»„æˆä¸€ä¸ª32bitåŠ æ³•å™¨ã€‚\n\n`module add16 (input[15:0] a, input[15:0] b, input cin, output[15:0] sum, output cout);`\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232147719.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module(\n    input [31:0] a,\n    input [31:0] b,\n    output [31:0] sum\n);\n    wire [15:0] low_out;\n    wire [15:0] high_out;\n    wire temp_cout;\n    wire cout;\n    \n    add16 low (a[15:0],b[15:0],0,low_out,temp_cout);\n    add16 high(a[31:16],b[31:16],temp_cout,high_out,cout);\n    \n    assign sum={high_out,low_out};    \nendmodule\n```\n\ntipsï¼šæ³¨æ„é‡‡ç”¨æµæ‹¼æ¥ç®€åŒ–ä»£ç ï¼Œæ— ç”¨ä¿¡å·æ¥å£ä½œä¸ºè¾“å‡ºä¹Ÿå¯ä»¥ä¸è¿›è¡Œç®¡è„šä¿¡å·çš„å®šä¹‰ã€‚\n\n------\n\n## åŠ æ³•å™¨æ¨¡å—2\n\n**é¢˜ç›®æè¿°**ï¼š\n\nè‡ªå®šä¹‰ä¸€ä¸ª1bitçš„å…¨åŠ å™¨ï¼Œæ„æˆä¸€ä¸ª16bitå…¨åŠ å™¨ï¼Œç„¶åç”¨ä¸¤ä¸ª16bitå…¨åŠ å™¨å®Œæˆ32bitåŠ æ³•æ¨¡å—çš„æ­å»ºï¼Œå¿½ç•¥è¿›ä½ã€‚\n\n1ã€å®šä¹‰ä¸€ä¸ª1bitå…¨åŠ å™¨ã€‚2ã€åœ¨é¡¶å±‚å®Œæˆä¸¤ä¸ª16bitå…¨åŠ å™¨çš„è°ƒç”¨ã€‚\n\n![6](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232147068.png)\n\n**Solution**ï¼š\n\n```verilog\nmodule top_module (\n    input [31:0] a,\n    input [31:0] b,\n    output [31:0] sum\n);\n    wire temp_cout;\n  \n    add16 low (a[15:0],b[15:0],0,sum[15:0],temp_cout);\n    add16 high(a[31:16],b[31:16],temp_cout,sum[31:16]);\nendmodule\n\nmodule add1 ( input a, input b, input cin,   output sum, output cout );\n    assign {cout,sum} = a + b + cin;\nendmodule\n```\n\n------\n\n## è¿›ä½é€‰æ‹©åŠ æ³•å™¨\n\n**é¢˜ç›®æè¿°**ï¼š\n\nåœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œå·²æœ‰å’Œä¸Šä¸€ä¸ªç»ƒä¹ ç›¸åŒçš„æ¨¡å—add16ï¼Œæœ¬é¢˜å°†ä¸¤ä¸ªå¸¦è¿›ä½çš„16ä½æ•°å­—ç›¸åŠ ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªè¾“å‡ºè¿›ä½å’Œ16ä½çš„å’Œã€‚éœ€æ„é€ ä¸€ä¸ª16ä½2-1å¤šè·¯é€‰æ‹©å™¨ã€‚\n\n`module add16 ( input[15:0] a, input[15:0] b, input cin, output[15:0] sum, output cout );`\n\n![7](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232147602.png)\n\ntipsï¼šæå‰è®¡ç®—åŠ æ³•å™¨çš„è¿›ä½ï¼Œç”¨èµ„æºæ¢é€Ÿåº¦ã€‚\n\n**Solution**:\n\n```verilog\nmodule top_module(\n    input [31:0] a,\n    input [31:0] b,\n    output [31:0] sum\n);\n    wire [15:0] highout0;\n    wire [15:0] highout1;\n    wire cout;\n    \n    add16 low(a[15:0],b[15:0],0,sum[15:0],cout);\n    add16 high0(a[31:16],b[31:16],0,highout0);\n    add16 high1(a[31:16],b[31:16],1,highout1);\n    \n    assign sum[31:16]=cout? highout1:highout0;\nendmodule\n```\n\n------\n\n## åŠ æ³•å™¨â†’å‡æ³•å™¨\n\n**é¢˜ç›®æè¿°**ï¼šåˆ©ç”¨subä¿¡å·å’Œä¸¤ä¸ª16bitçš„å…¨åŠ å™¨ï¼Œå®ç°32bitçš„åŠ å‡æ³•è¿ç®—ã€‚\n\nå¯¹è¾“å…¥çš„subä¿¡å·è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœsub=0ï¼Œåˆ™è¾“å‡º(a + b + 0)ï¼›å¦‚æœsub=1ï¼Œåˆ™è¾“å‡º(a + ~b + 1)ã€‚\n\nå·²æœ‰æ¨¡å—ï¼š\n\n`module add16 ( input[15:0] a, input[15:0] b, input cin, output[15:0]sum, output cout );`\n\ntip: **Use a 32-bit wide XOR gate to invert the `b` input whenever `sub` is 1.** \n\n![8](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232147120.png)\n\n**Solution**:\n\n```verilog\nmodule top_module(\n    input [31:0] a,\n    input [31:0] b,\n    input sub,\n    output [31:0] sum\n);\n    wire [31:0] b_processed;\n    wire cout_temp;\n    assign b_processed = b ^ {32{sub}};\n    \n    add16 lower(a[15:0],b_processed[15:0],sub,sum[15:0],cout_temp);\n    add16 higher(a[31:16],b_processed[31:16],cout_temp,sum[31:16]);\nendmodule\n```\n\ntipsï¼šå·§ç”¨subä¿¡å·å¯¹è¾“å…¥bå¤„ç†ï¼Œå¦™ï¼\n\n------\n\n## æ€»ç»“ï¼š\n\nå­¦ä¹ äº†æ¨¡å—çš„ä¾‹åŒ–ä¸è°ƒç”¨ï¼Œæ·±åˆ»ç†è§£äº†å¯¹ç€ç”µè·¯å›¾å†™HDLè¿™å¥è¯ã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"HDLBitsç­”æ¡ˆ(2)_Verilogå‘é‡åŸºç¡€çŸ¥è¯†","url":"/2022/09/03/IC/HDLBits/HDLBitsç­”æ¡ˆ(2)_Verilogå‘é‡åŸºç¡€/","content":"\n# HDLBits_Verilogå‘é‡åŸºç¡€çŸ¥è¯†\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n------\n\n## å‘é‡\n\nåœ¨Verilogä¸­ï¼Œå¯¹å‘é‡ç»´åº¦çš„å£°æ˜åœ¨å‘é‡åä¹‹å‰ï¼Œè¿™ç‚¹ä¸Cè¯­è¨€æœ‰æ‰€å·®å¼‚ï¼Œä½†ä½¿ç”¨å‘é‡çš„æ—¶å€™ç»´åº¦ä¿¡æ¯ä»åœ¨å‘é‡ååã€‚\n\n```verilog\nwire [99:0] my_vector;      // Declare a 100-element vector\nassign out = my_vector[10]; // Part-select one bit out of the vector\n```\n\n------\n\n## å‘é‡çš„æ›´å¤šçŸ¥è¯†\n\n### å£°æ˜å‘é‡\n\n`type [upper:lower] vector_name;`\n\n`type` æŒ‡å®šäº†å‘é‡çš„æ•°æ®ç±»å‹ï¼Œé€šå¸¸ä¸ºregæˆ–wireç±»å‹ã€‚å¦‚æœå£°æ˜çš„æ˜¯è¾“å…¥ã€è¾“å‡ºå‘é‡çš„è¯ï¼Œç±»å‹å‰è¿˜å¯ä»¥åŠ ä¸Šinputå’Œoutputï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```verilog\nwire [7:0] w;         // 8-bit wire\nreg  [4:1] x;         // 4-bit reg\noutput reg [0:0] y;   // 1-bit reg that is also an output port (this is still a vector)\ninput wire [3:-2] z;  // 6-bit wire input (negative ranges are allowed)\noutput [3:0] a;       // 4-bit output wire. Type is 'wire' unless specified otherwise.\nwire [0:7] b;         // 8-bit wire where b[0] is the most-significant bit.\n```\n\nå‘é‡çš„å¤§å°ç«¯æ˜¯æŒ‡æœ€ä¸é‡è¦çš„ä½å…·æœ‰è¾ƒä½çš„ç´¢å¼•([3:0])è¿˜æ˜¯è¾ƒé«˜çš„ç´¢å¼•([0:3])ï¼Œä¸€æ—¦ç”¨ç‰¹å®šçš„ç´¢å¼•è§„åˆ™å®šä¹‰äº†å‘é‡ï¼Œå°±è¦**ç”¨ç›¸åŒçš„æ–¹å¼å»ä½¿ç”¨å®ƒ**ã€‚\n\ntipsï¼šå‘é‡å£°æ˜æ—¶æ•°å­—çš„é¡ºåºå¾ˆé‡è¦ï¼Œå®ƒå†³å®šäº†å‘é‡æ˜¯ä»¥å¤§ç«¯å­˜å‚¨æˆ–è€…å°ç«¯å­˜å‚¨ã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œè‹¥å£°æ˜`wire [3:0] w`ï¼Œåˆ™`w[0]`ä¸ºwçš„æœ€ä½ä½ï¼Œ`w[3]`ä¸ºwçš„æœ€é«˜ä½ï¼›è‹¥å£°æ˜ä¸º`wire [0:3] w`ï¼Œåˆ™ä¸ä¸Šè¿°ç»“æœç›¸åã€‚**æ‰€ä»¥åœ¨å‘é‡çš„å®šä¹‰å’Œä½¿ç”¨æ—¶ä¸€å®šè¦ä¿æŒå¤§å°ç«¯ä¸€è‡´ï¼**\n\n#### æœªå®šä¹‰çš„ä¸­é—´å˜é‡å®¹æ˜“å‡ºé”™\n\nä½¿ç”¨wireå‹å˜é‡å‰è¯·å…ˆå£°æ˜ï¼Œä¸è¦å›¾ä¸€æ—¶ä¹‹ä¾¿ç›´æ¥æœªå®šä¹‰å°±æ‹¿æ¥åšä¸­é—´å˜é‡ï¼Œè¿™æ ·å¯¼è‡´çš„é”™è¯¯ä¼šå¾ˆéš¾å‘ç°ã€‚\n\n```verilog\nwire [2:0] a, c;   // Two vectors\nassign a = 3'b101;  // a = 101\nassign b = a;       // b =   1  implicitly-created wire\nassign c = b;       // c = 001  <-- bug\nmy_module i1 (d,e); // d and e are implicitly one-bit wide if not declared.\n                    // This could be a bug if the port was intended to be a vector.\n```\n\nå‘é‡åå‰ä¸ºç»´åº¦ï¼Œå‘é‡ååä¸ºæ•°ç›®ï¼Œä¸å†™ç»Ÿç»Ÿè§†ä½œ1ã€‚(å¯ç±»æ¯”Cè¯­è¨€ä¸­çš„æ•°ç»„ï¼Œå‘é‡åå‰ä¸ºæ•°ç»„å…ƒç´ çš„æ•°æ®ç±»å‹ï¼Œå‘é‡ååä¸ºæ•°ç»„é•¿åº¦ï¼›æˆ–è€…å½¢è±¡åŒ–çš„è¡¨è¿°ä¸ºï¼šç»´åº¦å³ä¸ºæ¯ä¸ªæˆ¿å­çš„å¤§å°ï¼Œæ•°ç›®ä¸ºæˆ¿å­çš„æ€»æ•°ç›®)\n\n```verilog\nreg [7:0] mem [255:0];   // 256 unpacked elements, each of which is a 8-bit packed vector of reg.\nreg mem2 [28:0];         // 29 unpacked elements, each of which is a 1-bit reg.\n```\n\n### è·å–å‘é‡å…ƒç´ ï¼šéƒ¨åˆ†é€‰æ‹©\n\nè®¿é—®æ•´ä¸ªå‘é‡æ˜¯ä½¿ç”¨å‘é‡åå®Œæˆçš„ï¼Œå¦‚:`assign w = a;`å¦‚æœå·¦å³ä¸¤è¾¹çš„é•¿åº¦ä¸åŒ¹é…ï¼Œåˆ™æ ¹æ®æƒ…å†µå¯¹å‘é‡è¿›è¡Œè¡¥é›¶æˆ–æˆªæ–­ã€‚\n\nå‘é‡çš„éƒ¨åˆ†é€‰æ‹©æ“ä½œå¯ä»¥è®¿é—®å‘é‡çš„ä¸€éƒ¨åˆ†ã€‚(å‘é‡å£°æ˜æ¥è‡ªä¸Šé¢\"å£°æ˜å‘é‡\"éƒ¨åˆ†)\n\n```verilog\nw[3:0]      // Only the lower 4 bits of w\nx[1]        // The lowest bit of x\nx[1:1]      // ...also the lowest bit of x\nz[-1:-2]    // Two lowest bits of z\nb[3:0]      // Illegal. Vector part-select must match the direction of the declaration.\nb[0:3]      // The upper 4 bits of b.\nassign w[3:0] = b[0:3];    // Assign upper 4 bits of b to lower 4 bits of w. w[3]=b[0], w[2]=b[1], etc.\n```\n\ntipsï¼šå–ç”¨å‘é‡ä¸­ç‰¹å®šç»´åº¦çš„æ•°æ—¶ä¸€å®šæ³¨æ„è¦ä¸å‘é‡çš„å®šä¹‰ä¸€è‡´ï¼Œæ³¨æ„å¤§å°ç«¯åŒ¹é…çš„é—®é¢˜ã€‚\n\n**é¢˜ç›®æè¿°**ï¼š\n\næ„å»ºä¸€ä¸ªç”µè·¯å°†ä¸€ä¸ª4byteçš„æ•°ä¸­çš„å­—èŠ‚é¡ºåºè°ƒè½¬ï¼Œå¸¸ç”¨äºæ•°æ®çš„å¤§å°ç«¯è½¬æ¢ã€‚\n\n`AaaaaaaaBbbbbbbbCcccccccDddddddd => DdddddddCcccccccBbbbbbbbAaaaaaaa`\n\n**Solution:**\n\n```verilog\nmodule top_module( \n    input [31:0] in,\n    output [31:0] out );\n\n    assign out[31:24] = in[7:0];\n    assign out[23:16] = in[15:8];\n    assign out[15:8] = in[23:16];\n    assign out[7:0] = in[31:24];\n\nendmodule\n```\n\ntipsï¼šåœ¨å‘é‡èµ‹å€¼çš„å·¦å³ä¸¤ç«¯éƒ½å¯ä»¥é€‰æ‹©å¯¹éƒ¨åˆ†æ•°æ®è¿›è¡Œæ“ä½œã€‚\n\n------\n\n## å¯¹å‘é‡è¿›è¡Œé—¨æ“ä½œ\n\n**ä½æ“ä½œè¿ç®—ç¬¦VSé€»è¾‘æ“ä½œè¿ç®—ç¬¦**\n\nå¯¹ä¸¤ä¸ªNbitä½å®½çš„å‘é‡è€Œè¨€ï¼ŒæŒ‰ä½æ“ä½œè¾“å‡ºä¸ºNbitä½å®½å‘é‡ï¼›è€Œé€»è¾‘æ“ä½œå°†æ•´ä¸ªå‘é‡è§†ä¸ºå¸ƒå°”å€¼(true =éé›¶ï¼Œfalse =é›¶)å¹¶äº§ç”Ÿä¸€ä¸ª1bitçš„è¾“å‡ºã€‚\n\n**é¢˜ç›®æè¿°1ï¼š**å¯¹å‘é‡ç‰¹å®šéƒ¨åˆ†çš„æ•°æ®è¿›è¡ŒæŒ‰ä½æ“ä½œå’Œé€»è¾‘æ“ä½œã€‚\n\n**Solution1ï¼š**\n\n```verilog\nmodule top_module( \n    input [2:0] a,\n    input [2:0] b,\n    output [2:0] out_or_bitwise,\n    output out_or_logical,\n    output [5:0] out_not\n);\n\tassign out_or_logical = a || b;\n    assign out_or_bitwise = a | b;\n    assign out_not[5:3] = ~b;\n    assign out_not[2:0] = ~a;\nendmodule\n```\n\n**é¢˜ç›®æè¿°2ï¼š**\n\nå¯¹è¾“å…¥å‘é‡è¿›è¡ŒæŒ‰ä½çš„ä¸ã€æˆ–å’Œå¼‚æˆ–æ“ä½œã€‚\n\n**Solution2:**\n\n```verilog\nmodule top_module( \n    input [3:0] in,\n    output out_and,\n    output out_or,\n    output out_xor\n);\n    assign out_and = &in;  // &in = in[3]&in[2]&in[1]&in[0]\n    assign out_or = |in;\n\tassign out_xor = ^in;\nendmodule\n```\n\ntipsï¼šåˆç†åˆ©ç”¨ç¼©ä½è¿ç®—ç¬¦ç²¾ç®€ä»£ç ï¼ŒæŒ‰ä½è¿›è¡Œé€»è¾‘è¿ç®—ï¼Œç»“æœä¸º1bitæ•°ã€‚\n\n- ä¸ç¼©ä½è¿ç®—ç¬¦ï¼š&â€‚\n- æˆ–ç¼©ä½è¿ç®—ç¬¦ï¼š|â€‚\n- å¼‚æˆ–ç¼©ä½è¿ç®—ç¬¦ï¼š^â€‚\n- ä¸ã€æˆ–ã€å¼‚æˆ–è¿ç®—ç¬¦å’Œéè¿ç®—ç¬¦ç»„æˆçš„**å¤åˆè¿ç®—ç¬¦**ï¼š&ï¼Œ|ï¼Œ ~ï¼Œ^\n\n------\n\n## å‘é‡æ‹¼æ¥æ“ä½œ\n\nå‘é‡æ‹¼æ¥æ“ä½œéœ€è¦çŸ¥é“å¾…æ‹¼æ¥çš„å„å‘é‡çš„ä½å®½ï¼Œå¦åˆ™ä½ æ€ä¹ˆçŸ¥é“ç»“æœçš„ä½å®½ï¼Ÿæ‰€ä»¥{1,2,3}æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºä½ æœªæŒ‡å®šå‘é‡ä½å®½ã€‚\n\nå‘é‡çš„æ‹¼æ¥æ“ä½œåœ¨èµ‹å€¼çš„å·¦å³ä¸¤ç«¯å‡å¯ä½¿ç”¨ã€‚\n\n```verilog\ninput [15:0] in;\noutput [23:0] out;\nassign {out[7:0], out[15:8]} = in;         // Swap two bytes. Right side and left side are both 16-bit vectors.\nassign out[15:0] = {in[7:0], in[15:8]};    // This is the same thing.\nassign out = {in[7:0], in[15:8]};       // This is different. The 16-bit vector on the right is extended to\n                                        // match the 24-bit vector on the left, so out[23:16] are zero.\n                                        // In the first two examples, out[23:16] are not assigned.\n```\n\ntipsï¼š1ã€ä½å®½åˆå¹¶éœ€çŸ¥é“å„æˆåˆ†çš„ç¡®åˆ‡ä½å®½ï¼Œå¦åˆ™ç»“æœä½å®½ä¸å®šã€‚2ã€ä½å®½åˆå¹¶æ—¶åœ¨assignä¸¤ç«¯å‡å¯å®ç°ï¼Œæœ€å¥½å·¦å³ä¸¤ç«¯ä½å®½ç›¸åŒï¼Œå¦åˆ™æœªè¢«æŒ‡å®šçš„æ•°æ®ä¼šè¢«ç½®é›¶ã€‚\n\n**é¢˜ç›®æè¿°ï¼š**\n\nç»™å®šå‡ ä¸ªè¾“å…¥å‘é‡ï¼Œå°†å®ƒä»¬æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œç„¶åå°†å®ƒä»¬åˆ†å‰²æˆå‡ ä¸ªè¾“å‡ºå‘é‡ã€‚æœ‰6ä¸ª5ä½è¾“å…¥å‘é‡:a, b, c, d, e, fï¼Œæ€»å…±30ä½è¾“å…¥ã€‚å¯¹äº32ä½çš„è¾“å‡ºï¼Œæœ‰4ä¸ª8ä½çš„è¾“å‡ºå‘é‡:wã€xã€yå’Œzã€‚è¾“å‡ºåº”è¯¥æ˜¯è¾“å…¥å‘é‡ä¸ä¸¤ä¸ªâ€œ1â€ä½çš„ä¸²è”:\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232146021.png)\n\n**Solutionï¼š**\n\n```verilog\nmodule top_module (\n    input [4:0] a, b, c, d, e, f,\n    output [7:0] w, x, y, z );\n    wire [31:0] temp;\n    assign temp = {a,b,c,d,e,f,2'b11};\n    assign {w,x,y,z}=temp;\nendmodule\n```\n\n------\n\n## å‘é‡ç¿»è½¬\n\n**é¢˜ç›®æè¿°ï¼š**\n\nç»™å®šä¸€ä¸ª8ä½è¾“å…¥å‘é‡[7:0]ï¼Œé¢ å€’å®ƒçš„ä½é¡ºåºã€‚\n\n**Solution1:**\n\n```verilog\nmodule top_module( \n    input [7:0] in,\n    output [7:0] out\n);\n    assign out={in[0],in[1],in[2],in[3],in[4],in[5],in[6],in[7]};\nendmodule\n```\n\n**Solution2:**\n\n```verilog\nmodule top_module( \n    input [7:0] in,\n    output [7:0] out\n);\n\tinteger i;\n    always@(*)begin\n        for(i = 0;i < 8;i = i + 1)begin\n            out[i]=in[7-i];\n        end\n    end\nendmodule\n```\n\ntipsï¼šå»ºè®®ä½¿ç”¨Solution2å®ç°ï¼Œå¯æ‰©å±•æ€§å¼ºã€‚\n\n------\n\n## å‘é‡å¤åˆ¶æ“ä½œ\n\nå‘é‡å¤åˆ¶æ“ä½œå…è®¸é‡å¤ä¸€ä¸ªå‘é‡å¹¶å°†å®ƒä»¬è¿æ¥åœ¨ä¸€èµ·:`{num{vector}}`\n\nä¾‹å¦‚:\n\n```verilog\n{5{1'b1}}           // 5'b11111 (or 5'd31 or 5'h1f)\n{2{a,b,c}}          // The same as {a,b,c,a,b,c}\n{3'd5, {2{3'd6}}}   // 9'b101_110_110. It's a concatenation of 101 with\n                    // the second vector, which is two copies of 3'b110.\n```\n\ntipsï¼šå¤åˆ¶å‘é‡æœ‰æ·å¾„ï¼ŒèŠ±æ‹¬å¤–é¢å¸¦æ•°å­—ã€‚ä¸»è¦ç”¨äºç¬¦å·ä½çš„æ‹“å±•ã€‚å¦‚4'b**0**101å¸¦ç¬¦å·æ‹“å±•ä¸º8bitçš„è¯ä¸º8'b**0000**0101ï¼Œ4'b1101å¸¦ç¬¦å·æ‹“å±•ä¸º8bitæ•°ä¸º8'b**1111**1101ã€‚\n\n**é¢˜ç›®æè¿°ï¼š**å»ºç«‹ä¸€ä¸ªç”µè·¯ï¼Œå°†8ä½æ•°å­—æ‰©å±•åˆ°32ä½ã€‚è¿™éœ€è¦å°†ç¬¦å·ä½çš„24ä¸ªå‰¯æœ¬(å³å°†ä½[7]å¤åˆ¶24æ¬¡)ä¸8ä½æ•°å­—æœ¬èº«è¿æ¥èµ·æ¥ã€‚\n\n**Solutionï¼š**\n\n```verilog\nmodule top_module (\n    input [7:0] in,\n    output [31:0] out );\n\n    assign out = { {24{in[7]}} , in };\n\nendmodule\n```\n\n**é¢˜ç›®æè¿°2ï¼š**ç»™å®š5ä¸ª1ä½ä¿¡å·(aã€bã€cã€då’Œe)ï¼Œè®¡ç®—25ä½è¾“å‡ºå‘é‡ä¸­æ‰€æœ‰25ä¸ªæˆå¯¹çš„1ä½æ¯”è¾ƒã€‚å¦‚æœä¸¤ä¸ªè¢«æ¯”è¾ƒçš„ä½ç›¸ç­‰ï¼Œè¾“å‡ºåº”è¯¥æ˜¯1ã€‚\n\n```verilog\nout[24] = ~a ^ a;   // a == a, so out[24] is always 1.\nout[23] = ~a ^ b;\nout[22] = ~a ^ c;\n...\nout[ 1] = ~e ^ d;\nout[ 0] = ~e ^ e;\n```\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232146896.png)\n\ntipsï¼šè¯¥æ“ä½œå¯ä»¥å®šä½ç‰¹å®šsignalæ‰€åœ¨ä½ç½®ï¼Œä¸¤å‘é‡é‡å¤æ•°æ®æœ‰è§„å¾‹å¯å¾ªï¼Œå¯ç”¨å¤åˆ¶çš„æ–¹å¼æ¥äº§ç”Ÿï¼Œç®€åŒ–ä»£ç ã€‚\n\n**Solution:**\n\n```verilog\nmodule top_module (\n    input a, b, c, d, e,\n    output [24:0] out );\n\n    assign out = ~{5{a,b,c,d,e}} ^ {{5{a}},{5{b}},{5{c}},{5{d}},{5{e}}};\n\nendmodule\n```\n\n------\n\n## æ€»ç»“ï¼š\n\nå­¦ä¹ äº†å‘é‡æ“ä½œçš„ç›¸å…³çŸ¥è¯†ï¼ŒåŒ…æ‹¬å£°æ˜ã€é€‰æ‹©éƒ¨åˆ†æ•°æ®ã€åˆå¹¶ã€å¤åˆ¶ç­‰æ“ä½œã€‚\n\n","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"Synplifyä¸­å¦‚ä½•è°ƒç”¨Xilinxç½‘è¡¨IP","url":"/2022/09/02/FPGA/Synplifyä¸­å¦‚ä½•è°ƒç”¨Xilinxç½‘è¡¨IP/","content":"\n## èƒŒæ™¯\n\nåœ¨åšé¡¹ç›®æ—¶éœ€è¦å°†Xilinxå·¥å…·ç”Ÿæˆçš„IPå¯¼å…¥åˆ°è‡ªå·±çš„é¡¹ç›®å·¥ç¨‹ä¸­ï¼Œå¸ƒå±€å¸ƒçº¿ç”±ISEå®Œæˆï¼Œç»¼åˆç”±Synplifyå®Œæˆï¼›éš¾ç‚¹åœ¨äºå¦‚ä½•é€šè¿‡ISEè°ƒç”¨Synplifyç»¼åˆå·¥å…·ä»¥åŠå¦‚ä½•è®©å·¥å…·è¯†åˆ«IPã€‚\n\n## è§£å†³æ–¹å¼\n\né¦–å…ˆæœç´¢Synplifyå®¶çš„UGæŸ¥çœ‹è§£å†³æ€è·¯ã€‚\n\n![image-20221007151502051](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210071515122.png)\n\nåœ¨Chapter13å‘ç°è·ŸXilinxå®¶çš„IPç›¸å…³å†…å®¹ï¼›\n\n![image-20221007151552458](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210071603375.png)\n\nä¸‹å›¾åˆ—å‡ºäº†Xilinxæä¾›çš„å„ç§ç±»å‹çš„ç½‘è¡¨\n\n![image-20221007151644377](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210071516520.png)\n\næˆ‘ä»¬é¡¹ç›®ä¸­ç”¨åˆ°çš„æ˜¯NGCæ–‡ä»¶ï¼Œåº”è¯¥æ˜¯Non-seureç‰ˆæœ¬ï¼Œç›´æ¥å°†NGCæ–‡ä»¶æ·»åŠ åˆ°ISEé¡¹ç›®å·¥ç¨‹ä¸­å³å¯ã€‚\n\n![image-20221007151924599](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210071519672.png)\n\nè‡³äºISEè°ƒç”¨Synplifyè¿›è¡Œä»¿çœŸçš„æ­¥éª¤ï¼Œç¤ºæ„å¦‚ä¸‹ï¼š\n\n![image-20221007152021821](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210071520886.png)\n\n![image-20221007152050373](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202210071520446.png)\n\n","tags":["FPGA_Tools"],"categories":["FPGA","FPGA_Tools"]},{"title":"HDLBitsç­”æ¡ˆ(1)_Verilogè¯­æ³•åŸºç¡€","url":"/2022/09/02/IC/HDLBits/HDLBitsç­”æ¡ˆ(1)_Verilogè¯­æ³•åŸºç¡€/","content":"\n# HDLBits_Verilogè¯­æ³•åŸºç¡€\n\n[HDLBitsé“¾æ¥](https://hdlbits.01xz.net/wiki/Main_Page)\n\n---\n\n## çº¿ä¿¡å·\n\nä¸ç‰©ç†ç”µçº¿ä¸åŒï¼ŒVerilogä¸­çš„çº¿ä¿¡å·(å’Œå…¶ä»–ä¿¡å·)æ˜¯â€œæ–¹å‘æ€§çš„â€ã€‚è¿™æ„å‘³ç€ä¿¡æ¯åªå‘ä¸€ä¸ªæ–¹å‘æµåŠ¨ï¼Œä»é©±åŠ¨ç¨‹åºæµå‘æ¥æ”¶å™¨ã€‚åœ¨Verilogâ€œè¿ç»­èµ‹å€¼â€(`assign left_side = right_side; `)ä¸­ï¼Œå³ä¾§ä¿¡å·çš„å€¼è¢«é©±åŠ¨åˆ°å·¦ä¾§çš„è¿æ¥ä¸Šã€‚assignèµ‹å€¼æ˜¯â€œè¿ç»­çš„â€ï¼Œå³ä¾§çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶å·¦è¾¹çš„å€¼ç«‹é©¬å‘ç”Ÿå˜åŒ–ã€‚\n\nè¿™æ—¶æˆ‘ä»¬å°±ä¼šç†è§£ï¼šä¸€ä¸ªçº¿ä¿¡å·ä¸èƒ½æœ‰ä¸¤ä¸ªé©±åŠ¨ç¨‹åºæ¥é©±åŠ¨ï¼›çº¿ä¿¡å·å¦‚æœæ²¡æœ‰é©±åŠ¨ç¨‹åºçš„è¯é‚£ä¹ˆè¾“å‡ºå°±æ˜¯æœªçŸ¥çš„ã€‚\n\nå½“å­˜åœ¨å¤šä¸ªassignè¯­å¥æ—¶ï¼Œ**assignå‡ºç°çš„é¡ºåºå’Œä½ç½®ä¸å½±å“**ï¼Œä¹Ÿå°±ç›¸å½“äºè¿çº¿çš„é¡ºåºä¸å½±å“æœ€ç»ˆç»“æœï¼Œè¿™ä¸ªè¦å’Œè½¯ä»¶çš„æ€ç»´åŒºåˆ«å¼€ã€‚\n\n## åŸºç¡€çš„é—¨æ“ä½œ\n\n### åŒºåˆ†æŒ‰ä½å–å(~) å’Œé€»è¾‘å–å(!)\n\n![1](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232145528.png)\n\n### åŒºåˆ†æŒ‰ä½ä¸(&)å’Œé€»è¾‘ä¸(&&)\n\n![2](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232145668.png)\n\n### åŒºåˆ†æŒ‰ä½æˆ–(|)å’Œé€»è¾‘æˆ–(||)\n\nâ€‹\t *A NOR gate is an OR gate with its output inverted.* \n\n![3](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232145667.png)\n\n### æŒ‰ä½å¼‚æˆ–\n\n![4](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232145196.png)\n\n## 7458èŠ¯ç‰‡\n\n![5](https://cdn.jsdelivr.net/gh/XduDavid/Blog_Img@main/img/202303232145215.png)\n\n**é¢˜ç›®æè¿°**ï¼š\n\næŒ‰ç…§ç”µè·¯å›¾ï¼Œç”¨verilogè¯­è¨€æè¿°è¾“å…¥è¾“å‡ºé—´çš„å…³ç³»ã€‚\n\n**Solution1ï¼š**\n\n```verilog\nmodule top_module ( \n    input p1a, p1b, p1c, p1d, p1e, p1f,\n    output p1y,\n    input p2a, p2b, p2c, p2d,\n    output p2y );\n        wire and1_out,and2_out,and3_out,and4_out;\n        assign and1_out=p2a&p2b;\n        assign and2_out=p2c&p2d;\n        assign and3_out=p1a&p1c&p1b;\n        assign and4_out=p1f&p1e&p1d;\n        assign p2y=and1_out|and2_out;\n        assign p1y=and3_out|and4_out;\nendmodule\n```\n\n**Soluton2ï¼š**\n\n```verilog\nmodule top_module ( \n    input p1a, p1b, p1c, p1d, p1e, p1f,\n    output p1y,\n    input p2a, p2b, p2c, p2d,\n    output p2y );\n    assign p2y=(p2a&p2b)|(p2c&p2d);\n    assign p1y=(p1a&p1c&p1b)|(p1f&p1e&p1d);\nendmodule\n```\n\n## æ€»ç»“\n\n1ã€assignä¸ºè¿ç»­èµ‹å€¼ï¼Œèµ‹å€¼é¡ºåºä¸å½±å“ã€‚\n\n2ã€ä¸€ä¸ªwireæœ‰ä¸”ä»…èƒ½æœ‰ä¸€ä¸ªdriverã€‚\n\n3ã€å­¦ä¹ äº†åŸºç¡€çš„é—¨æ“ä½œã€‚","tags":["HDLBits"],"categories":["IC","HDLBits"]},{"title":"æœ¬ç§‘æ¯•è®¾å°ç»“","url":"/2020/06/23/Misc/åŸºäºPYNQ-Z2å®ç°BNNç¡¬ä»¶åŠ é€Ÿ/","content":"\n## æœ¬ç§‘æ¯•è®¾å°ç»“â€”åŸºäºHLSçš„BNNåŠ é€Ÿ\n\n **æœ¬æ–‡ä¸»è¦æ˜¯æœ¬äººæœ¬ç§‘æ¯•ä¸šè®¾è®¡çš„ä¸»è¦å·¥ä½œã€‚**\nã€€ã€€ä¸»è¦å·¥ä½œæœ‰ä¸¤éƒ¨åˆ†ï¼Œä¸€æ˜¯ä½¿ç”¨Vivado HLSå·¥å…·å®ç°äºŒå€¼å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹å¹¶å®Œæˆç¡¬ä»¶åŠ é€Ÿå·¥ä½œï¼ŒäºŒæ˜¯å°†äºŒå€¼ç¥ç»ç½‘ç»œçš„å‰å‘è®¡ç®—è¿‡ç¨‹éƒ¨ç½²åˆ°PYNQ-Z2æ¿ä¸Šï¼Œå¹¶åœ¨Jupyter Notebookä¸Šå®ç°IPæ ¸çš„è°ƒç”¨ã€‚\nã€€ã€€BNNå‚è€ƒè®ºæ–‡ã€ŠBinarized Neural Networks Training Neural Networks with Weights and Activations Constrainedto +1 or âˆ’1ã€‹ã€ã€ŠFINN A Framework for Fast, Scalable Binarized Neural Network Inferenceã€‹ã€‚å› ä¸ºæ¯•è®¾è¦æ±‚å®ç°äº‘å›¾åƒåˆ†ç±»çš„åŠŸèƒ½ï¼Œæ‰€ä»¥è®­ç»ƒé›†ç”±ç°åº¦äº‘å›¾ç»„æˆï¼Œæ ¼å¼ä¸mnistæ•°æ®é›†ç›¸åŒã€‚è®­ç»ƒé‡‡ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶theanoï¼Œå¯¼å‡ºè®­ç»ƒå¥½çš„å‚æ•°ï¼Œç„¶ååœ¨Vivado HLSä¸Šå®ç°BNNå‰å‘è®¡ç®—çš„åŠ é€Ÿè¿‡ç¨‹ã€‚\nã€€ã€€![å¼€å‘æµç¨‹](https://img-blog.csdnimg.cn/2020062221433088.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70)\nBNNç”±å·ç§¯å±‚ã€æ± åŒ–å±‚å’Œå…¨è¿æ¥å±‚ç»„æˆï¼Œä¸»è¦é—®é¢˜å…¶å®åªæœ‰ä¸€ä¸ªï¼š**å¦‚ä½•åŠ é€Ÿå·ç§¯ï¼Ÿ**ï¼ˆå…¨è¿æ¥å±‚ä¸»è¦æ˜¯ä¹˜ç´¯åŠ è¿ç®—ï¼Œæ­¤å¤„å¯å‚è€ƒå·ç§¯å±‚çš„åŠ é€Ÿ)\n\n### å·ç§¯åŠ é€Ÿ\nå·ç§¯çš„åŠ é€Ÿä¸»è¦åˆ†ä¸º4ä¸ªå±‚é¢ï¼šä½å®½åŠ é€Ÿã€ç®—æ³•åŠ é€Ÿã€HLSä¼˜åŒ–æŒ‡ä»¤åŠ é€Ÿã€è®¿å­˜åŠ é€Ÿã€‚\n#### ä½å®½åŠ é€Ÿ\nä½å®½åŠ é€Ÿå…¶å®å°±æ˜¯**ç”¨æ•°æ®ç²¾åº¦æ¢å–è®¡ç®—é€Ÿåº¦**ï¼Œè¿™ä¹Ÿæ˜¯äºŒå€¼ç¥ç»ç½‘ç»œå‚æ•°äºŒå€¼åŒ–çš„ä¸»è¦ä½œç”¨ï¼Œå‚æ•°äºŒå€¼åŒ–åå¤§å¤§é™ä½äº†å‚æ•°é‡ã€‚å‚æ•°äºŒå€¼åŒ–æ˜¯æŒ‡æˆ‘ä»¬åœ¨è®­ç»ƒç½‘ç»œçš„æ—¶å€™å°†å‰å‘è®¡ç®—çš„æƒé‡è¿›è¡ŒäºŒå€¼åŒ–å¤„ç†ï¼Œä½†åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ä¼šå‡ºç°æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜(signå‡½æ•°çš„å¯¼æ•°å‡ ä¹å¤„å¤„ä¸º0)ï¼Œæ‰€ä»¥åå‘ä¼ æ’­æ—¶ä¼šè¿›è¡Œæ¾å¼›åŒ–å¤„ç†ï¼Œå°†ç¬¦å·å‡½æ•°Signå˜ä¸ºå¯å¯¼å‡½æ•°Htanhï¼Œå¹¶æ›´æ–°å…¨ç²¾åº¦çš„æƒé‡ï¼Œè¿™é‡Œçš„ç›¸å…³å†…å®¹å¯ä»¥å‚è€ƒXNOR-NETçš„è®ºæ–‡æˆ–è€…ç›¸å…³æ–‡çŒ®ã€‚ä¸»è¦è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n![è®­ç»ƒ](https://img-blog.csdnimg.cn/20200622214942896.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70)\n\n#### ç®—æ³•åŠ é€Ÿ\n\n - **ä¹˜åŠ ä¼˜åŒ–**\n\nç®—æ³•æ–¹é¢çš„åŠ é€Ÿå…¶å®å°±æ˜¯å……åˆ†ä½¿ç”¨äºŒå€¼ç¥ç»ç½‘ç»œçš„ç‰¹ç‚¹è¿›è¡Œè¿ç®—ç¬¦ä¼˜åŒ–ï¼Œå› ä¸ºå‰é¢æˆ‘ä»¬å·²ç»å°†å‚æ•°äºŒå€¼åŒ–ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œå·ç§¯æ“ä½œçš„æ—¶å€™å¯ä»¥åˆ©ç”¨åŒæˆ–æ“ä½œå’Œè®¡æ•°å™¨ä»£æ›¿ä¹˜åŠ è¿ç®—ï¼Œå³ä½¿ç”¨XNORå’ŒPopCountå®ç°ä¹˜åŠ è¿ç®—ï¼Œå…·ä½“å¯ä»¥å‚è€ƒXNOR-Netã€‚\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200622223605481.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70)\n\nä»¥A=[1,-1,1,1,-1]å’ŒW=[-1,1,1,-1,-1]ä¸¤ä¸ªå‘é‡è¿›è¡Œå†…ç§¯è¿ç®—ä¸ºä¾‹:\næ­£å¸¸çš„ä¹˜æ³•è¿ç®—ä¸º1Ã—(-1)+(-1)Ã—1+1Ã—1+1Ã—(-1)+(-1)Ã—(-1)= -1ï¼›\n\nä»åŒæˆ–è¿ç®—çš„è§’åº¦æ¥çœ‹ï¼ŒA=[1,0,1,1,0],W=[0,1,1,0,0]\nA ä¸W è¿›è¡Œå¼‚æˆ–çš„ç»“æœä¸ºA^W=[1,1,0,1,0]ï¼ˆHLS ä¸­ä¸å­˜åœ¨åŒæˆ–æ“ä½œï¼Œéœ€å¯¹å¼‚æˆ–å–åè¿›è¡ŒåŒæˆ–æ“ä½œï¼‰\nPopCount çš„ä½œç”¨æ˜¯è®¡ç®—1çš„ä¸ªæ•°æ¥å¯¹äºŒè¿›åˆ¶çš„ä¹˜ç§¯è¿›è¡Œæ±‚å’Œã€‚æ‰€ä»¥PopCount(A^W)= 3,å³ç»“æœä¸­æœ‰3ä¸ª-1ï¼›æ‰€ä»¥æœ€ç»ˆäºŒè¿›åˆ¶çš„ä¹˜ç§¯çš„ç»“æœä¸º(5-PopCount)Ã—1+PopCountÃ—(-1)= 5-2Ã—PopCount= -1.\nä¼ªä»£ç å¦‚ä¸‹ï¼Œå…¶ä¸­F ä¸ºå·ç§¯çª—å£å¤§å°ï¼Œwindow_result ä¸ºå½“å‰å·ç§¯çª—å£çš„è®¡ç®—ç»“æœï¼Œweight_buff ä¸ºå·ç§¯æ ¸å‚æ•°ï¼Œbit_num ä¸ºå·ç§¯çª—å£å†…æ•°æ®çš„æ€»ä½æ•°ã€‚\n\n```c\nfor (int c = 0; c < F; c++) {\n\tfor (int r = 0; r < F; r++) {\n\t\tbit32 tmp = weight_buff[r][c]^window_buff[r][c];\n\t\tcount += popcount(tmp);\n\t}\n}\n\twindow_result = bit_num â€“ (count << 1);\n}\n```\n\n - **æ± åŒ–ä¼˜åŒ–**\næ™®é€šçš„æœ€å¤§å€¼æ± åŒ–å°±æ˜¯å¯¹æ»‘åŠ¨çª—å£å†…çš„æ•°æ®è¿›è¡Œæ¯”è¾ƒï¼Œå°†å…¶ä¸­æœ€å¤§çš„æ•°æ®ä½œä¸ºè¯¥æ»‘åŠ¨çª—å£çš„ç»“æœã€‚åœ¨BNNè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæœ€å¤§å€¼æ± åŒ–åè¿˜è¦å¯¹è¾“å‡ºç»“æœå†æ¬¡è¿›è¡ŒäºŒå€¼åŒ–æ“ä½œ\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200622224603468.png#pic_center)\nå› ä¸ºæ»‘åŠ¨çª—å£å†…ä»»æ„ä¸€ä¸ªå€¼æ»¡è¶³å¤§äºs çš„æ¡ä»¶éƒ½å¯ä»¥ä½¿å½“å‰æ»‘åŠ¨çª—å£çš„è¾“å‡ºä¸º1ï¼Œå³æœ€å¤§æ± åŒ–æ“ä½œä¸è®¡ç®—é¡ºåºæ²¡æœ‰å…³ç³»ï¼Œå› æ­¤äºŒå€¼ç¥ç»ç½‘ç»œçš„æœ€å¤§å€¼æ± åŒ–æ“ä½œå¯ä»¥ç®€åŒ–ä¸ºæˆ–è¿ç®—\n\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200622224631261.png#pic_center)\n#### è®¿å­˜åŠ é€Ÿ\nå¼•å…¥ç¼“å­˜ï¼Œå°†ç¼“å­˜ç½®äºè®¿å­˜é€Ÿåº¦æ›´å¿«çš„å†…å­˜å—ä¸­ï¼Œä»è€ŒåŠ é€Ÿæ•´ä¸ªå·ç§¯å±‚çš„è®¡ç®—é€Ÿåº¦ã€‚åŒæ—¶ç›¸é‚»çš„å·ç§¯çª—å£çš„æ•°æ®é‡å¤ç‡è¾ƒé«˜ï¼Œæ— éœ€è¯»å–å¤§é‡é‡å¤ä½¿ç”¨çš„æ•°æ®ã€‚\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200622225118806.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70#pic_center)\næœ¬æ–‡ä½¿ç”¨äº†è¡Œç¼“å­˜å™¨å’Œçª—ç¼“å­˜å™¨å®ç°äº†å·ç§¯çª—å£çš„æµæ°´æ“ä½œï¼Œä¸‹å›¾ä¸ºçª—å£ç¼“å­˜ç»“æ„ç¤ºæ„å›¾ï¼š\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200622225309203.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70#pic_center)\nå‚æ•°æ›´æ–°è¿‡ç¨‹å¦‚ä¸‹ï¼š\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200622232414651.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70#pic_center)\nä¼ªä»£ç å¦‚ä¸‹ï¼š\n\n```c\nfor (int i = 0; i < F; i++) {\n\tfor (int j = 0; j < F - 1; j++) {\n\t\twindow_buff[i][j] = window_buff[i][j + 1];\n\t\twindow_buff[i][F-1] = line_buff[i][next_x];\n\t}\n}\nfor (int i = 0; i < F-1; i++) {\n\tline_buff[i][next_x] = line_buff[i + 1][next_x];\n\tline_buff[F-1][next_x] = input[y + F][next_x];\n}\n```\n\n #### HLSä¼˜åŒ–æŒ‡ä»¤åŠ é€Ÿ\næœ¬æ–‡ä¸­ä¸»è¦ç”¨åˆ°çš„HLSçš„ä¼˜åŒ–æŒ‡ä»¤ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼š(è¯¦ç»†è¿‡ç¨‹å¯å‚è€ƒXilinxå®˜æ–¹æ–‡æ¡£UG902)\n\n - **å¾ªç¯å±•å¼€**\n å¾ªç¯å±•å¼€æ˜¯æŒ‡å°†ä¸€ä¸ªå¾ªç¯å‡½æ•°åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹æ“ä½œï¼Œå¯¹åº”çš„ä¼˜åŒ–æŒ‡ä»¤ä¸º#pragma HLS UNROLLã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¯¹å†…å±‚å¾ªç¯é‡‡ç”¨å¾ªç¯å±•å¼€ä¼˜åŒ–è¾ƒåˆé€‚ï¼Œè‹¥å¯¹å¤–å±‚å¾ªç¯è¿›è¡Œå¾ªç¯å±•å¼€çš„è¯ï¼Œä¼šæ˜¾è‘—æé«˜èµ„æºçš„ä½¿ç”¨ç‡ã€‚\n\n![å¾ªç¯å±•å¼€çš„ä¼˜åŒ–æ•ˆæœ](https://img-blog.csdnimg.cn/20200622230051734.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70#pic_center)\n - **æµæ°´ä¼˜åŒ–**\n åœ¨HLS ä¸­ï¼Œå¾ªç¯ç»“æ„é»˜è®¤æ˜¯æŠ˜å çš„ï¼Œå³åªä½¿ç”¨ä¸€ç»„ç›¸åŒçš„ç¡¬ä»¶èµ„æºè¿›è¡Œè®¡ç®—ã€‚æµæ°´çº¿æ“ä½œå¯ä»¥æ”¹å–„å¯åŠ¨é—´éš”ä¸æ—¶å»¶ï¼Œå¯¹åº”çš„ä¼˜åŒ–æŒ‡ä»¤ä¸º#pragma HLS PIPELINEã€‚\n    ![å‡½æ•°æµæ°´ä¼˜åŒ–](https://img-blog.csdnimg.cn/20200622230314195.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70#pic_center)\n  ä¸Šå›¾æ‰€ç¤ºçš„å‡½æ•°ï¼Œæ¯ä¸‰ä¸ªæ—¶é’Ÿå‘¨æœŸè¯»å–ä¸€ä¸ªè¾“å…¥ï¼Œä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸåè¾“å‡ºä¸€ä¸ªå€¼ã€‚ä½¿ç”¨Pipeline ä¼˜åŒ–æŒ‡ä»¤åï¼Œæ¯ä¸ªæ—¶é’Ÿå‘¨æœŸéƒ½å¯ä»¥è¯»å–ä¸€ä¸ªæ–°çš„è¾“å…¥ï¼Œä½†è¾“å‡ºçš„å»¶è¿Ÿä¸å˜ã€‚\n - **æ•°ç»„åˆ†å‰²**\nåœ¨è¿›è¡Œä¸Šè¿°ä¼˜åŒ–åä»å­˜åœ¨éƒ¨åˆ†é—®é¢˜â€”**è¯»å†™æ“ä½œçš„ç“¶é¢ˆé—®é¢˜**ã€‚ä¹‹å‰æ‰€ç¤ºçš„å¾ªç¯å±•å¼€ä¸­ï¼Œå¯¹æ¯ä¸ªæ•°ç»„è€Œè¨€ï¼Œæ¯ä¸ªæ—¶é’Ÿå‘¨æœŸéœ€è¦æ‰§è¡Œ3ä¸ªè¯»æ“ä½œæˆ–3ä¸ªå†™æ“ä½œï¼Œä½†æ˜¯ä¸€ä¸ªBRAM æœ€å¤šåªæœ‰ä¸¤ä¸ªç«¯å£ï¼Œå³ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…æœ€å¤šæ‰§è¡Œä¸¤ä¸ªè¯»æˆ–å†™æ“ä½œã€‚\n![è¯»å†™ç“¶é¢ˆ](https://img-blog.csdnimg.cn/20200622230620148.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70#pic_center)\næ•°ç»„åˆ†å‰²æ˜¯é€šè¿‡å°†ä¸€ä¸ªå—RAM èµ„æºåˆ†å‰²æˆå¤šä¸ªè¾ƒå°çš„é˜µåˆ—ï¼Œä»è€Œæé«˜å¸¦å®½ï¼Œæœ‰æ•ˆå¢åŠ ç«¯å£çš„æ•°é‡ï¼Œ**æé«˜è¯»/å†™å¯†é›†å‹ç®—æ³•çš„ååé‡**ã€‚\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200622230723552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70#pic_center)\næ”¹è¿›åçš„Resource Viewerå¦‚ä¸‹ï¼Œæ­¤æ—¶ä¸å­˜åœ¨è¯»å†™ç“¶é¢ˆã€‚\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200622230828921.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70#pic_center)\n### å®éªŒç»“æœ\n**ç¡¬ä»¶ç³»ç»Ÿæ¨¡å—çš„Block Design**ï¼š\n![1.png](https://img-blog.csdnimg.cn/img_convert/6f64df2db08ca9eefa73f092866cbad4.png)\nJupyter Notebookç»“æœï¼š\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/2020062223134521.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzM0MDcy,size_16,color_FFFFFF,t_70)\nPYNQ-Z2æ¿ç¡¬ä»¶åŠ é€Ÿæ•ˆæœï¼š\n|ç¡¬ä»¶å¹³å°|å›¾åƒæ•°|æ—¶é—´/ms\n|:----:|:----:|:----:|\n|CPU|100|8032.8|\n|FPGA|100|2.2|\n### å°ç»“\nè®ºæ–‡å‰æœŸç”¨äº†ä¸€æ®µæ—¶é—´å­¦ä¹ HDLï¼Œç”¨Verilogè¯­è¨€æ­å»ºäº†ä¸€äº›å°æ¨¡å—ç†Ÿæ‚‰ç¡¬ä»¶æ­å»ºæµç¨‹ï¼Œç†Ÿæ‚‰PYNQ-Z2å¼€å‘æ¿çš„å¼€å‘æµç¨‹ã€‚åæ¥å‚è€ƒ[BNN-PYNQ](https://github.com/Xilinx/BNN-PYNQ)åœ¨PYNQ-Z2æ¿ä¸Šè·‘é€šäº†BNNçš„ä¾‹ç¨‹ï¼Œå‚è€ƒ[HLS-BNN](https://github.com/Stuart0l/BNN)å­¦ä¹ BNNå„æ¨¡å—åœ¨HLSçš„æ­å»ºåŠåŠ é€Ÿè¿‡ç¨‹ï¼Œå®ç°BNNå„æ¨¡å—çš„åŠ é€Ÿã€‚\nåŒæ—¶ï¼Œæ¯•è®¾é€‰æ‹©ç¡¬ä»¶å¼€å‘æ—¶ï¼Œå¯å‚è€ƒçš„ä¸­æ–‡èµ„æ–™è¾ƒå°‘ï¼Œé è°±çš„è‹±æ–‡æ–‡çŒ®æœ‰UG871ï¼ˆå®˜æ–¹æä¾›çš„HLSä¾‹ç¨‹ï¼Œå»ºè®®è·Ÿç€æ­¥éª¤éƒ½åšä¸€éï¼‰ä»¥åŠUG902ï¼ˆå½“å·¥å…·ä¹¦æŸ¥è¯¢ï¼‰\nè®ºæ–‡ä¸­æåŠçš„å·¥ä½œå æ—¶ä¸æ˜¯å¾ˆå¤š ï¼Œä¸»è¦æ—¶é—´éƒ½åœ¨ç†Ÿæ‚‰HDLã€HLSå¼€å‘å·¥å…·ä»¥åŠPYNQ-Z2çš„å¼€å‘æµç¨‹ï¼ŒæœŸé—´ä¹Ÿé‡åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚å¦‚ä½•å®šä¹‰æ¥å£ç±»å‹ã€å¦‚ä½•è°ƒç”¨æ¿å­ä»¥åŠå¦‚ä½•åœ¨Jupyter Notebookè¿›è¡Œæ•°æ®æ ¼å¼è½¬æ¢ç­‰ã€‚\n\nå®Œæˆå¤§éƒ¨åˆ†æ¯•è®¾å·¥ä½œå·²æ˜¯ç«‹å¤ï¼Œå›é¡¾å¤§å­¦å››å¹´ï¼Œæˆ‘åŠªåŠ›ç€ï¼Œä»˜å‡ºç€ã€‚\nåœ¨æ­¤ååˆ†æ„Ÿè°¢å¥³å‹ï¼ŒåŒæˆ‘äº¤æµæ„Ÿå—ï¼Œä¸ºæˆ‘åŠ æ²¹æ‰“æ°”ï¼›\néå¸¸æ„Ÿè°¢æˆ‘çš„å®¶äººï¼Œæ›¿æˆ‘çƒ§æ°´ç…®é¥­ï¼Œå”¤æˆ‘æ·»è¡£ä¿æš–ï¼›\nä¹Ÿå¾ˆæ„Ÿè°¢å¤§å­¦æŒšå‹ï¼Œä¸æˆ‘äº¤æµæ€è·¯ï¼Œæºæˆ‘å…±åŒè¿›æ­¥ã€‚\n\n### å‚è€ƒèµ„æ–™\n[PYNQ-Z2æ¿å¡ç®€ä»‹ä¸èµ„æºæ•´ç†](http://bbs.elecfans.com/jishu_1710246_1_1.html)\n[Xilinx/BNN-PYNQ](https://github.com/Xilinx/BNN-PYNQ)\n[æ¿å¡é•œåƒä¸‹è½½åœ°å€](http://www.pynq.io/board.html)\n[PYNQå®˜æ–¹Getting Started](https://pynq.readthedocs.io/en/latest/getting_started.html)\n[PYNQå®˜æ–¹ä¾‹ç¨‹â€”ç†Ÿæ‚‰PYNQçš„å¼€å‘æµç¨‹](https://github.com/sazczmh/PYNQ_Workshop)\n[PYNQå…¥é—¨ä¸­æ–‡èµ„æ–™](https://github.com/louisliuwei/PynqDocs)\n[HLSç”ŸæˆIPè¿›è¡Œç¡¬ä»¶åŠ é€Ÿ](https://github.com/sazczmh/High-Level-Synthesis-Flow-on-Zynq-using-Vivado-HLS)\n[FPGAå¹¶è¡Œç¼–ç¨‹](https://xupsh.gitbook.io/pp4fpgas-cn/)\n[BitCountå‡½æ•°è§£é‡Š](https://blog.csdn.net/Elmo66/article/details/78858120?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522158641757219724839243619%2522%252C%2522scm%2522%253A%252220140713.130056874..%2522%257D&request_id=158641757219724839243619&biz_id=0&utm_source=distribute.pc_search_result.none-task-blog-all_SOOPENSEARCH-3)\n[BNN-PYNQå®‰è£…](https://blog.csdn.net/WAWAWALALALA/article/details/94396331)\n[æ¨¡ä»¿mniståˆ¶ä½œæ•°æ®é›†](https://blog.csdn.net/YF_Li123/article/details/76731697)\n[FINN_Documentation](https://finn.readthedocs.io/en/latest/index.html)\n[å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨‹ç¬¬å››è¯¾ â€” å·ç§¯ç¥ç»ç½‘ç»œ](https://www.bilibili.com/video/BV1F4411y7o7)\n[HLSå…¥é—¨è§†é¢‘](https://www.bilibili.com/video/BV1bt41187RW)\n[æ­£ç‚¹åŸå­ZYNQç³»åˆ—](https://www.bilibili.com/video/BV1TJ411R7YY)\n\n**[2020.8.27æ›´æ–°ï¼Œæ·»åŠ BNNçš„HLSå’ŒVivadoå·¥ç¨‹å¤ç°æ•™ç¨‹]**\n[BNNå·¥ç¨‹å¤ç°æ•™ç¨‹](https://blog.csdn.net/qq_42334072/article/details/107966278)\n**[2020.11.26æ›´æ–°ï¼Œæ›´æ–°Block Designæ¡†å›¾]**\n","tags":["æ¯•è®¾"],"categories":["Misc","æ¯•è®¾"]}]